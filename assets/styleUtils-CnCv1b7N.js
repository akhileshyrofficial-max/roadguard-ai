import{s as b,d9 as d,E as w,ax as p,H as h,aG as g,da as R,b5 as U}from"./Identifiable-B58w9FD1.js";const i=new Map;async function N(e,s){try{return{data:(await I(e,s)).data,baseUrl:d(e),styleUrl:e}}catch(t){return w(t),null}}function $(e,s,t){var f;const r=s.portal!=null?s.portal:p.getDefault();let n;const u=`${r.url} - ${(f=r.user)==null?void 0:f.username} - ${e}`,l=i.get(u);if(l)return l;const o=k(e,r,t).then(a=>(n=a,a.fetchData())).then(a=>({data:a,baseUrl:n.itemUrl??"",styleName:e}));return i.set(u,o),o}function k(e,s,t){return s.load(t).then(()=>{const r=new R({disableExtraQuery:!0,query:`owner:${y} AND type:${m} AND typekeywords:"${e}"`});return s.queryItems(r,t)}).then(({results:r})=>{var l;let n=null;const u=e.toLowerCase();if(r&&Array.isArray(r)){for(const o of r)if(((l=o.typeKeywords)==null?void 0:l.some(a=>a.toLowerCase()===u))&&o.type===m&&o.owner===y){n=o;break}}if(!n)throw new b("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(t)})}function C(e,s,t){return(e==null?void 0:e.styleUrl)!=null?N(e.styleUrl,t):(e==null?void 0:e.styleName)!=null?$(e.styleName,s,t):Promise.reject(new b("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function q(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function A(e,s){for(const t of s)switch(t){case"cim":if(e.cimRef)return{format:t,url:encodeURI(e.cimRef)};break;case"web-gltf-basisu":{const r=c(e,"gltf_basisu");if(r)return{format:t,url:r};break}case"web-gltf":{const r=c(e,"gltf");if(r)return{format:t,url:r};break}case"web":{const r=c(e,"gltf");if(r)return{format:"web-gltf",url:r};if(e.webRef)return{format:t,url:encodeURI(e.webRef)};break}}}function c(e,s){var t,r;if(!U("enable-feature:force-wosr"))return(r=(t=e.formatInfos)==null?void 0:t.find(n=>n.type===s))==null?void 0:r.href}function I(e,s){const t={responseType:"json",query:{f:"json"},...s};return h(g(e),t)}const y="esri_en",m="Style",D="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{D as h,C as i,q as m,I as p,A as y};
