import{H as h,aw as f,cj as m}from"./Identifiable-_3rFZ1o6.js";import{c as y,f as b}from"./infoFor3D-dHKPbXlj.js";class w{constructor(t,r,s){this.assetName=t,this.assetMimeType=r,this.parts=s}equals(t){return this===t||this.assetName===t.assetName&&this.assetMimeType===t.assetMimeType&&m(this.parts,t.parts,(r,s)=>r.equals(s))}isOnService(t){return this.parts.every(r=>r.isOnService(t))}makeHash(){let t="";for(const r of this.parts)t+=r.partHash;return t}async toBlob(t){const{parts:r}=this;if(r.length===1)return r[0].toBlob(t);const s=await Promise.all(r.map(n=>n.toBlob(t)));return f(t),new Blob(s)}}class H{constructor(t,r){this.partUrl=t,this.partHash=r}equals(t){return this===t||this.partUrl===t.partUrl&&this.partHash===t.partHash}isOnService(t){return this.partUrl.startsWith(`${t.path}/assets/`)}async toBlob(t){const{data:r}=await h(this.partUrl,{responseType:"blob"});return f(t),r}}function T(e){return v(e==null?void 0:e.source)}const u=/^(model\/gltf\+json)|(model\/gltf-binary)$/,l=/\.(gltf|glb)/i;function v(e){switch(e==null?void 0:e.type){case"client":return Array.isArray(e.files)?e.files.some(i):i(e.files);case"service":return e.assets.some(i);case"loadable":return!0;default:return!1}}function i(e){if(e instanceof File){const{type:t,name:r}=e;return u.test(t)||l.test(r)}return u.test(e.assetMimeType)||l.test(e.assetName)}function $(e,t){if(!e)return!1;const{source:r}=e;return g(r,t)}function B(e,t){if(e===t)return!0;const{source:r}=e,{source:s}=t;if(r===s)return!0;if(r.type==="service"&&s.type==="service"){if(r.assets.length!==s.assets.length)return!1;const n=(a,c)=>a.assetName<c.assetName?-1:a.assetName>c.assetName?1:0,o=[...r.assets].sort(n),p=[...s.assets].sort(n);for(let a=0;a<o.length;++a)if(!o[a].equals(p[a]))return!1;return!0}return!1}function g(e,t){return e.type==="service"&&e.assets.every(r=>r.isOnService(t))}function M(e,t){return e instanceof File?y(e,t):b(e.assetMimeType,e.assetName,t)}function U(e){switch(e.type){case"client":return Array.isArray(e.files)?e.files:[e.files];case"service":return e.assets;case"loadable":return}}function q(e){return!!e.original}export{U as b,$ as f,w as i,B as m,H as n,T as o,q as v,M as y};
