import{s as y,as as I}from"./Identifiable-B58w9FD1.js";import{j as S}from"./layerUtils-CAMu1s-2.js";import{S as d,u as c,j as p,c as M,a as h,g as k,f as x,w as D}from"./typeUtils-Du36Z1Jr.js";import{a as L}from"./PictureMarkerSymbol-D6pzvUP4.js";import{m as v,u as F,a as j}from"./SimpleMarkerSymbol-B18xir4G.js";import{g as T}from"./TextSymbol-C7i9ol-5.js";import{D as U,L as E}from"./defaults3D-DzIVO-Cs.js";const C="#useCIMFallbackSymbology()",a={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function P(e,n=a){var i,f,u,g;if(!e)return{symbol:null};const{retainId:t=a.retainId,ignoreDrivers:o=a.ignoreDrivers,hasLabelingContext:l=a.hasLabelingContext,retainCIM:m=a.retainCIM,cimFallbackEnabled:r=a.cimFallbackEnabled}=n;let s=null;if(d(e)||e instanceof c)s=e.clone();else if(e.type==="cim"){const b=(f=(i=e.data)==null?void 0:i.symbol)==null?void 0:f.type;switch(b){case"CIMPointSymbol":s=m?e.clone():p.fromCIMSymbol(e);break;case"CIMLineSymbol":r&&(s=E.clone(),(u=n==null?void 0:n.logWarning)==null||u.call(n,C,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":r&&(s=U.clone(),(g=n==null?void 0:n.logWarning)==null||g.call(n,C,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!s)return{error:new y("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${b||"unknown"}' is unsupported in 3D`,{symbol:e})}}else if(e instanceof v)s=M.fromSimpleLineSymbol(e);else if(e instanceof F)s=p.fromSimpleMarkerSymbol(e);else if(e instanceof L)s=p.fromPictureMarkerSymbol(e);else if(e instanceof j)s=n.geometryType&&n.geometryType==="mesh"?h.fromSimpleFillSymbol(e):k.fromSimpleFillSymbol(e);else{if(!(e instanceof T))return{error:new y("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};s=l?x.fromTextSymbol(e):p.fromTextSymbol(e)}return t&&s&&s.type!=="cim"&&(s.id=e.id),!o||s.type==="cim"||s instanceof c||s.symbolLayers.forEach(b=>b.ignoreDrivers=!0),{symbol:s}}function J(e,n,t,o){const l=$(e,{},{context:o,isLabelSymbol:!1});l!=null&&I(t,l,n)}function K(e,n,t,o){const l=$(e,{},{context:o,isLabelSymbol:!0});l!=null&&(n[t]=l)}function w(e){return d(e)||e instanceof c}function W(e){return(e==null?void 0:e.type)==="polygon-3d"||(e==null?void 0:e.type)==="line-3d"}function $(e,n,t){var s;if(e==null)return null;const{context:o,isLabelSymbol:l}=t,m=o==null?void 0:o.origin,r=o==null?void 0:o.messages;if(m==="web-scene"&&!w(e)){const i=P(e,{retainCIM:!0,hasLabelingContext:l});return i.symbol!=null?i.symbol.write(n,o):(r==null||r.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:o,error:i.error})),null)}return S(o==null?void 0:o.layer)&&W(e)?(r==null||r.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${(s=o==null?void 0:o.layer)==null?void 0:s.declaredClass}'.`,{symbol:e,context:o})),null):(m==="web-map"||m==="portal-item"&&!S(o==null?void 0:o.layer))&&w(e)?(r==null||r.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:o})),null):e.write(n,o)}function N(e,n){return D(e,null,n)}export{P as a,a as g,J as i,K as p,N as u};
