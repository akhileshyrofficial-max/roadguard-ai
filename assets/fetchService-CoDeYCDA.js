import{A as f}from"./layerUtils-CAMu1s-2.js";import{H as L}from"./Identifiable-B58w9FD1.js";async function i(e,r){const{data:t}=await L(e,{responseType:"json",query:{f:"json",...r==null?void 0:r.customParameters,token:r==null?void 0:r.apiKey}});return t}const p=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function F(e,r){const{loadContext:t,...a}=r||{},n=t?await t.fetchServiceMetadata(e,a):await i(e,a),l=f();u(n),o(n);const c={serviceJSON:n,preferredHost:l};if((n.currentVersion??0)<10.5)return c;const y=`${e}/layers`,s=t?await t.fetchServiceMetadata(y,a):await i(y,a);return u(s),o(s),c.layersJSON={layers:s.layers,tables:s.tables},c}function m(e){const{type:r}=e;return!!r&&p.has(r)}function b(e){return e.type==="Table"}function o(e){var r,t;e.layers=(r=e.layers)==null?void 0:r.filter(m),e.tables=(t=e.tables)==null?void 0:t.filter(b)}function d(e){e.type||(e.type="Feature Layer")}function w(e){e.type||(e.type="Table")}function u(e){var r,t;(r=e.layers)==null||r.forEach(d),(t=e.tables)==null||t.forEach(w)}function O(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{O as l,F as n,i as t};
