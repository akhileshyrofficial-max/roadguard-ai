const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Popup-DW3H84ou.js","assets/Identifiable-_3rFZ1o6.js","assets/index-BEHHhRxI.js","assets/PopupTemplate-B09IYibB.js","assets/fieldUtils-z3GG2R-H.js","assets/intl-Beb5GWXc.js","assets/number-7p_O6jwX.js","assets/jsxFactory-BbJVeaDA.js","assets/uuid-Cl5lrJ4c.js","assets/sanitizerUtils-CJlLEeXg.js","assets/jsxFactory-CQED0rIl.css","assets/substitute-DH_Z8wN6.js","assets/unitFormatUtils-De5DoCJv.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/Cyclical-C1_PpBfH.js","assets/quantityUtils-CfVXs5z9.js","assets/Graphic-q_7OAYHf.js","assets/jsonUtils-Cc67rW5Z.js","assets/typeUtils-mxDsOnhk.js","assets/createFeatureId-BiB9j2WD.js","assets/typeUtils-Buir9u-w.js","assets/SimpleMarkerSymbol-Drowg4jp.js","assets/screenUtils-aQeO9QTD.js","assets/aaBoundingBox-DNlIzH5i.js","assets/TextSymbol-keZwKiPd.js","assets/PictureMarkerSymbol-DlgeV3xL.js","assets/AttachmentInfo-BUiGtPYo.js","assets/labelingInfo-CkSgsIBo.js","assets/asyncUtils-CmphLL3n.js","assets/Field-Bopg3Spw.js","assets/fieldType-Pks4G8In.js","assets/Query-Dp8boimB.js","assets/Layer--GugXUPW.js","assets/layerUtils-CFmFO8Du.js","assets/SimpleRenderer-Fz8G_PFF.js","assets/commonProperties-CEA2GgpB.js","assets/colorRamps-BmQEv1lz.js","assets/ColorStop-DY3WB4ha.js","assets/visualVariableUtils-DciVTowe.js","assets/lengthUtils-CrwfL9_h.js","assets/jsonUtils-MHL9p1Rq.js","assets/defaults3D-CE2uGgSa.js","assets/defaults-CSNv9gRz.js","assets/defaultsJSON-GKolV7NZ.js","assets/UniqueValueRenderer-CBLY0uWW.js","assets/diffUtils-C5CsICXC.js","assets/RendererLegendOptions-DWy2dLCX.js","assets/styleUtils-D7bnZHs6.js","assets/NormalizationBinParametersMixin-DdJue4AE.js","assets/labelUtils-BoctouOq.js","assets/featureUtils-CChhWskK.js","assets/utils-XTVqdLXj.js","assets/mat4f32-Djp3mnm5.js","assets/mat4-CEszlm-2.js","assets/common-DQOJ18NT.js","assets/timeZoneUtils-Cef7SfoB.js","assets/utils-BeNGKuUJ.js","assets/cimSymbolUtils-B2Z2xZbf.js","assets/utils-DrbBeUzW.js","assets/defaultCIMValues-BrbaHf9c.js","assets/enums-BPiq_WIC.js","assets/LRUCache-eBEVKbNU.js","assets/MemCache-CUhFgUMJ.js","assets/typeUtils-cqQ4KuGR.js","assets/ClassBreaksRenderer-zodgNWUT.js","assets/DictionaryScriptEvaluator-B-exTvTE.js","assets/Version-BR-Ucixf.js","assets/FieldsIndex-BTwzr3dJ.js","assets/UnknownTimeZone-CpPKXuRf.js","assets/ArcadeExpression-u2IaIuRW.js","assets/TimeOnly-YXxQ25V6.js","assets/enum-DaKdEk_o.js","assets/heatmapUtils-D0hGWZT9.js","assets/vec42-CKs01hkn.js","assets/vec4f64-DPb6J-GU.js","assets/executeQueryJSON-C4FbUfhf.js","assets/utils-C73sopP7.js","assets/query-BK4ukVuP.js","assets/normalizeUtils-BS0bJnzn.js","assets/normalizeUtilsCommon-Ca72SEzL.js","assets/utils-UVgDzRJn.js","assets/pbfQueryUtils-G12Ca3sG.js","assets/pbf-CS5_6Vtc.js","assets/memoryEstimations-BG_NSMOj.js","assets/OptimizedFeature-C57xHwXW.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/queryZScale-yLGROW-s.js","assets/projectionUtils-BdqPecQc.js","assets/FeatureSet-CZLo56w_.js","assets/shared-CaVpMDBF.js","assets/FeatureLayer-CxT1XW1O.js","assets/MultiOriginJSONSupport-uq7YIQYP.js","assets/layerContainerType-C5CzMsLd.js","assets/FeatureLayerBase-Btg77__s.js","assets/HeightModelInfo-C8sA4bKM.js","assets/OperationalLayer-Dmy6sOtR.js","assets/ElevationInfo-7Ug8ElGs.js","assets/LayerFloorInfo-cJezV6PW.js","assets/Relationship-C8higR9l.js","assets/serviceCapabilitiesUtils-DtEhtOqW.js","assets/infoFor3D-dHKPbXlj.js","assets/portalItemUtils-CHuQGePU.js","assets/workers-BcCT7nhd.js","assets/Queue-CJjQn74K.js","assets/editsZScale-DImaxYG9.js","assets/APIKeyMixin-CY_nGuXy.js","assets/ArcGISService-vS49SR2m.js","assets/BlendLayer-DNv82dbV.js","assets/jsonUtils-CO8m00ps.js","assets/parser-BgHAYnRY.js","assets/CustomParametersMixin-BZBJ7Ucu.js","assets/DisplayFilteredLayer-D5skuxIO.js","assets/scaleUtils-B8vcNDUc.js","assets/displayFilterUtils-Cgv563kp.js","assets/EditBusLayer-D6UEh88t.js","assets/FeatureEffectLayer-BVAVD5Ly.js","assets/FeatureEffect-Besyj6ew.js","assets/FeatureFilter-BsHSIm0M.js","assets/FeatureReductionLayer-CmcV73KP.js","assets/FeatureReductionSelection-DDsC7ChM.js","assets/jsonUtils-CBYo0IFI.js","assets/MD5-C9MwAd2G.js","assets/OrderedLayer-DcSF3ste.js","assets/OrderByInfo-CtU2L4kd.js","assets/PortalLayer-DgoCliAY.js","assets/PortalItem-Dn4oT_Gd.js","assets/RefreshableLayer-DF_vXnzd.js","assets/ScaleRangeLayer-5c4AXGq9.js","assets/TemporalLayer-YoR144NV.js","assets/TimeInfo-Bt4YU_aA.js","assets/TrackableLayer-DQq4EH5S.js","assets/FeatureTemplate-dMEKh0VK.js","assets/FeatureType-BPPh_J9c.js","assets/fieldProperties-Dvj3eBgF.js","assets/TitleCreator-CvM2Oihu.js","assets/versionUtils-Dr1dBWld.js","assets/styleUtils-DrVFIk9X.js","assets/popupUtils-aSReiMof.js","assets/interfaces-CL2NbQte.js","assets/ReactiveMap-DptZZMoQ.js","assets/NetworkElement-BO8cpIog.js","assets/ReactiveSet-CHvJ7TLe.js","assets/symbolUtils-DHWvduwZ.js","assets/colorUtils-DQQagumJ.js","assets/enums-NCSMZWP1.js","assets/TileKey-upwcIO5W.js","assets/vec2-ChnYg_BJ.js","assets/signal-R7pX2aet.js","assets/quickselect-QQC62dOK.js","assets/layerViewUtils-CSVHLqOP.js","assets/geometryServiceUtils-CW8-tlZS.js","assets/project-_gWcbImb.js","assets/webglDeps-DNAo8tU8.js","assets/ProgramTemplate-Dv_NJ-sZ.js","assets/Texture-BILrrMzS.js","assets/enums-UBzvFP7O.js","assets/getDataTypeBytes-D2DiHx_d.js","assets/FramebufferObject-Dg06wJiA.js","assets/NestedMap-C3hRTnZR.js","assets/mapViewDeps-8pyWrqvq.js","assets/UpdateTracking2D-D5YHt5xb.js","assets/BidiEngine-QXap_35O.js","assets/GeometryUtils-CiPYWcEQ.js","assets/definitions-CASyCajO.js","assets/rasterizingUtils-CdiTAUhT.js","assets/floatRGBA-xT4oRKt0.js","assets/vec2f32-CaVKkSa6.js","assets/Rect-CUzevAry.js","assets/Utils-BG5m93IY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/UpdatingHandles-BZb3Zh99.js","assets/FeatureCommandQueue-C3gIm0uk.js","assets/TechniqueType-CFPo0AVB.js","assets/GraphShaderModule-B0iY7h0y.js","assets/ShaderBuilder-CT-EKmsJ.js","assets/BindType-BBwFZqyN.js","assets/utils-BLo0aQ8v.js","assets/constants-BFLErLYb.js","assets/mat3-CruJiiUv.js","assets/WGLContainer-CidQwXho.js","assets/vec32-soPbwaVZ.js","assets/vec3f32-WCVSSNPR.js","assets/Container-CcJYSbbJ.js","assets/StyleDefinition-C4LQ4gTA.js","assets/config-DHajyIwB.js","assets/earcut-D9gy186-.js","assets/vec2f64-Cgb6qxNH.js","assets/featureConversionUtils-scwmf_ir.js","assets/streamLayerUtils-CKwt2uXH.js","assets/capabilities-Cggz07g5.js","assets/QueueProcessor-BZCvf8_s.js","assets/SDFHelper-EJAJdqNv.js","assets/PieChartMeshWriter-DnCRRp1U.js","assets/libtess-B86nGuKR.js","assets/OverrideHelper-_hwADhTN.js","assets/quantizationUtils-C8uJ5ebt.js","assets/constants-B-jzO-JJ.js","assets/GridShader-Dv5Fz5bs.js","assets/CircularArray-CujHzHWW.js","assets/testSVGPremultipliedAlpha-BPqm-Uh3.js","assets/SymbolFader-CnPSz6v-.js","assets/RenderingContext-BTozc1lL.js","assets/renderState-vHoqBeQT.js","assets/basicInterfaces-CZwQPxTp.js","assets/glsl-Cj7KC756.js","assets/CIMResourceManager-BmtmCbaH.js","assets/imageUtils-DN-q3Lg0.js","assets/AttributeStore-BDrrFxke.js","assets/queryUtils-Cag0ceeo.js","assets/json-Wa8cmqdu.js","assets/timeSupport-Btk7Sbvt.js","assets/utils-CNfsty9w.js","assets/utils-ehcGqGxa.js","assets/MeshWriterRegistry-XUlgEad9.js","assets/projectOperator-B6vKz19-.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/GraphicsView2D-BkBvRhzC.js","assets/normalizeUtilsSync-2v9P1_zl.js","assets/mat3f64-B5o_lm6j.js","assets/dehydratedFeatures-D_C0Fb3K.js","assets/GraphicContainer-DMs6IM9M.js","assets/AGraphicContainer-sL5vbjCA.js","assets/TechniqueInstance-DAQJyYqb.js","assets/TileContainer-C_diT5X9.js","assets/requestImageUtils-BHk_87m3.js","assets/gridUtils-Ctb4KHSB.js","assets/geodesicUtils-5UKmzzQW.js","assets/CollectionFlattener-kjXuGTXg.js","assets/TileInfo-CvSYzqJL.js","assets/TileKey-DZd6gJy7.js","assets/Map-BfsPAzzq.js","assets/Basemap-xdFWd_Ef.js","assets/loadAll-MI_JOpdU.js","assets/writeUtils-CFLt5Al1.js","assets/persistable-DdbzkEuJ.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/resourceExtension-a1-4zqTB.js","assets/PolygonCollection-CMbOuNoO.js","assets/TablesMixin-DOSIq3qh.js","assets/GraphicsCollection-csXasQht.js","assets/ViewingMode-Chk7YAAL.js","assets/Scheduler-DH2YvKGe.js","assets/unitBezier-B1N-tmtC.js","assets/ILyr3DWasmPerSceneView-CIC-HPGZ.js","assets/TileLayerView2D-BSlMYYAA.js","assets/imageUtils-Cx4QjZJ2.js","assets/BitmapTechnique-xCyagY7Y.js","assets/bitmapUtils-DvN83-9m.js","assets/LayerView-DyDwgwDB.js","assets/HighlightGraphicContainer-D7GDFClf.js","assets/RefreshableLayerView-GSOltMDM.js","assets/MapServiceLayerViewHelper-CDmQsaSN.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/drapedUtils-BVag5CrE.js","assets/sublayerUtils-B8JaGme3.js","assets/popupUtils-DzrmKBBc.js","assets/FeatureLayerView2D-ChmIZwDV.js","assets/timeSupport-gVZAI8mD.js","assets/AttributeBinsFeatureSet-CHA21y0Q.js","assets/AttributeBinsQuery-30UZm1jY.js","assets/FixedIntervalBinParameters-CqHG-zwl.js","assets/constants-B4mRqufT.js","assets/bundle-D2hyHz7d.js","assets/BaseDynamicLayerView2D-DUe0qMK3.js","assets/BitmapContainer-VJVQOq6k.js","assets/ExportStrategy-CbQ59ezd.js","assets/CatalogLayerView2D-8fNC9PEN.js","assets/CatalogDynamicGroupLayerView2D-B7SE9GHl.js","assets/CatalogFootprintLayerView2D-T0O2fXhE.js","assets/GeoRSSLayerView2D-BmW4b_Ak.js","assets/GraphicsLayerView2D-CeMShTUF.js","assets/GroupLayerView2D-Di-54unU.js","assets/ImageryLayerView2D-BwVfx9rG.js","assets/RasterVFDisplayObject-DgIR_Dq-.js","assets/dataUtils-Dr5KRzjN.js","assets/rasterProjectionHelper-BWJ4uK2N.js","assets/ImageryTileLayerView2D-Chi_SsaL.js","assets/rasterFieldUtils-BbQcz_gX.js","assets/clipUtils-CEFueasy.js","assets/rasterUtils-DnbLY2u1.js","assets/RawBlockCache-b0wY4EX8.js","assets/KMLLayerView2D-CnDz6IMB.js","assets/kmlUtils-K6ig3f5B.js","assets/KnowledgeGraphLayerView2D-0i2JFw9N.js","assets/MapImageLayerView2D-Dp9Rx7NV.js","assets/ExportImageParameters-DWt4-sUL.js","assets/MapNotesLayerView2D-5rukOnFy.js","assets/MediaLayerView2D-CVeLhojF.js","assets/mediaLayerUtils-B7Aj9Jts.js","assets/OverlayContainer-CG2Momag.js","assets/OGCFeatureLayerView2D-Y_CMGnnc.js","assets/RouteLayerView2D-CkkUQgn3.js","assets/Stop-BpZ8Nuyu.js","assets/networkEnums-BTp20v-Z.js","assets/StreamLayerView2D-D5-hDpb4.js","assets/SubtypeGroupLayerView2D-BA4tWaIz.js","assets/VectorTileLayerView2D-WmYFH3Xx.js","assets/PooledRBush-2eGRraPp.js","assets/SourceLayerData-BJB4U_h7.js","assets/StyleRepository-Q1LEsAh-.js","assets/VideoLayerView2D-DQCEDrIf.js","assets/GraphicsLayer-BOJ0yOnh.js","assets/videoUtils-C4w_3COM.js","assets/WMSLayerView2D-wHbrTaJs.js","assets/ExportWMSImageParameters-eyFOJIip.js","assets/WMTSLayerView2D-C-aB_1Zx.js","assets/index-BFWbvBcD.js","assets/index-_Ag5rtba.js","assets/guid-BDl_6nd0.js","assets/useT9n-C080QOay.js","assets/index-3TKMVsV8.js","assets/index-lr6cVL0a.js","assets/dom-DcfdSJVS.js","assets/observers-CqUKp5t5.js","assets/ref-bIC_P-xI.js","assets/static-BZPObv-T.js","assets/form-DekSZlej.js","assets/interactive-D090CDYx.js","assets/label-Cb6655Fi.js","assets/useSetFocus-CyiUeX0K.js"])))=>i.map(i=>d[i]);
import{c as r,m as h,d as v,ad as Nn,T as Ei,a0 as L,dK as $e,ab as vr,ac as _r,cz as Qe,ah as Lt,l as w,f as W,fA as Kt,x,V as R,i as E,gb as bt,B as ue,dc as Oo,e as Zt,b5 as F,gu as wr,gv as br,gw as rs,bC as ne,dw as Fn,s as S,gx as Mr,cR as xr,aw as He,aA as Ii,bJ as qt,a6 as Ri,bA as Lo,L as At,aN as Ao,cD as ls,gy as Tr,aS as se,cl as Pr,aI as $r,cS as zo,c5 as Sr,gz as Gt,ao as kr,f6 as Cr,p as Er,z as gn,dS as Ir,b as fn,A as hs,a7 as Rr,dQ as Yt,aB as Vr,e2 as Dr,el as No,db as Fo,U as zt,g as it,u as ce,k as cs,du as Or,a as Vi,aW as Lr,a3 as nt,al as yi,cm as Di,bY as Ho,aP as Zo,a4 as qo,b1 as Go,aC as Wo,gA as Ar,dv as Hn,eH as Zn,gB as jo,X as Uo,_ as us,b$ as zr,cQ as Nr,b6 as oe,gC as Fr,fd as Jt,ex as ee,ew as Hr,fC as Zr,fD as qr,b3 as Qt,ar as Gr,ep as Wr,gD as ds,bL as jr,g0 as Ur,cK as Br,c2 as Kr,aY as Yr,gE as Jr,gF as Qr,cT as ps,n as Xr,b0 as el}from"./Identifiable-_3rFZ1o6.js";import{_ as M}from"./index-BEHHhRxI.js";import{a as tl}from"./Cyclical-C1_PpBfH.js";import{f as ms}from"./jsonUtils-Cc67rW5Z.js";import{l as il}from"./typeUtils-mxDsOnhk.js";import{l as Bo}from"./CollectionFlattener-kjXuGTXg.js";import{m as nl}from"./workers-BcCT7nhd.js";import{J as sl,O as Wt,k as qn,L as Gn,K as Wn,U as ol}from"./projectionUtils-BdqPecQc.js";import{l as al,j as rl}from"./TileInfo-CvSYzqJL.js";import{q as gs,M as Ko,N as fs,H as ll,G as hl,P as cl,O as Oi,v as K,w as Li,u as jn,A as ul}from"./jsxFactory-BbJVeaDA.js";import{h as Ai}from"./UpdatingHandles-BZb3Zh99.js";import{d as Un,_ as dl}from"./asyncUtils-CmphLL3n.js";import{s as ys}from"./Queue-CJjQn74K.js";import{r as pl}from"./signal-R7pX2aet.js";import{L as ml}from"./Map-BfsPAzzq.js";import{n as gl,c as Yo,l as vs}from"./GraphicsCollection-csXasQht.js";import{m as zi}from"./HeightModelInfo-C8sA4bKM.js";import{h as fl,u as yl}from"./Layer--GugXUPW.js";import{p as vl}from"./timeZoneUtils-Cef7SfoB.js";import{c as H}from"./screenUtils-aQeO9QTD.js";import{s as _l}from"./ReactiveMap-DptZZMoQ.js";import{g as ut,p as _s,c as wl,s as bl}from"./layerUtils-CFmFO8Du.js";import{R as ws}from"./Query-Dp8boimB.js";import{l as bs}from"./ViewingMode-Chk7YAAL.js";import{n as Wi}from"./TablesMixin-DOSIq3qh.js";import{S as Se,u as Ml,e as yn,v as Ms,y as xl,j as Tl,q as xs,B as Jo,l as Ni,o as N,x as Pl,r as Ot,m as $l}from"./vec2-ChnYg_BJ.js";import{n as A,r as Sl}from"./vec2f64-Cgb6qxNH.js";import{u as Qo,e as ji}from"./common-DQOJ18NT.js";import{M as kl,k as Bn,l as Xo,d as Fi,i as Nt,m as Cl,u as ea,n as El,c as Il,a as Rl,j as Ts,s as Vl,R as Ps,h as Dl}from"./enums-NCSMZWP1.js";import{P as Kn,v as Ol}from"./normalizeUtils-BS0bJnzn.js";import{r as Ll,o as Al,M as $s,h as zl,i as Nl}from"./mat3-CruJiiUv.js";import{r as Ss}from"./vec2f32-CaVKkSa6.js";import{I as Fl,a as Xt}from"./Scheduler-DH2YvKGe.js";import{g as Hl}from"./vec32-soPbwaVZ.js";import{t as ei}from"./unitBezier-B1N-tmtC.js";import{e as Zl}from"./TileKey-upwcIO5W.js";import{I as ql,K as Gl,V as ti,a as ks}from"./definitions-CASyCajO.js";import{P as Wl,D as Ui,C as jl}from"./enums-UBzvFP7O.js";import{a as Ul,S as Bl}from"./Texture-BILrrMzS.js";import Kl from"./Graphic-q_7OAYHf.js";import{s as Yl}from"./imageUtils-DN-q3Lg0.js";import{t as Jl}from"./capabilities-Cggz07g5.js";import"./intl-Beb5GWXc.js";import"./ILyr3DWasmPerSceneView-CIC-HPGZ.js";import{r as Ql}from"./Version-BR-Ucixf.js";let We=class extends Nn{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};r([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],We.prototype,"row",void 0),r([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],We.prototype,"column",void 0),r([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],We.prototype,"rows",void 0),r([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],We.prototype,"columns",void 0),We=r([v("esri.CameraLayout")],We);const ta=We;let pe=class extends Nn.ClonableMixin(Ei){constructor(...e){super(...e),this.position=new L([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new ta}normalizeCtorArgs(e,t,n,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const o={position:e};return t!=null&&(o.heading=t),n!=null&&(o.tilt=n),s!=null&&(o.fov=s),o}return e}writePosition(e,t,n,s){const o=e.clone();o.x=$e(e.x||0),o.y=$e(e.y||0),o.z=e.hasZ?$e(e.z||0):e.z,t[n]=o.write({},s)}readPosition(e,t){const n=new L;return n.read(e,t),n.x=$e(n.x||0),n.y=$e(n.y||0),n.z=n.hasZ?$e(n.z||0):n.z,n}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};r([h({type:L,json:{write:{isRequired:!0}}})],pe.prototype,"position",void 0),r([vr("position")],pe.prototype,"writePosition",null),r([_r("position")],pe.prototype,"readPosition",null),r([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Qe(i=>tl.normalize($e(i)))],pe.prototype,"heading",void 0),r([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Qe(i=>Lt($e(i),-180,180))],pe.prototype,"tilt",void 0),r([h({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Qe(i=>Lt($e(i,55),1,170))],pe.prototype,"fov",void 0),r([h({type:ta,nonNullable:!0,json:{read:!1,write:!1}})],pe.prototype,"layout",void 0),pe=r([v("esri.Camera")],pe);const Xl=pe;var vn;let Ve=vn=class extends Ei{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new vn({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};r([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Bi}}}}})],Ve.prototype,"rotation",void 0),r([Qe("rotation")],Ve.prototype,"castRotation",null),r([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Bi}}}}})],Ve.prototype,"scale",void 0),r([h({types:il,json:{read:ms,write:!0,origins:{"web-scene":{read:ms,write:{overridePolicy:Bi}}}}})],Ve.prototype,"targetGeometry",void 0),r([h({type:Xl,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Ve.prototype,"camera",void 0),Ve=vn=r([v("esri.Viewpoint")],Ve);const ae=Ve;function Bi(){return{enabled:!this.camera}}const ri={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],n=e[1],s=this.values;return n>=t?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Ki={xsmall:544,small:768,medium:992,large:1200};function eh(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Yi(i,e){return e?ri[i].valueToClassName[e].split(" "):[]}const th=i=>{let e=class extends i{constructor(...t){super(...t),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Ki}initialize(){this.addHandles(w(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),W))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(t){if(t!==this._get("breakpoints")){if(!eh(t)){const n=JSON.stringify(Ki,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n),t=Ki}this._set("breakpoints",{...t})}}_updateClassNames(){if(!this.container)return;const t=Kt.acquire(),n=Kt.acquire();let s,o=!1;for(s in ri){const a=this[s],l=ri[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[s]=l,Yi(s,a).forEach(c=>n.push(c)),Yi(s,l).forEach(c=>t.push(c)))}o&&(this._applyClassNameChanges(t,n),Kt.release(t),Kt.release(n))}_applyClassNameChanges(t,n){const s=this.container;s&&(n.forEach(o=>s.classList.remove(o)),t.forEach(o=>s.classList.add(o)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let n;for(n in ri)Yi(n,this[n]).forEach(s=>t.classList.remove(s))}};return r([h()],e.prototype,"breakpoints",null),r([h()],e.prototype,"orientation",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),r([h()],e.prototype,"heightBreakpoint",void 0),e=r([v("esri.views.BreakpointsOwner")],e),e};let De=class extends x{constructor(){super(...arguments),this.items=new R,this._watchUpdatingTracking=new Ai,this._callbacks=new Map,this._projector=gs(),this._hiddenProjector=gs()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const n of t.added){const s=()=>n.render();this._callbacks.set(n,s),this._projector.append(this.surface,s)}for(const n of t.removed){const s=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(s.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,n=this._hiddenProjector;let s;const o=()=>(s=e.render(),s);n.append(t,o),n.renderNow();const a={left:0,top:0,right:0,bottom:0};if(s!=null&&s.domNode){const l=s.domNode.getBoundingClientRect();a.left=l.left,a.top=l.top,a.right=l.right,a.bottom=l.bottom}for(n.detach(o);t.firstChild;)t.removeChild(t.firstChild);return a}overlaps(e,t){const n=this.computeBoundingRect(e),s=this.computeBoundingRect(t);return Math.max(n.left,s.left)<=Math.min(n.right,s.right)&&Math.max(n.top,s.top)<=Math.min(n.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,t){const n=!!(t!=null&&t.disableDecorations);if(!this.items.some(o=>o.visible&&!(n&&o.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(o=>{n&&o.isDecoration||(s.save(),o.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};r([h({readOnly:!0})],De.prototype,"surface",void 0),r([h({readOnly:!0})],De.prototype,"items",void 0),r([h({readOnly:!0})],De.prototype,"needsRender",null),r([h({readOnly:!0})],De.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],De.prototype,"updating",null),De=r([v("esri.views.overlay.ViewOverlay")],De);const Cs=De,Ji=[0,0];function ih(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return Ji[0]=t.left+((e==null?void 0:e.pageXOffset)??0),Ji[1]=t.top+((e==null?void 0:e.pageYOffset)??0),Ji}function Es(i){i&&(i.textContent="",i.parentNode&&i.parentNode.removeChild(i))}function nh(i){const e=document.createElement("div");return i.appendChild(e),e}const at=16,Tt=750,sh=512,oh=2,ah=i=>{let e=class extends i{constructor(...t){super(...t),this._freqInfo={freq:at,time:Tt},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([w(()=>this.cursor,n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)}),w(()=>this.navigating,n=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",n.toString())})])}initialize(){this.addHandles([w(()=>this.ui,(t,n)=>this._handleUIChange(t,n),W),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){var t;this.destroyed||((t=this.ui)==null||t.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const n=this._get("container"),s=Ko(t);if(s||typeof t!="string"||E.getLogger(this).error("#container",`element with id '${t}' not found`),n===s)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Es(this.root),this._set("root",null)),this.userContent&&(fs(this.userContent,n),Es(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",fs(s,o),s.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",s.insertBefore(a,s.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new Cs;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(w(()=>c.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=bt({render:()=>{var d;return(d=this.overlay)==null?void 0:d.render()}}):this._overlayRenderTaskHandle=ue(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get size(){return[this.width,this.height]}set ui(t){const n=this._get("ui");n!==t&&(n==null||n.destroy()),this._set("ui",t)}blur(){var t;(t=this.surface)==null||t.blur()}focus(){var t;(t=this.surface)==null||t.focus()}pageToContainer(t,n,s){const o=this.position;return t-=o?o[0]:0,n-=o?o[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}containerToPage(t,n,s){const o=this.position;return t+=o?o[0]:0,n+=o?o[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}_handleUIChange(t,n){this.removeHandles("ui"),n&&n!==t&&n.destroy(),t&&(t.view=this,this.addHandles(w(()=>this.root,s=>{t.container=s?nh(s):null},W),"ui")),this._set("ui",t)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=at,t.time=Tt;const n=bt({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=at,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const u=this._position();c.freq=u||l?at:Math.min(Tt,c.freq*oh),!l&&c.freq>=sh&&(n.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver(a=>{t.freq=at,t.time=Tt,n.resume()});this.container!=null&&s.observe(this.container);const o=Zt(()=>s.disconnect());this.addHandles([Oo(window,"resize",()=>{t.freq=at,t.time=Tt,n.resume()}),o,n],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,n=t?t.clientWidth:0,s=t?t.clientHeight:0;if(n===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return n===o&&s===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:n,height:s}),!0)}_position(){const t=this.container,n=this.position,s=t&&ih(t);return!!s&&(!n||s[0]!==n[0]||s[1]!==n[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return r([h()],e.prototype,"container",null),r([h({readOnly:!0})],e.prototype,"focused",null),r([h({readOnly:!0})],e.prototype,"height",void 0),r([h()],e.prototype,"messagesCommon",void 0),r([h({type:Cs})],e.prototype,"overlay",void 0),r([h({readOnly:!0})],e.prototype,"position",void 0),r([h({readOnly:!0})],e.prototype,"resizing",void 0),r([h({readOnly:!0})],e.prototype,"root",void 0),r([h({value:null,readOnly:!0})],e.prototype,"size",null),r([h({readOnly:!0})],e.prototype,"surface",void 0),r([h({readOnly:!0})],e.prototype,"suspended",void 0),r([h({nonNullable:!0})],e.prototype,"ui",null),r([h({readOnly:!0})],e.prototype,"userContent",void 0),r([h({readOnly:!0})],e.prototype,"width",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),e=r([v("esri.views.DOMContainer")],e),e},ia=F("mac")?"Meta":"Control",rh=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),lh=i=>rh.has(i);let hh=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const n of this.keyModifiers)if(!t.has(n))return!1;return!0}},z=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const n of t)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,n){let s;typeof t=="function"?(n=t,s=[]):s=t||[];const o=typeof e=="string"?new hh(e,s):e,a=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=d=>{const m=this._incoming[d.match.eventType];if(m){const p=m.indexOf(d);m.splice(p,1),a(),this._manager&&this._manager.updateDependencies()}},c=new ch(o,n,{onPause:l,onRemove:l,onResume:d=>{const m=this._incoming[d.match.eventType];m&&!m.includes(d)&&(m.push(d),a(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[o.eventType];return u||(u=[],this._incoming[o.eventType]=u),u.push(c),a(),this._manager&&this._manager.updateDependencies(),c}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new uh(e,{onEmit:(n,s,o,a)=>{var l;(l=this._manager)==null||l.emit(n.eventType,s,o,a)},onRemove:n=>{var s;delete this._outgoing[n.eventType],(s=this._manager)==null||s.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){var n;const t=this._incoming[e.type];if(t){for(const s of t)if(s.match.matches(e)&&((n=s.callback)==null||n.call(s,e),e.shouldStopPropagation()))break}}},ch=class{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},uh=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},dh=class extends z{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>this._update(t.data))}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:s}=e;t===this._value&&this._x===n&&this._y===s||(this._value=t,this._x=n,this._y=s,this._onChange(t,n,s))}},ph=class extends z{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=pl(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},mh=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const n in e){const s=e[n],o=new wr(s,void 0,void 0,2,2);this._properties[n]={pool:o,acquired:[]}}this._afterDispatchHandle=br(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const n of t.acquired)rs(n)||t.pool.release(n);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),n=this._properties[e];let s=n.pool.acquire();for(n.acquired.push(s);s===t;)n.acquired.push(s),s=n.pool.acquire();return s}_release(){for(const e in this._properties){const t=this._properties[e];let n=0;for(const s of t.acquired)rs(s)?t.acquired[n++]=s:t.pool.release(s);t.acquired.length=n}}},te=class extends x{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=ia,this._latestPointerType="mouse",this._propertiesPool=new mh({latestPointerLocation:yh},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,t,n=Ce.INTERNAL){if(this._nameToGroup[e]||t.length===0)return;const s={name:e,handlers:t.map(o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let o=s.handlers.length-1;o>=0;o--){const a=s.handlers[o];this._handlers.push(a),a.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,c,u,d,m)=>{this._emitInputEvent(a.priorityIndex+1,l,c,u,m,d)},setPointerCapture:(l,c)=>{this._setPointerCapture(s,a,l,c)},setEventCallback:l=>{a.eventCallback=l},setUninstallCallback:l=>{a.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(n=>{var s;n.removed=!0,(s=n.uninstallCallback)==null||s.call(n)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):E.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const s=this._handlers[n];s.priorityIndex=n,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const s=this._handlersPriority[n];s.priorityIndex=n;let o=s.handler.hasSideEffects;if(!o){for(const a of s.handler.outgoingEventTypes)if(e.has(a)){o=!0;break}}if(o)for(const a of s.handler.incomingEventMatches){e.add(a.eventType);for(const l of a.keyModifiers)lh(l)||t.add(l)}s.active=o}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,n){this._latestPointerType=e;const s=this._get("latestPointerLocation");if(s==null||s.x!==t||s.y!==n){const o=this._propertiesPool.get("latestPointerLocation");o.x=t,o.y=n,this._set("latestPointerLocation",o)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const o=t;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,t);const n=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,s=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,n,s)}_updateKeyModifiers(e,t){if(!t)return;let n=!1;const s=()=>{n||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),n=!0)},o=(l,c)=>{c&&!this._activeKeyModifiers.has(l)?(s(),this._activeKeyModifiers.add(l)):!c&&this._activeKeyModifiers.has(l)&&(s(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=t.key;this._keyModifiers.has(l)&&o(l,e==="key-down")}const a=t.native;o("Alt",!!(a!=null&&a.altKey)),o("Control",!!(a!=null&&a.ctrlKey)),o("Ctrl",!!(a!=null&&a.ctrlKey)),o("Shift",!!(a!=null&&a.shiftKey)),o("Meta",!!(a!=null&&a.metaKey)),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new dh((e,t,n)=>this._setLatestPointer(e,t,n)),this._multiTouchHandler=new ph,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Ce.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Ce.INTERNAL)}_setPointerCapture(e,t,n,s){const o=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,a),s?(a.add(o),a.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):a.has(o)&&(a.delete(o),a.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,n,s){this._emitInputEvent(0,e,t,n,s)}_emitInputEvent(e,t,n,s,o,a){const l=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),c=o!==void 0&&o,u={event:new gh(t,n,l,a||this._activeKeyModifiers,c),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new ys,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,n,s;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:o,priorityIndex:a}=e.events.pop(),l=(t=o.data)==null?void 0:t.eventId;if(!(l!=null&&this._stoppedPropagationEventIds.has(l)))for(e.currentHandler=this._handlersPriority[a];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!o.shouldStopPropagation()&&((s=(n=e.currentHandler).eventCallback)==null||s.call(n,o)),o.shouldStopPropagation()){l!=null&&this._stoppedPropagationEventIds.add(l);break}if(o.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:o,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const t=new ys;t.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)t.push(n.events.pop());n.events=t,n.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const s of t.handler.incomingEventMatches){if(n.eventType!==s.eventType)continue;const o=n.keyModifiers.filter(a=>s.keyModifiers.includes(a));if(o.length===n.keyModifiers.length!=(o.length===s.keyModifiers.length))return n.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const n of e){let s=0;for(;s<t.length&&this._compareHandlerPriority(n,t[s])>=0;)s++;t.splice(s,0,n)}return t}get debug(){const e=t=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=n};return{injectEvent:(t,n)=>{e(()=>this._onEventReceived(t,n))},disablePointerCapture:e}}};r([h({readOnly:!0})],te.prototype,"hasPendingInputs",null),r([h({constructOnly:!0})],te.prototype,"eventSource",void 0),r([h({constructOnly:!0})],te.prototype,"recognizers",void 0),r([h()],te.prototype,"_latestPointerType",void 0),r([h()],te.prototype,"latestPointerType",null),r([h()],te.prototype,"multiTouchActive",null),r([h({readOnly:!0})],te.prototype,"latestPointerLocation",void 0),r([h()],te.prototype,"_paused",void 0),r([h({readOnly:!0})],te.prototype,"updating",null),te=r([v("esri.views.input.InputManager")],te);let gh=class{constructor(e,t,n,s,o){this.type=e,this.data=t,this.timestamp=n,this.modifiers=s,this.cancelable=o,this._propagationState=Fe.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Fe.STOPPED}shouldStopPropagation(){return(this._propagationState&Fe.STOPPED)!==0}defer(e){this._propagationState|=Fe.PAUSED;const t=(n,s)=>{this._propagationState&=~Fe.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),s)throw n;return n};return(typeof e=="function"?e():e).then(n=>t(n,!1),n=>t(n,!0))}shouldPausePropagation(e){return!!(this._propagationState&Fe.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Fe;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Fe||(Fe={}));const Ce={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let fh=class{};const yh=fh;function Ie(i){return i!=null&&"open"in i&&"declaredClass"in i}function Is(i){return i!=null&&"declaredClass"in i&&"dockOptions"in i}const vh=i=>{let e=class extends i{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([w(()=>[this.ui,this.popup],([t,n],s)=>{const o="popup",a="manual";if(s){const[l,c]=s;l&&Ie(c)&&(c.view=null,Is(c)&&(l.remove(c,o),c!==n&&n&&c.destroy()))}t&&Ie(n)&&(n.view=this,Is(n)&&t.add(n,{key:o,position:a,internal:!0}))},ne),this.on("click",t=>{this.popup&&this.popupEnabled&&(t.pointerType!=="mouse"||t.button===0)&&(Ie(this.popup)?this.popup.viewModel.handleViewClick(t):t.defer(async()=>{await this.setupPopup(),Ie(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(t)}))},Ce.WIDGET)]),Fn(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{M(()=>import("./Popup-DW3H84ou.js").then(t=>t.P),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(t){if(Ie(this.popup))return this.popup.open(t);try{if(await this.setupPopup(),!this.popup)return void E.getLogger(this).error(new S("view:null-popup","Popup is null and can't be opened"));this.popup.open(t)}catch{}}closePopup(){var t;(t=this._popupSetupTask)==null||t.abort(),Ie(this.popup)&&this.popup.close()}async fetchPopupFeatures(t,n){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(t,n),n)}async setupPopup(){var t;if((t=this._popupSetupTask)==null||t.abort(),this.popup&&!Ie(this.popup))return this._popupSetupTask=Un(async n=>{const{default:s}=await M(()=>import("./Popup-DW3H84ou.js").then(a=>a.P),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149]));if(He(n),!this.popup||Ie(this.popup))return;const o=this.popup;delete o.open,delete o.close,this.popup=new s(o)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:t,hits:n},s){const o=[],a=[];let l=!1;const c=Mr(s,F("popup-view-fetch-timeout")??wh),u=p=>{const g=new _h(p);return a.push(g),o.push(g.promise),g},d=p=>{const g=a.at(-1);return g&&g.layerView===p&&!l?g:u(p)};for(const p of n)"graphic"in p?(d(p.layerView).graphics.push(p.graphic),l=!1):(o.push(p.layerView.fetchPopupFeaturesAtLocation(p.mapPoint,c)),l=!0);a.map(p=>p.resolve(c));const m=xr(o).then(p=>p.filter(g=>!!g).flat());return{pendingFeatures:o,allGraphicsPromise:m,location:t}}async _getPopupHits(t,n){const{hits:s,location:o}=await this.popupHitTest(t);He(n);const a=[];for(const l of s)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,n)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(t,n){return t&&!!t.getEffectivePopupTemplate(n==null?void 0:n.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(t){return!t||(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesFromGraphics"in t}_isValidPopupLocationLayerView(t){return(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesAtLocation"in t}};return r([h()],e.prototype,"popup",void 0),r([h()],e.prototype,"popupEnabled",void 0),e=r([v("esri.views.PopupView")],e),e};let _h=class{constructor(e){this.layerView=e,this._resolver=Ii(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:t,graphics:n,_resolver:s}=this;if(!t)return s.resolve(n),s.promise;let o;return t.fetchPopupFeaturesFromGraphics(n,e).catch(a=>(o=a,null)).then(a=>{a?s.resolve(a):s.reject(o)}),s.promise}};const wh=5e3;let vi=class extends gl{constructor(e){super(e),this.addHandles(this.on("before-add",t=>{t.item!=null&&t.item.parent===this.owner&&(E.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};vi=r([v("esri.support.AnalysesCollection")],vi);let Oe=class extends x{constructor(e){super(e),this.view=null,this.baseLayerViews=new R,this.referenceLayerViews=new R,this._loadingHandle=w(()=>{var t,n;return(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap},t=>{t&&t.load().catch(()=>{})},W)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){var e;return((e=this.view)==null?void 0:e.suspended)??!0}get updating(){var t,n,s;if((t=this.view)!=null&&t.suspended)return!1;const e=(s=(n=this.view)==null?void 0:n.map)==null?void 0:s.basemap;return!!(e!=null&&e.loaded)&&(this.baseLayerViews.some(o=>o.updating)||this.referenceLayerViews.some(o=>o.updating))}};r([h({constructOnly:!0})],Oe.prototype,"view",void 0),r([h({readOnly:!0})],Oe.prototype,"baseLayerViews",void 0),r([h({readOnly:!0})],Oe.prototype,"referenceLayerViews",void 0),r([h({readOnly:!0})],Oe.prototype,"suspended",null),r([h({type:Boolean,readOnly:!0})],Oe.prototype,"updating",null),Oe=r([v("esri.views.BasemapView")],Oe);const bh=Oe;let J=class extends x{constructor(e){super(e),this.factor=1.5,this.offset=H(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};r([h({type:Number})],J.prototype,"factor",void 0),r([h({nonNullable:!0})],J.prototype,"offset",void 0),r([h()],J.prototype,"position",void 0),r([h({type:Number,range:{min:0}})],J.prototype,"size",void 0),r([h()],J.prototype,"maskUrl",void 0),r([h()],J.prototype,"maskEnabled",void 0),r([h()],J.prototype,"overlayUrl",void 0),r([h()],J.prototype,"overlayEnabled",void 0),r([h({readOnly:!0})],J.prototype,"version",null),r([h({type:Boolean})],J.prototype,"visible",void 0),J=r([v("esri.views.Magnifier")],J);const na=J;function Re(i){return!(i==null||typeof i!="object"||!("createQuery"in i)||!i.createQuery)}let ie=class extends qt.EventedAccessor{constructor(e){super(e),this._selectionMap=new _l,this._sources=new R,this._trashCan=[],this._layerEditHandles=new R,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([w(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),w(()=>this.view,e=>{e==null||e.when().then(()=>this.syncSources())},W),Ri(()=>this.sources,"change",e=>{var s;const t=this._selectionMap,n=[];for(const o of e.removed){const a=t.get(o);a&&(t.delete(o),(s=a.highlightHandle)==null||s.remove(),n.push({layer:o,selection:[],added:[],removed:[...a.selection]}))}this._refreshListeners(),n.length&&this._onSelectionChange(n)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(ue)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[t,n]=e;return{layer:t,selection:[...n.selection]}})}get count(){let e=0;for(const t of this._selectionMap.values())e+=t.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Lo(e,this._sources)}syncSources(){var s;const e=new Set,t=(s=this.view)==null?void 0:s.map;if(!t)return;const n=o=>{var a,l,c,u,d;wl(o)?((a=o.layers)==null||a.forEach(n),(l=o.tables)==null||l.forEach(n)):bl(o)?((c=o.sublayers)==null||c.forEach(n),(u=o.subtables)==null||u.forEach(n)):_s(o)?(d=o.sublayers)==null||d.forEach(n):Re(o)&&e.add(o)};t.allLayers.forEach(n),t.allTables.forEach(n),this.sources=[...e]}async getSelectedFeatures(e,t={},n="layerView"){const{view:s,selections:o}=this;if(!s&&n==="layerView")return E.getLogger(this).warn("Cannot query layer views without a view."),[];const a=(e!=null&&e.length?o.filter(l=>e.includes(l.layer)):o).map(async l=>{const{layer:c,selection:u}=l;if(!u.length)return;const d=ut(c)?c.parent:c;if(d!=null){if(s&&n==="layerView"&&!Rs(d)&&Vs(d)){const m=await s.whenLayerView(d).catch(()=>null);if(m)return Ds(m,u,t)}return Ds(d,u,t)}}).filter(At);return(await Promise.all(a)).filter(At)}updateSelection(e){const t=new Map;for(const[o,a]of this._selectionMap)t.set(o,[...a.selection]);let n=!1;const s=e.current.concat(e.added);for(const o of s){const a=o.sourceLayer,l=o.getObjectId();if(this.sources.includes(a)&&(Re(a)||ut(a))&&l!==null){const c=Ao(t,a,()=>[]);c.includes(l)||(c.push(l),n=!0)}}for(const o of e.removed){const a=o.sourceLayer,l=o.getObjectId();if(this.sources.includes(a)&&(Re(a)||ut(a))&&l!==null){const c=t.get(a),u=c==null?void 0:c.indexOf(l);u!==void 0&&u>=0&&(c==null||c.splice(u,1),n=!0)}}if(n){const{_selectionMap:o,_trashCan:a}=this,l=[];for(const[c,u]of t){const d=o.get(c);d!==void 0&&a.push(d),o.set(c,{selection:u}),l.push({layer:c,selection:u,...ls(d!==void 0?d.selection:[],u)})}this._onSelectionChange(l)}}setSelection(e,t){this._setSelection(e,t)}getSelection(e){const t=this._selectionMap.get(e);return t==null?void 0:t.selection}appendToSelection(e,t){const n=this._selectionMap.get(e),s=n!==void 0?[...n.selection]:[];for(const o of t)s.includes(o)||s.push(o);this._setSelection(e,s)}removeFromSelection(e,t){const n=this._selectionMap.get(e);if(!n)return;const s=[];for(const o of n.selection)t.includes(o)||s.push(o);this._setSelection(e,s)}toggleInSelection(e,t){const n=this._selectionMap.get(e);if(!n||n.selection.length===0)return void this._setSelection(e,t);const s=new Set(n.selection),o=new Set(t),a=Tr(s,o);this._setSelection(e,Array.from(a))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const t=[];for(const[n,s]of this._selectionMap.entries())t.push({layer:n,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(t)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var a;for(this._vizTaskId++;this._trashCan.length>0;){const l=this._trashCan.pop();(a=l==null?void 0:l.highlightHandle)==null||a.remove()}if(this.view==null)return;const{sources:e,view:t,_selectionMap:n,showHighlight:s}=this,o=this._vizTaskId;for(const l of e){const c=n.get(l),u=ut(l)?l.parent:l;if(u!=null&&Vs(u)){if(Rs(u))continue;t.whenLayerView(u).then(d=>{var m;(m=c==null?void 0:c.highlightHandle)==null||m.remove(),c!=null&&s&&o===this._vizTaskId&&"highlight"in d&&typeof d.highlight=="function"&&c.selection.length>0&&(c.highlightHandle=d.highlight(c.selection,this.highlightName))}).catch(()=>{var d;(d=c==null?void 0:c.highlightHandle)==null||d.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(ue);const e=new Set(this.sources.map(t=>ut(t)?t.parent:t));for(const t of e)Re(t)&&"on"in t&&t.on&&this._layerEditHandles.push(t.on("edits",n=>this._onLayerEdit(n,t)))}_onLayerEdit(e,t){if(_s(t))this._onParentLayerEdit(e,t);else if(e.deletedFeatures.length&&this._selectionMap.has(t)){const n=[];e.deletedFeatures.forEach(({error:s,objectId:o})=>{o!=null&&s==null&&n.push(o)}),this.removeFromSelection(t,n)}}_onParentLayerEdit(e,t){var a;const{deletedFeatures:n,edits:s,updatedFeatures:o}=e;if((a=s==null?void 0:s.updateFeatures)==null||a.forEach(l=>{var m;const c=l.getObjectId()??l.attributes[t.objectIdField];if(c==null||(m=o.find(p=>p.objectId===c))!=null&&m.error)return;const u=t.findSublayerForFeature(l);if(!Re(u))return;const d=t.sublayers.find(p=>{var g;return!(!Re(p)||!((g=this.getSelection(p))!=null&&g.includes(c)))});Re(d)&&d!==u&&(this.removeFromSelection(d,[c]),this.appendToSelection(u,[c]))}),n.length){const l=[];n.forEach(({error:c,objectId:u})=>{u!=null&&c==null&&l.push(u)}),t.sublayers.forEach(c=>{Re(c)&&this._selectionMap.has(c)&&this.removeFromSelection(c,l)})}}_setSelection(e,t){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const n=this._selectionMap.get(e);if(n===void 0||!xh(n,{selection:t})){n!==void 0&&this._trashCan.push(n),this._selectionMap.set(e,{selection:[...t]});const s={layer:e,selection:[...t],...ls(n!==void 0?n.selection:[],t)};this._onSelectionChange([s])}}};r([h()],ie.prototype,"_selectionMap",void 0),r([h()],ie.prototype,"_sources",void 0),r([h({readOnly:!0,nonNullable:!0})],ie.prototype,"selections",null),r([h({readOnly:!0,nonNullable:!0})],ie.prototype,"count",null),r([h()],ie.prototype,"view",void 0),r([h({readOnly:!0,nonNullable:!0})],ie.prototype,"hasSelection",null),r([h()],ie.prototype,"showHighlight",void 0),r([h()],ie.prototype,"sources",null),r([h()],ie.prototype,"highlightName",void 0),ie=r([v("esri.views.SelectionManager")],ie);const Rs=i=>{var e;return ut(i)?((e=i.parent)==null?void 0:e.isTable)===!0:i.isTable},Mh=i=>i.layer!==void 0,Vs=i=>(i==null?void 0:i.when)!==void 0,xh=(i,e)=>{if(i==null&&e==null)return!0;if(i!=null&&e==null||i==null&&e!=null)return!1;if(i!=null&&e!=null&&i.selection!=null&&e.selection!=null){const t=[...i.selection],n=[...e.selection];if(t.length!==n.length)return!1;t.sort(),n.sort();for(let s=0;s<t.length;s++)if(t[s]!==n[s])return!1}return!0},Ds=async(i,e,t={})=>{let n;if(Mh(i)){const s=i;n=s===void 0?null:await s.queryFeatures(new ws({...t,objectIds:e})).then(o=>({data:o,layer:i.layer}))}else{const s=i;n=s===void 0?null:await s.queryFeatures(new ws({...t,objectIds:e})).then(o=>({data:o,layer:s}))}return n},Th=ie;let Ct=class extends Nn.ClonableMixin(x){constructor(e){super(e),this.accentColor=new se([255,127,0]),this.textColor=new se([255,255,255])}};r([h({type:se,nonNullable:!0})],Ct.prototype,"accentColor",void 0),r([h({type:se,nonNullable:!0})],Ct.prototype,"textColor",void 0),Ct=r([v("esri.views.Theme")],Ct);const _n=Ct;var Os;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(Os||(Os={}));const sa=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],oa={};function aa(i){return!!oa[i]}function Ph(i){for(const e of i)if(!aa(e))return!1;return!0}sa.forEach(i=>{oa[i]=!0});let ra=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:n},s)=>{var o;return(o=this.inputManager)==null?void 0:o.installHandlers(s,[t],n)})}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>{var n;return(n=this.inputManager)==null?void 0:n.uninstallHandlers(t)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,n,s){const o=Array.isArray(e)?e:e.split(",");if(!Ph(o))return o.some(aa)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let a,l;Array.isArray(t)?l=t:(a=t,l=[]),typeof n=="function"?a=n:s=n,s=s??Ce.DEFAULT;const c=this._createUniqueGroupName(),u=new $h(this.view,o,l,a);this._handlers.set(c,{handler:u,priority:s});for(const d of o){const m=this._handlerCounts.get(d)||0;this._handlerCounts.set(d,m+1)}return this.inputManager&&this.inputManager.installHandlers(c,[u],s),Zt(()=>this._removeHandler(c,o))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of t){const s=this._handlerCounts.get(n);s===void 0||(s===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},$h=class extends z{constructor(e,t,n,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",n,a=>s(Ch(e,a)));break;case"double-click":this.registerIncoming("double-click",n,a=>s(Eh(e,a)));break;case"immediate-click":this.registerIncoming("immediate-click",n,a=>s(Ih(e,a)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,a=>s(Rh(e,a)));break;case"hold":this.registerIncoming("hold",n,a=>s(Vh(e,a)));break;case"drag":this.registerIncoming("drag",n,a=>{const l=this._wrapDrag(a);l&&s(l)});break;case"key-down":this.registerIncoming("key-down",n,a=>s(Dh(a)));break;case"key-up":this.registerIncoming("key-up",n,a=>s(Oh(a)));break;case"pointer-down":this.registerIncoming("pointer-down",n,a=>s(Pt(a,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,a=>s(Pt(a,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,a=>s(Pt(a,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,a=>s(Lh(a)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,a=>s(Ah(a)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,a=>s(Pt(a,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,a=>s(Pt(a,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,a=>{s(zh(a))});break;case"focus":this.registerIncoming("focus",n,a=>{s(Sh(a))});break;case"blur":this.registerIncoming("blur",n,a=>{s(kh(a))})}}_wrapDrag(e){const t=e.data,{x:n,y:s}=t.center,{action:o,pointerType:a,button:l}=t;if(o==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const c=t.pointer.native,u=t.buttons,{cancelable:d,timestamp:m}=e,p={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:n,y:s,origin:p,pointerType:a,button:l,buttons:u,radius:t.radius,angle:Pr(t.angle),native:c,timestamp:m,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:g=>e.defer(g),preventDefault:()=>e.preventDefault()}}};function Sh(i){return{type:"focus",timestamp:i.timestamp,native:i.data.native,cancelable:i.cancelable,stopPropagation:()=>i.stopPropagation(),defer:e=>i.defer(e),preventDefault:()=>i.preventDefault()}}function kh(i){return{type:"blur",timestamp:i.timestamp,native:i.data.native,cancelable:i.cancelable,stopPropagation:()=>i.stopPropagation(),defer:e=>i.defer(e),preventDefault:()=>i.preventDefault()}}function Ch(i,e){const{pointerType:t,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,{cancelable:u,timestamp:d}=e;return{type:"click",pointerType:t,button:n,buttons:s,x:o,y:a,native:l,timestamp:d,screenPoint:H(o,a),mapPoint:jt(i,o,a),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Eh(i,e){const{pointerType:t,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,{cancelable:u,timestamp:d}=e;return{type:"double-click",pointerType:t,button:n,buttons:s,x:o,y:a,native:l,timestamp:d,mapPoint:jt(i,o,a),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Ih(i,e){const{pointerType:t,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,u=l.pointerId,{cancelable:d,timestamp:m}=e;return{type:"immediate-click",pointerId:u,pointerType:t,button:n,buttons:s,x:o,y:a,native:l,timestamp:m,mapPoint:jt(i,o,a),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function Rh(i,e){const{pointerType:t,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,u=l.pointerId,{cancelable:d,timestamp:m}=e;return{type:"immediate-double-click",pointerId:u,pointerType:t,button:n,buttons:s,x:o,y:a,native:l,timestamp:m,mapPoint:jt(i,o,a),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function Vh(i,e){const{pointerType:t,button:n,buttons:s,x:o,y:a,native:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"hold",pointerType:t,button:n,buttons:s,x:o,y:a,native:l,timestamp:u,mapPoint:jt(i,o,a),cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:d=>e.defer(d),preventDefault:()=>e.preventDefault()}}function jt(i,e,t){return i.toMap(H(e,t),{exclude:[]})}function Dh(i){const{key:e,repeat:t,native:n}=i.data,{cancelable:s,timestamp:o}=i;return{type:"key-down",key:e,repeat:t,native:n,timestamp:o,cancelable:s,stopPropagation:()=>i.stopPropagation(),defer:a=>i.defer(a),preventDefault:()=>i.preventDefault()}}function Oh(i){const{key:e,native:t}=i.data,{cancelable:n,timestamp:s}=i;return{type:"key-up",key:e,native:t,timestamp:s,cancelable:n,stopPropagation:()=>i.stopPropagation(),defer:o=>i.defer(o),preventDefault:()=>i.preventDefault()}}function Pt(i,e){const{x:t,y:n,button:s,buttons:o,native:a,eventId:l}=i.data,c=a.pointerId,u=a.pointerType,{cancelable:d,timestamp:m}=i;return{type:e,x:t,y:n,pointerId:c,pointerType:u,button:s,buttons:o,native:a,timestamp:m,eventId:l,cancelable:d,stopPropagation:()=>i.stopPropagation(),defer:p=>i.defer(p),preventDefault:()=>i.preventDefault()}}function Lh(i){const{x:e,y:t,buttons:n,native:s,eventId:o}=i.data.currentEvent,{button:a}=i.data.startEvent,l=i.data.startEvent.native.pointerId,c=i.data.startEvent.native.pointerType,u=i.data.action,d={x:i.data.startEvent.x,y:i.data.startEvent.y},{cancelable:m,timestamp:p}=i;return{type:"pointer-drag",x:e,y:t,pointerId:l,pointerType:c,button:a,buttons:n,action:u,origin:d,native:s,timestamp:p,eventId:o,cancelable:m,stopPropagation:()=>i.stopPropagation(),defer:g=>i.defer(g),preventDefault:()=>i.preventDefault()}}function Ah(i){const{cancelable:e,data:t,timestamp:n}=i,{x:s,y:o,deltaY:a,native:l}=t;return{type:"mouse-wheel",x:s,y:o,deltaY:a,native:l,timestamp:n,cancelable:e,stopPropagation:()=>i.stopPropagation(),defer:c=>i.defer(c),preventDefault:()=>i.preventDefault()}}function zh(i){const{action:e,state:t,device:n}=i.data,{cancelable:s,timestamp:o}=i,{buttons:a,axes:l}=t;return{type:"gamepad",device:n,timestamp:o,action:e,buttons:a,axes:l,cancelable:s,stopPropagation:()=>i.stopPropagation(),defer:c=>i.defer(c),preventDefault:()=>i.preventDefault()}}var Ft,Ls,As;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(Ft||(Ft={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(Ls||(Ls={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(As||(As={}));const Nh="z",Fh="r",la={cancel:"Escape",complete:"Enter"},Lm={...la,redo:Fh,undo:Nh,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},Am={toggle:"Control"},zm={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Nm={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:ia,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let Fm=class{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,n=>{n.type==="key-down"&&t(n)})}addToggle(e,t){const n=Hh.fromDefinition(e,t),s=Ao(this._bindings,n.key,()=>[]);return s.push(n),Zt(()=>$r(s,n))}register(e,t=Ce.WIDGET){return zo([e.on("key-down",n=>this.dispatch(e.inputManager,n),t),e.on("key-up",n=>this.dispatch(e.inputManager,n),t)])}dispatch(e,t){const n=t.key,s=this._bindings.get(n);if(s)for(const o of s)o.process(e,t)}},Hh=class wn{constructor(e,t,n,s,o){this.key=e,this.modifiers=t,this.repeats=n,this.continuePropagation=s,this.callback=o}process(e,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){for(const n of this.modifiers)if(!e.isModifierKeyDown(n))return;this.continuePropagation||t.stopPropagation(),this.callback(t)}}static fromDefinition(e,t){if(typeof e=="string")return new wn(e,[],!1,!1,t);const{key:n,modifier:s,repeats:o,continuePropagation:a}=e;return new wn(n,s?Array.isArray(s)?s:[s]:[],!!o,!!a,t)}};function Zh(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return E.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function bn(i){return i.visible&&i.getEditableFlag!=null&&i.getEditableFlag(Ft.USER)&&i.getEditableFlag(Ft.MANAGER)}function qh(i){return i.type==="key-down"&&i.key===la.cancel}function me(i){return H(i.x,i.y)}function ha(i,e){var n;const t=(n=i instanceof HTMLElement?i:i.surface)==null?void 0:n.getBoundingClientRect();return t?H(e.clientX-t.left,e.clientY-t.top):H(0,0)}function ca(i,e){return e instanceof Event?ha(i,e):me(e)}function ua(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let Gh=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,t){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":Ns(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!Fs(e))break;const s=me(e),o=rt(s,e.pointerType,t.forEachTool);if(o==null)break;const a=o.manipulator,l=o.tool;a==null||l==null||!a.interactive||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._releaseManipulatorBeforeDragging(a,e,t),a!=null&&l!=null&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:l,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&t.activeTool==null&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!Fs(e))break;const s=this._grabbedManipulators.get(e.pointerId),o=s==null?void 0:s.manipulator,a=s==null?void 0:s.tool;if(o==null||a==null)break;const l=me(e);l.x=Lt(l.x,0,t.view.width),l.y=Lt(l.y,0,t.view.height);const c=s.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,u?o.events.emit("drag",{action:"update",start:c,screenPoint:l}):o.events.emit("drag",{action:"start",start:c,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:o,start:c}));break;case"end":o.dragging=!1,u&&o.events.emit("drag",{action:"end",start:c,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}n();break}case"immediate-click":{const s=me(e),o=rt(s,e.pointerType,t.forEachTool);if(Wh(e)||t.forEachTool(u=>{if((o==null||o.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let d=!1;u.manipulators.forEach(({manipulator:m})=>{m.selected&&(m.selected=!1,d=!0)}),d&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),o==null)break;const{manipulator:a,tool:l}=o;if(!a.interactive)break;a.selectable&&l.automaticManipulatorSelection&&(a.selected=!a.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const c=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n}),Qi(a,n);break}case"click":{const s=me(e),o=rt(s,e.pointerType,t.forEachTool),a=o==null?void 0:o.manipulator;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l}),n();break}case"double-click":{const s=me(e),o=rt(s,e.pointerType,t.forEachTool),a=o!=null?o.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),Qi(a,n);break}case"immediate-double-click":{const s=me(e),o=rt(s,e.pointerType,t.forEachTool),a=o!=null?o.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),e.pointerType==="mouse"&&Qi(a,n);break}}this._onFocusChange(t.forEachTool)}_releaseManipulatorBeforeDragging(e,t,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:me(t)}),this._grabbedManipulators.forEach(({manipulator:s},o)=>{s===e&&this._grabbedManipulators.delete(o)}),this._afterManipulatorRelease(n.setActiveTool)}_handlePointerEnd(e,t){var s;const n=(s=this._grabbedManipulators.get(e.pointerId))==null?void 0:s.manipulator;n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:me(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(t.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=zs(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=zs(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:s})=>{t.add(s)}),this._hoveredManipulators.forEach(({tool:s})=>{n.add(s)}),e(s=>{s.hasGrabbedManipulators=t.has(s),s.hasHoveredManipulators=n.has(s);const o=this._grabbedManipulators.values(),a=Sr(o,({tool:l})=>l===s);s.firstGrabbedManipulator=a!=null?a.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:n},s=!0,o){const a=(l,c)=>l===e&&(o==null||o===c);this._grabbedManipulators.forEach(({tool:l,manipulator:c,pointerType:u},d)=>{a(l,c)&&(this._grabbedManipulators.delete(d),c.grabbing=!1,c.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:l,manipulator:c},u)=>{a(l,c)&&(this._draggedManipulators.delete(u),c.dragging=!1,c.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:l,manipulator:c},u)=>{a(l,c)&&(this._hoveredManipulators.delete(u),c.hovering=!1)}),this._afterManipulatorRelease(n),this._onFocusChange(t)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,n)=>{this._updateHoveredStateForPointerAtScreenPosition(H(t.x,t.y),n,t.pointerType,e)})}handleHoverEvent(e,t){const n=e.type;n!=="pointer-up"&&n!=="immediate-click"&&n!=="pointer-move"||!Ns(e.pointerType)||(n!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(me(e),e.pointerId,e.pointerType,t))}_updateHoveredStateForPointerAtScreenPosition(e,t,n,s){var l;let o=rt(e,n,s);const a=(l=this._hoveredManipulators.get(t))==null?void 0:l.manipulator;o==null||o.manipulator.interactive||(o=null),o!=null&&a===o.manipulator||(a!=null&&(a.hovering=!1),o!=null?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:t},n)=>{e===n&&(this._hoveredManipulators.delete(e),t.hovering=!1)})}};function zs(i){for(const{manipulator:e}of i.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function rt(i,e,t){let n=null;return t(s=>{if(s.manipulators==null||!bn(s))return!1;const o=s.manipulators.intersect(i,e);return o!=null&&(n={tool:s,manipulator:o},!0)}),n}function Ns(i){return i==="mouse"}function Fs(i){return i.pointerType!=="mouse"||i.button===0}function Wh(i){return!!i.native.shiftKey}function Qi(i,e){i!=null&&i.consumesClicks&&e()}const Hs="attached",Xi="tools",jh=1e3;let ge=class extends x{constructor(e){super(e),this._updatingHandles=new Ai,this._clock=Gt,this._manipulatorState=new Gh,this.tools=new R,this.cursor=null,this._interacting=!1,this._interactingTimeout=jh,this._interactingTimeoutHandle=null,this._forEachTool=t=>{for(const n of this.tools.items)if(t(n))return}}initialize(){this.addHandles([this.view.on(sa,e=>{this._handleInputEvent(e)},Ce.TOOL),...Zh(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void E.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),t!=null&&t.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const s=bn(n);this.activeTool!=null&&s||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=ue(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([w(()=>{const{state:t}=this.view;return"camera"in t&&t.camera},()=>this._forEachManipulator(t=>t.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",t=>this._forEachManipulator(n=>n.onElevationChange(t)))],Hs):this.addHandles(w(()=>this.view.extent,()=>this._forEachManipulator(t=>t.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Hs),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:n})=>e(n,t))})}_handleInputEvent(e){let t=!1;const n={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(s=>{!t&&s.visible&&s.handleInputEvent(n)}),!t&&qh(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),t||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(Xi),this._forEachTool(e=>{if(e instanceof x){const t=w(()=>[e.cursor,e.visible,e.editable],()=>{bn(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(t,Xi)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Xi)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var t;(t=e.setEditableFlag)==null||t.call(e,Ft.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(t=>!(t.cursor==null||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(e==null||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}get test(){}};r([h({constructOnly:!0,nonNullable:!0})],ge.prototype,"view",void 0),r([h({value:null})],ge.prototype,"activeTool",null),r([h({readOnly:!0,type:R})],ge.prototype,"tools",void 0),r([h({readOnly:!0})],ge.prototype,"cursor",void 0),r([h({readOnly:!0})],ge.prototype,"updating",null),r([h()],ge.prototype,"_interacting",void 0),r([h({readOnly:!0})],ge.prototype,"interacting",null),ge=r([v("esri.views.ToolViewManager")],ge);const Uh=new se("cyan"),Bh=1,Kh=.25,Yh=new se("black"),Jh=.4,Qh=.2,Gm=.25,da="default",Xh="temporary",ec=new se("yellow");var Mn;let Q=Mn=class extends x{constructor(i){super(i),this.name=da,this.color=Uh.clone(),this.haloColor=null,this.haloOpacity=Bh,this.fillOpacity=Kh,this.shadowColor=Yh.clone(),this.shadowOpacity=Jh,this.shadowDifference=Qh,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(i){return this.color.equals(i.color)&&(this.haloColor||this.color).equals(i.haloColor||i.color)&&this.haloOpacity===i.haloOpacity&&this.fillOpacity===i.fillOpacity&&this.haloWidth===i.haloWidth&&this.haloBlur===i.haloBlur&&this.shadowColor.equals(i.shadowColor)&&this.shadowOpacity===i.shadowOpacity&&this.shadowDifference===i.shadowDifference}clone(){var i,e;return new Mn({...this,color:this.color.clone(),haloColor:(i=this.haloColor)==null?void 0:i.clone(),shadowColor:(e=this.shadowColor)==null?void 0:e.clone()})}assignFrom(i){var e;this.color=i.color.clone(),this.haloColor=(e=i.haloColor)==null?void 0:e.clone(),this.haloOpacity=i.haloOpacity,this.fillOpacity=i.fillOpacity,this.shadowColor=i.shadowColor.clone(),this.shadowDifference=i.shadowDifference,this.shadowOpacity=i.shadowOpacity,this.haloBlur=i.haloBlur,this.haloWidth=i.haloWidth}};r([h({type:String,constructOnly:!0,nonNullable:!0})],Q.prototype,"name",void 0),r([h({type:se,nonNullable:!0})],Q.prototype,"color",void 0),r([h({type:se})],Q.prototype,"haloColor",void 0),r([h({nonNullable:!0})],Q.prototype,"haloOpacity",void 0),r([h({nonNullable:!0})],Q.prototype,"fillOpacity",void 0),r([h({type:se,nonNullable:!0})],Q.prototype,"shadowColor",void 0),r([h({nonNullable:!0})],Q.prototype,"shadowOpacity",void 0),r([h({nonNullable:!0})],Q.prototype,"shadowDifference",void 0),r([h({nonNullable:!0})],Q.prototype,"haloWidth",void 0),r([h({nonNullable:!0})],Q.prototype,"haloBlur",void 0),Q=Mn=r([v("esri.views.support.HighlightOptions")],Q);const Ze=Q;function tc(){return new(R.ofType(Ze))([new Ze({name:da}),new Ze({name:Xh,color:ec})])}let dt=class extends x{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":ic.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return nc[this.deviceType]}};r([h({nonNullable:!0,readOnly:!0})],dt.prototype,"nativeIndex",void 0),r([h({type:String,readOnly:!0})],dt.prototype,"deviceType",null),r([h({type:Number,readOnly:!0})],dt.prototype,"axisThreshold",null),dt=r([v("esri.views.input.gamepad.GamepadInputDevice")],dt);const Yn=dt,ic=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),nc={standard:.15,spacemouse:.025,unknown:0};let Et=class extends x{constructor(...e){super(...e),this.devices=new R,this.enabledFocusMode="document"}};r([h({type:R.ofType(Yn),readOnly:!0})],Et.prototype,"devices",void 0),r([h({type:["document","view","none"]})],Et.prototype,"enabledFocusMode",void 0),Et=r([v("esri.views.input.gamepad.GamepadSettings")],Et);const sc=Et;let li=class extends x{constructor(){super(...arguments),this.gamepad=new sc}};r([h({readOnly:!0})],li.prototype,"gamepad",void 0),li=r([v("esri.views.input.Input")],li);const oc=li,pa=()=>kr.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,en=()=>h({type:["pan","rotate","zoom","none"],nonNullable:!0});let je=class extends x{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};r([en()],je.prototype,"dragPrimary",void 0),r([en()],je.prototype,"dragSecondary",void 0),r([en()],je.prototype,"dragTertiary",void 0),r([h({type:["zoom","none"],nonNullable:!0})],je.prototype,"mouseWheel",void 0),je=r([v("esri.views.navigation.NavigationActionMap")],je);const Jn=je;let Le=class extends x{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};r([h({type:Boolean,nonNullable:!0})],Le.prototype,"enabled",void 0),r([h({type:Yn})],Le.prototype,"device",void 0),r([h({type:["pan","zoom"],nonNullable:!0})],Le.prototype,"mode",void 0),r([h({type:["forward-down","forward-up"],nonNullable:!0})],Le.prototype,"tiltDirection",void 0),r([h({type:Number,nonNullable:!0})],Le.prototype,"velocityFactor",void 0),Le=r([v("esri.views.navigation.gamepad.GamepadSettings")],Le);const ma=Le;let Ae=class extends x{constructor(e){super(e),this.actionMap=new Jn,this.browserTouchPanEnabled=!0,this.gamepad=new ma,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!pa()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){Cr(E.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};r([h({type:Jn,nonNullable:!0})],Ae.prototype,"actionMap",void 0),r([h({type:Boolean})],Ae.prototype,"browserTouchPanEnabled",void 0),r([h({type:ma,nonNullable:!0})],Ae.prototype,"gamepad",void 0),r([h({type:Boolean})],Ae.prototype,"momentumEnabled",void 0),r([h({type:Boolean})],Ae.prototype,"mouseWheelZoomEnabled",null),Ae=r([v("esri.views.navigation.Navigation")],Ae);const Hi=Ae;function Jm(i,e,t){const n=ga(i),s=e,o=ac(n,s,t);if(n){const a=zi.deriveUnitFromSR(n,i.spatialReference).heightUnit;if(!t&&a!==n.heightUnit){const l=new S("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${a})`,{horizontalUnit:a});return new S("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n,error:l})}}if(!rc(i)||o===B.Unsupported)return new S("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n});switch(o){case B.Units:{const a=(n==null?void 0:n.heightUnit)||"unknown",l=(s==null?void 0:s.heightUnit)||"unknown",c=new S("layerview:incompatible-height-unit",`The vertical units of the layer (${a}) must match the vertical units of the scene (${l})`,{layerUnit:a,sceneUnit:l});return new S("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}case B.HeightModel:{const a=(n==null?void 0:n.heightModel)||"unknown",l=(s==null?void 0:s.heightModel)||"unknown",c=new S("layerview:incompatible-height-model",`The height model of the layer (${a}) must match the height model of the scene (${l})`,{layerHeightModel:a,sceneHeightModel:l});return new S("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}case B.CRS:{const a=(n==null?void 0:n.vertCRS)||"unknown",l=(s==null?void 0:s.vertCRS)||"unknown",c=new S("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${a}) must match the vertical datum of the scene (${l})`,{layerDatum:a,sceneDatum:l});return new S("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}}return null}function ac(i,e,t){if(!Zs(i)||!Zs(e))return B.Unsupported;if(i==null||e==null)return B.Ok;if(!t&&i.heightUnit!==e.heightUnit)return B.Units;if(i.heightModel!==e.heightModel)return B.HeightModel;switch(i.heightModel){case"gravity-related-height":return B.Ok;case"ellipsoidal":return i.vertCRS===e.vertCRS?B.Ok:B.CRS;default:return B.Unsupported}}var B;function Zs(i){return i==null||i.heightModel!=null&&i.heightUnit!=null}function rc(i){return"heightModelInfo"in i&&i.heightModelInfo!=null||i.spatialReference!=null||!va(i)}function ga(i){var n;if(i.type==="integrated-mesh-3dtiles")return null;const e=i.url?Er(i.url):void 0;return!(((n=i.spatialReference)==null?void 0:n.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&fa(i)&&i.heightModelInfo?i.heightModelInfo:va(i)?zi.deriveUnitFromSR(hc,i.spatialReference):null}function fa(i){return"heightModelInfo"in i}function ya(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function va(i){return ya(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):_a(i)}function lc(i){return i.layers!=null||_a(i)||ya(i)||fa(i)}function _a(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(B||(B={}));const hc=new zi({heightModel:"gravity-related-height"});let xn,tn=null;async function cc(i){tn||(tn=M(()=>import("./geometryServiceUtils-CW8-tlZS.js"),__vite__mapDeps([150,1,2,151,17,76,80])).then(e=>xn=e)),await tn,He(i)}async function wa(i,e,t,n){if(!i)return null;const s=i.spatialReference;return qn()||Gn(s,e)?Wt(i,e):xn?xn.projectGeometry(i,e,t,n):(await Promise.race([cc(n),Wn(n)]),wa(i,e,t,n))}async function Qm(i,e){try{return i!=null&&i.spatialReference?await sl(i,e):null}catch{return null}}let C=class extends x{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=gn(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var n,s,o,a;const e=(n=this.map)==null?void 0:n.call(this),t=[];return this.priorityCollection!=null&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(s=e==null?void 0:e.basemap)==null?void 0:s.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(o=e==null?void 0:e.ground)==null?void 0:o.layers},{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.referenceLayers}),t}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,n=>{const s=this._getSupportedSpatialReferences(n);if(s.length>0){const o=this._narrowDownSpatialReferenceCandidates(e,s);o!=null&&(e=o)}return(e==null?void 0:e.length)===1})&&(e==null?void 0:e.length)!==1)return{updating:!0};const t=this._pickSpatialReferenceCandidate(e);return{spatialReference:(t==null?void 0:t.spatialReference)??null,viewingMode:(t==null?void 0:t.viewingMode)??null,updating:!1}}get _tileInfoTask(){var o,a;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=(o=this.map)==null?void 0:o.call(this),t=this.spatialReference;if(!t)return{updating:this._spatialReferenceTask.updating};let n;const s=this._collectLayers([{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.baseLayers},{layers:e==null?void 0:e.layers}],l=>{var c;return!(!("tileInfo"in l)||!((c=l.tileInfo)!=null&&c.spatialReference.equals(t)))&&(n=l,!0)},l=>"tileInfo"in l);return n?{tileInfo:n.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){var n;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};let e={};const t=this._collectLayers(this.mapCollections,s=>{var a,l;const o=ga(s);return!!o&&(e={heightModelInfo:o,vcsWkid:(a=s.spatialReference)==null?void 0:a.vcsWkid,latestVcsWkid:(l=s.spatialReference)==null?void 0:l.latestVcsWkid},!0)},s=>lc(s));return{...e,updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],t=this._collectLayers(this.mapCollections,n=>{const s="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:s[0],a=s.find(l=>l.spatialReference.equals(this.spatialReference))??o;if(a)return e.push({extent:a,layer:n}),!0;if(this._getSupportedSpatialReferences(n).length>0)for(const l of s)e.push({extent:l,layer:n});return!1});return{candidates:e,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),s=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=gn(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:s.clone(),task:Un(async o=>{try{const a=await wa(n.extent,s,"portalItem"in n.layer?n.layer.portalItem:void 0,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(Ir(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(e==null)return t;const n=new Array;for(const s of e)for(const o of t){if(!s.spatialReference.equals(o.spatialReference))continue;const a=dc(s.viewingMode,o.viewingMode);if(a!==!1){n.push({spatialReference:s.spatialReference,viewingMode:a});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return e==null||e.length<1?t?{spatialReference:t,viewingMode:null}:null:(t!=null&&e.length>1&&e.some(({spatialReference:n})=>n.equals(t))&&(e=e.filter(({spatialReference:n})=>n.equals(t))),e.length>1&&e.some(({viewingMode:n})=>n!==bs.Local)&&(e=e.filter(({viewingMode:n})=>n!==bs.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const n=[];for(const s of t){const o=this.getSpatialReferenceSupport(s,e);if(o!=null){const a=o.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:l,viewingMode:c}of a)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||n.push({spatialReference:l,viewingMode:c})}}return n}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:n})=>t.equals(n.spatialReference))||e[0]}_collectLayers(e,t,n=()=>!0){var o;switch(this._loadMaybe((o=this.map)==null?void 0:o.call(this))){case"loading":return!0;case"failed":return!1}const s=new uc(n,t);for(const a of e)if(this._collectCollection(a,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const n of e.layers)if(t.layerFilter(n)){switch(this._loadMaybe(n)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":if(t.updating||(t.done=t.pushLayer(n)),t.done||t.preloading===this.sourcePreloadCount)break;"layers"in n&&this._collectCollection({layers:n.layers},t)}if(t.done||t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(t=>{fn(t)}),"loading"):e.loadStatus:"loaded"}};r([h()],C.prototype,"required",void 0),r([h({constructOnly:!0})],C.prototype,"map",void 0),r([h({constructOnly:!0})],C.prototype,"getSpatialReferenceSupport",void 0),r([h()],C.prototype,"defaultSpatialReference",void 0),r([h()],C.prototype,"userSpatialReference",void 0),r([h()],C.prototype,"sourcePreloadCount",void 0),r([h()],C.prototype,"priorityCollection",void 0),r([h()],C.prototype,"requiresExtentInSpatialReference",void 0),r([h()],C.prototype,"suspended",void 0),r([h({readOnly:!0})],C.prototype,"ready",null),r([h({readOnly:!0})],C.prototype,"heightModelInfoReady",null),r([h({readOnly:!0})],C.prototype,"spatialReference",null),r([h({readOnly:!0})],C.prototype,"extent",null),r([h({readOnly:!0})],C.prototype,"heightModelInfo",null),r([h({readOnly:!0})],C.prototype,"vcsWkid",null),r([h({readOnly:!0})],C.prototype,"latestVcsWkid",null),r([h({readOnly:!0})],C.prototype,"viewingMode",null),r([h({readOnly:!0})],C.prototype,"tileInfo",null),r([h({readOnly:!0})],C.prototype,"mapCollections",null),r([h({readOnly:!0})],C.prototype,"_spatialReferenceTask",null),r([h({readOnly:!0})],C.prototype,"_tileInfoTask",null),r([h({readOnly:!0})],C.prototype,"_heightModelInfoTask",null),r([h({readOnly:!0})],C.prototype,"_extentCandidatesTask",null),r([h()],C.prototype,"_extentTask",null),r([h()],C.prototype,"_projectExtentTask",void 0),C=r([v("esri.views.support.DefaultsFromMap")],C);let uc=class{constructor(e,t){this.layerFilter=e,this.pushLayer=t,this.preloading=-1,this.updating=!1,this.done=!1}};function dc(i,e){return i!=null?e!=null?i===e&&i:i:e}function pc(i){return"tryRecycleWith"in i}let mc=class{constructor(e,t,n){this.layer=e,this.view=t,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=Ii(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,hs(this._controller.signal,()=>{var o;(o=this._recycleController)==null||o.abort();const s=new S("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)})}tryRecycle(e){var s;if(!this.done||!this.layerView||!pc(this.layerView))return null;(s=this._recycleController)==null||s.abort(),this._recycleController=new AbortController;const t=this.layer.type,n=this._recycleController.signal;for(let o=0;o<e.length;o++){const a=e[o];if(a.type!==t)continue;const l=this.layerView.tryRecycleWith(a,{signal:n});if(l){e.splice(o,1),this.layer=a;const c=this.layerView,u=c.view;return this.promise=l.then(()=>(He(n),a.emit("layerview-destroy",{view:u,layerView:c}),u.emit("layerview-destroy",{view:u,layerView:c}),a.emit("layerview-create",{view:u,layerView:c}),u.emit("layerview-create",{view:u,layerView:c}),c)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:t,view:n}=this;t.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:t,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){var s,o;const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:t},layer:n}=this;this._map=e.map;try{let a,l;if(await n.load({signal:t}),n.prefetchResources&&await n.prefetchResources({signal:t}),gc(n))a=await n.createLayerView(e,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(n))throw new S("layer:view-not-supported","No layerview implementation was found");const d=await this.layerViewImporter.importLayerView(n);He(t),a="default"in d?new d.default({layer:n,view:e}):new d({layer:n,view:e})}const c=()=>{l=ue(l),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};l=hs(t,c),He(t);try{await a.when()}catch(d){throw c(),d}if(!((o=(s=this._map)==null?void 0:s.allLayers)==null?void 0:o.includes(n)))return c(),void this._deferred.reject(new S("view:no-layerview-for-layer","The layer has been removed from the map",{layer:n}));this.layerView=a,n.emit("layerview-create",{view:e,layerView:a}),e.emit("layerview-create",{layer:n,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){n.emit("layerview-create-error",{view:e,error:a}),e.emit("layerview-create-error",{layer:n,error:a}),this.done=!0,this._deferred.reject(new S("layerview:create-error","layerview creation failed",{layer:n,error:a}))}}};function gc(i){return i.createLayerView!==fl.prototype.createLayerView}function fc(i){return i!=null&&typeof i=="object"&&"layerViews"in i}let X=class extends x{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Ai,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n,s;const t=(n=this.view.map)==null?void 0:n.allLayers;if(t)for(const o of t)((s=this.layerViewFilter)==null?void 0:s.call(this,o))!==!1&&this.layerViewImporter.hasLayerViewModule(o)&&this.layerViewImporter.importLayerView(o)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=Ii(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Rr(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var d,m,p;const t=this.view.map;if(this.destroyed||!t)return void this.clear();if(this._map!==t&&(this.clear(),this._map=t),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,s=[],o=this.view.ready,a=g=>{var _;if(g!=null){for(const f of g)if(f){if(((_=this.layerViewFilter)==null?void 0:_.call(this,f))===!1)continue;n.add(f);const T=this._layerLayerViewInfoMap.get(f);T&&o?T.start():T||this._recyclingInfoMap.has(f)||s.push(f),"layers"in f&&f.layers&&a(f.layers)}}};for(const g of this._rootCollectionNames)a(Yt(this,g));const l=new Array,c=g=>{const _=g.tryRecycle(s);_?(this._recyclingInfoMap.set(g.layer,g),this.notifyChange("updating"),_.then(()=>{this._recyclingInfoMap.delete(g.layer),this._layerLayerViewInfoMap.set(g.layer,g),this._reschedule(),this.notifyChange("updating")}).catch(f=>{fn(f)||(this._recyclingInfoMap.delete(g.layer),g.destroy(),this._reschedule(),this.notifyChange("updating"))})):l.push(g)};for(const g of this._layerLayerViewInfoMap.values())n.has(g.layer)||(this._layerLayerViewInfoMap.delete(g.layer),c(g));for(const g of this._recyclingInfoMap.values())n.has(g.layer)||(this._recyclingInfoMap.delete(g.layer),c(g));for(const g of s)this._createLayerView(g);this._refreshCollections(),l.forEach(g=>g.destroy());const u=[(d=t==null?void 0:t.ground)==null?void 0:d.layers,(m=t==null?void 0:t.basemap)==null?void 0:m.baseLayers,(p=t==null?void 0:t.basemap)==null?void 0:p.referenceLayers,t==null?void 0:t.layers].filter(g=>!!g);n.forEach(g=>"layers"in g&&u.push(g.layers)),this.addHandles(u.map(g=>this._watchUpdatingTracking.addOnCollectionChange(()=>g,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([Ri(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),w(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),ne)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),Wi(this._recyclingInfoMap),Wi(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Vr()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||Dr(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),Wi(this._layerLayerViewInfoMap))}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new S("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,t){var o;this.commitProperty("updatingRemaining");const n=this._layerLayerViewInfoMap.get(e);if(!(n!=null&&n.done))return!0;const s=n.layerView;return!(!s||!t||s.parent===t)||!!(n.done&&s&&"layers"in e&&((o=e.layers)!=null&&o.length))&&e.layers.some(a=>this.isCreatingLayerViewsForLayer(a,s))}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(Yt(this,e),Yt(this,t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){var e;for(const t of this._layersToLayerViews.values())(e=Yt(this,t))==null||e.removeAll()}_populateLayerViewsOwners(e,t,n){if(!e||!t)return void(t==null?void 0:t.removeAll());let s=0;for(const o of e){const a=this._layerLayerViewInfoMap.get(o);if(!(a!=null&&a.layerView))continue;const l=a.layerView;l.layer=o,l.parent=n,t.at(s)!==l&&t.splice(s,0,l),"layers"in o&&fc(l)&&this._populateLayerViewsOwners(o.layers,l.layerViews,l),s+=1}s<t.length&&t.splice(s)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new mc(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),n=>{n&&(fn(n)||n.name==="cancelled:layerview-create")||E.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};r([h()],X.prototype,"_workPromise",void 0),r([h({readOnly:!0})],X.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],X.prototype,"_layersToLayerViews",null),r([h({readOnly:!0})],X.prototype,"_rootCollectionNames",null),r([h({constructOnly:!0})],X.prototype,"layerViewFilter",void 0),r([h()],X.prototype,"layerViewImporter",void 0),r([h()],X.prototype,"supportsGround",void 0),r([h({readOnly:!0})],X.prototype,"updating",null),r([h({readOnly:!0})],X.prototype,"updatingRemaining",null),r([h({constructOnly:!0})],X.prototype,"view",void 0),X=r([v("esri.views.support.LayerViewManager")],X);const yc=X;let pt=class extends x{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};r([h()],pt.prototype,"featureTitleFields",void 0),r([h()],pt.prototype,"utilityNetworkFields",void 0),r([h()],pt.prototype,"globalIdField",void 0),pt=r([v("esri.views.support.RequiredFieldsOptions")],pt);const vc=pt;var It,et;let y=(et=class extends qt.EventedMixin(No.EsriPromiseMixin(x)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new Fo,this.updatingHandles=new Ai,this.allLayerViews=new Bo({getCollections:()=>{var t,n,s;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,(n=this.groundView)==null?void 0:n.layerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:wc}),this.analyses=new vi,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new Yo,this.groundView=null,this.typeSpecificPreconditionsReady=!0,this.layerViews=new R,this.magnifier=new na,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new oc,this.navigation=new Hi,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new ra(this),this.persistableViewModels=new R,this.requiredFieldsOptions=new vc,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(w(()=>this.preconditionsReady,t=>{var s,o;const n=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,It.views.add(this)):(this._lockedSpatialReference=null,It.views.remove(this)),this.notifyChange("spatialReference"),!t&&n)(s=this.toolViewManager)==null||s.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(o=this.layerViewManager)==null||o.clear(),this._teardown();else if(t&&!n){try{this._startup()}catch(a){return void queueMicrotask(()=>{this.fatalError=new S("view:startup-error","View._startup failed",a)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},zt))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,Fn(()=>this.ready)))),this.basemapView=new bh({view:this}),this.layerViewManager=new yc({view:this,layerViewFilter:e=>{var t;return((t=this.layerViewFilter)==null?void 0:t.call(this,e))??!0},layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new ge({view:this}),this.selectionManager=new Th({view:this}),this.addHandles([it(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{E.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),w(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},ne),w(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},zt),w(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},ne)])}destroy(){var e,t;this.destroyed||(It.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=ce(this.graphics),this.analyses=ce(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),ce(this.analysisViewManager),this.toolViewManager=ce(this.toolViewManager),this.layerViewManager=ce(this.layerViewManager),this.selectionManager=ce(this.selectionManager),this.basemapView=ce(this.basemapView),(e=this.groundView)==null||e.destroy(),(t=this.layerViews)==null||t.forEach(n=>n.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=ce(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return E.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var e;return(e=this.toolViewManager)==null?void 0:e.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new C({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,t)=>this.getSpatialReferenceSupport(e,t),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??tc()}set highlights(e){this._set("highlights",Lo(e,this._get("highlights"),R.ofType(Ze)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var e;return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||cs.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((e=this.defaultsFromMap)!=null&&e.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e!=null&&e.destroyed&&(E.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),cs.isLoadable(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){var e,t,n,s;if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((((e=this.defaultsFromMap)==null?void 0:e.ready)??!1)&&!this.spatialReference){const o=!("loaded"in this.map)||this.map.loaded,a=this.map.ground.loaded,l=((t=this.map.basemap)==null?void 0:t.loaded)??!0;return o&&l&&a&&!((n=this.map)!=null&&n.allLayers.length)?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=Un(c=>Or(F("view-readyState-waiting-delay"),null,c)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),(s=this._readyStateWaitingTask)!=null&&s.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=gn(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){var t,n;const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&((n=(t=this.defaultsFromMap)==null?void 0:t.required)!=null&&n.heightModelInfo)){const s=e.clone();return s.vcsWkid=this.defaultsFromMap.vcsWkid,s.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,s}return e}set spatialReference(e){const t=!Vi(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Lr}set timeZone(e){this._userTimeZone=e,vl(e)||E.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){var e;return(e=this.toolViewManager)==null?void 0:e.tools}get initialExtent(){var e;return(e=this.defaultsFromMap)==null?void 0:e.extent}get cursor(){var e;return((e=this.toolViewManager)==null?void 0:e.cursor)??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new _n}whenLayerView(e){var t;return((t=this.layerViewManager)==null?void 0:t.whenLayerView(e))??Promise.reject()}getDefaultSpatialReference(){var e;return(e=this.defaultsFromMap)==null?void 0:e.spatialReference}getDefaultHeightModelInfo(){var e;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((e=this.defaultsFromMap)==null?void 0:e.heightModelInfo)??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(e){throw new S("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,t){return this.isResolved()&&!this.ready&&E.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(it(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}},It=et,et.views=new R,et);r([h()],y.prototype,"_userSpatialReference",void 0),r([h()],y.prototype,"activeTool",null),r([h({readOnly:!0})],y.prototype,"allLayerViews",void 0),r([h(vs(vi,"analyses"))],y.prototype,"analyses",void 0),r([h()],y.prototype,"animation",null),r([h()],y.prototype,"basemapView",void 0),r([h()],y.prototype,"center",null),r([h()],y.prototype,"defaultsFromMapSettings",null),r([h()],y.prototype,"defaultsFromMap",null),r([h()],y.prototype,"displayFilterEnabled",void 0),r([h({type:nt})],y.prototype,"extent",null),r([h()],y.prototype,"fatalError",void 0),r([h(vs(Yo,"graphics"))],y.prototype,"graphics",void 0),r([h()],y.prototype,"groundView",void 0),r([h({readOnly:!0,type:zi})],y.prototype,"heightModelInfo",null),r([h({type:R.ofType(Ze)})],y.prototype,"highlights",null),r([h({readOnly:!0})],y.prototype,"interacting",null),r([h({constructOnly:!0})],y.prototype,"layerViewFilter",void 0),r([h({readOnly:!0})],y.prototype,"navigating",null),r([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],y.prototype,"preconditionsReady",null),r([h({readOnly:!0})],y.prototype,"typeSpecificPreconditionsReady",void 0),r([h({type:R,readOnly:!0})],y.prototype,"layerViews",void 0),r([h()],y.prototype,"resolution",null),r([h({type:na})],y.prototype,"magnifier",void 0),r([h({value:null,type:ml})],y.prototype,"map",null),r([h()],y.prototype,"padding",void 0),r([h({readOnly:!0})],y.prototype,"ready",void 0),r([h()],y.prototype,"_readyStateWaitingTask",void 0),r([h({readOnly:!0})],y.prototype,"readyState",null),r([h({type:yi})],y.prototype,"spatialReference",null),r([h()],y.prototype,"stationary",null),r([h({readOnly:!0})],y.prototype,"supportsGround",void 0),r([h({type:yl})],y.prototype,"timeExtent",null),r([h({type:String,nonNullable:!0})],y.prototype,"timeZone",null),r([h()],y.prototype,"tools",null),r([h()],y.prototype,"toolViewManager",void 0),r([h({readOnly:!0})],y.prototype,"type",void 0),r([h({type:Number})],y.prototype,"scale",void 0),r([h({readOnly:!0})],y.prototype,"updating",void 0),r([h({readOnly:!0})],y.prototype,"initialExtentRequired",void 0),r([h({readOnly:!0})],y.prototype,"initialExtent",null),r([h()],y.prototype,"cursor",null),r([h({readOnly:!0})],y.prototype,"input",void 0),r([h({type:Hi,nonNullable:!0})],y.prototype,"navigation",void 0),r([h()],y.prototype,"layerViewManager",void 0),r([h()],y.prototype,"analysisViewManager",void 0),r([h()],y.prototype,"selectionManager",void 0),r([h()],y.prototype,"width",void 0),r([h()],y.prototype,"height",void 0),r([h({readOnly:!0})],y.prototype,"resizing",void 0),r([h({value:null,readOnly:!0})],y.prototype,"size",null),r([h({readOnly:!0})],y.prototype,"suspended",void 0),r([h({readOnly:!0})],y.prototype,"viewEvents",void 0),r([h({readOnly:!0})],y.prototype,"persistableViewModels",void 0),r([h()],y.prototype,"_isValid",void 0),r([h()],y.prototype,"_readyCycleForced",void 0),r([h()],y.prototype,"_lockedSpatialReference",void 0),r([h()],y.prototype,"_userTimeZone",void 0),r([h()],y.prototype,"_lockedTimeZone",void 0),r([h()],y.prototype,"_userTimeExtent",void 0),r([h()],y.prototype,"_lockedTimeExtent",void 0),r([h({type:_n})],y.prototype,"theme",void 0),r([h({readOnly:!0,type:_n})],y.prototype,"effectiveTheme",null),y=It=r([v("esri.views.View")],y);const nn=globalThis.$arcgis;nn&&!nn.views&&Object.defineProperty(nn,"views",{configurable:!1,enumerable:!0,writable:!1,value:y.views});const _c=y;function wc(i){return i.layerViews}function ye(){return[1,0,0,1,0,0]}function bc(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function Mc(i,e,t,n,s,o){return[i,e,t,n,s,o]}const xc=ye();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:xc,clone:bc,create:ye,fromValues:Mc},Symbol.toStringTag,{value:"Module"}));const ba=96,Ma=39.37,Tc=180/Math.PI;function xa(i){return i.wkid?i:i.spatialReference||yi.WGS84}function Qn(i,e){return e.type?N(i,e.x,e.y):Ot(i,e)}function Ta(i){return Zo(i)}function Zi(i,e,t=0){let n=i.width,s=i.height;if(t!==0){const l=Di(t),c=Math.abs(Math.cos(l)),u=Math.abs(Math.sin(l));n=i.width*c+i.height*u,s=i.width*u+i.height*c}const o=Math.max(1,e[0]),a=Math.max(1,e[1]);return Math.max(n/o,s/a)*Rc(i.spatialReference)}async function Rt(i,e,t,n){var l,c,u;let s,o;if(!i||Array.isArray(i)&&!i.length)return null;if(R.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const d=i.every(g=>"attributes"in g),m=i.some(g=>!g.geometry);let p=i;if(d&&m&&e&&e.allLayerViews){const g=new Map;for(const P of i){const O=P.layer,$=g.get(O)||[],V=P.attributes[O.objectIdField];V!=null&&$.push(V),g.set(O,$)}const _=[];g.forEach((P,O)=>{var V;const $=(V=e.allLayerViews)==null?void 0:V.find(k=>k.layer.id===O.id);if($&&"queryFeatures"in $){const k=O.createQuery();k.objectIds=P,k.returnGeometry=!0,_.push($.queryFeatures(k))}});const f=await Promise.all(_),T=[];for(const P of f)if(P&&P.features&&P.features.length)for(const O of P.features)O.geometry!=null&&T.push(O.geometry);p=T}for(const g of p)n=await Rt(g,e,t,n);return n}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")s=new L(i);else if(i instanceof qo)s=i;else if("geometry"in i){if(i.geometry)s=i.geometry;else if(i.layer){const d=i.layer,m=(l=e.allLayerViews)==null?void 0:l.find(p=>p.layer.id===d.id);if(m&&"queryFeatures"in m){const p=d.createQuery();p.objectIds=[i.attributes[d.objectIdField]],p.returnGeometry=!0;const g=await m.queryFeatures(p);s=(u=(c=g==null?void 0:g.features)==null?void 0:c[0])==null?void 0:u.geometry}}}if(s==null)return null;switch(s.type){case"point":o=new nt({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":o=Ol(s);break;default:o=s.extent}if(!o)return null;qn()||Gn(o.spatialReference,t)||await Wn();const a=Wt(o,t);if(!a)return null;if(n){const d=a.center,m=d.clone();m.x=Kn(d.x,n.center.x,t),m.x!==d.x&&a.centerAt(m),n=n.union(a)}else n=a;return n}function Pc(i){var e;if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&((e=i.layer)==null?void 0:e.minScale)!=null&&i.layer.maxScale!=null){const t=i.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(i)&&i.length&&i.every(t=>"layer"in t)){let t=0,n=0;for(const s of i){const o=s.layer;o!=null&&o.minScale&&o.maxScale&&(t=o.minScale<t?o.minScale:t,n=o.maxScale>n?o.maxScale:n)}return t&&n?{min:t,max:n}:null}}}function qs(i,e){const t=xa(i);return Vi(t,e)||t.imageCoordinateSystem||e.imageCoordinateSystem?i:Wt(i,e)}async function $c(i,e){var T;if(!i||!e)return new ae({targetGeometry:new L,scale:0,rotation:0});let t=e.spatialReference;const{constraints:n,padding:s,viewpoint:o,size:a}=e,l=[s?a[0]-s.left-s.right:a[0],s?a[1]-s.top-s.bottom:a[1]];let c=null;i instanceof ae?c=i:i.viewpoint?c=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(c=i.target);let u=null;c!=null&&c.targetGeometry?u=c.targetGeometry:i instanceof nt?u=i:i instanceof qo?u=await Rt(i,e,t):i&&(u=await Rt(i.center,e,t)||await Rt(i.target,e,t)||await Rt(i,e,t)),!u&&(o!=null&&o.targetGeometry)?u=o.targetGeometry:!u&&e.extent&&(u=e.extent),t||(t=xa(e.spatialReference||e.extent||u)),qn()||Vi(u.spatialReference,t)||Gn(u.spatialReference,t)||await Wn();const d=qs(u,t),m="center"in d?d.center:d;e.pickClosestTarget!==!1&&m.type==="point"&&((T=o.targetGeometry)==null?void 0:T.type)==="point"&&(m.x=Kn(m.x,o.targetGeometry.x,m.spatialReference));let p=0;c?p=c.rotation:i.hasOwnProperty("rotation")?p=i.rotation:o&&(p=o.rotation);let g=0;g=(c==null?void 0:c.targetGeometry)!=null&&c.targetGeometry.type==="point"?c.scale:"scale"in i&&i.scale?i.scale:"zoom"in i&&i.zoom!==-1&&n&&n.effectiveLODs?n.zoomToScale(i.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?o.scale:Zi(qs(u.extent,t),l,p);const _=Pc(i.target??i);_&&(_.min&&_.min<g?g=_.min:_.max&&_.max>g&&(g=_.max));let f=new ae({targetGeometry:m,scale:g,rotation:p});return n&&(f=n.fit(f),n.constrainByGeometry(f),n.rotationEnabled||(f.rotation=o.rotation)),f}function q(i,e){const t=i.targetGeometry,n=e.targetGeometry;return t.x=n.x,t.y=n.y,t.spatialReference=n.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function Sc(i,e,t){return t?N(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):Ni(i,e,.5)}const kc=function(){const i=A();return function(e,t,n){const s=t.targetGeometry;Qn(i,s);const o=.5*Mt(t);return e.xmin=i[0]-o*n[0],e.ymin=i[1]-o*n[1],e.xmax=i[0]+o*n[0],e.ymax=i[1]+o*n[1],e.spatialReference=s.spatialReference,e}}();function Cc(i,e,t,n,s){var o;return Tn(i,e,t.center),i.scale=Zi(t,n),(o=s==null?void 0:s.constraints)==null||o.constrain(i),i}function Ec(i,e,t,n){return ts(i,e,t,n),ea(i,i)}const Pa=function(){const i=A();return function(e,t,n){return Jo(e,Vc(e,t),Sc(i,t,n))}}(),Ic=function(){const i=ye(),e=A();return function(t,n,s,o){const a=Mt(n),l=Xn(n);return N(e,a,a),Cl(i,e),Fi(i,i,l),Nt(i,i,Pa(e,s,o)),Nt(i,i,[0,o.top-o.bottom]),N(t,i[4],i[5])}}();function Mt(i){var e;return i.scale*$a((e=i.targetGeometry)==null?void 0:e.spatialReference)}function $a(i){return Ho(i)?1/(Ta(i)*Ma*ba):1}function Xn(i){return Qo(i.rotation)||0}function Rc(i){return Ho(i)?Ta(i)*Ma*ba:1}function Vc(i,e){return Ni(i,e,.5)}const es=function(){const i=A(),e=A(),t=A();return function(n,s,o,a,l,c){return Pl(i,s),Ni(e,o,.5*c),N(t,1/a*c,-1/a*c),Xo(n,e),l&&Fi(n,n,l),Bn(n,n,t),Nt(n,n,i),n}}(),ts=function(){const i=A();return function(e,t,n,s){const o=Mt(t),a=Xn(t);return Qn(i,t.targetGeometry),es(e,i,n,o,a,s)}}(),Dc=function(){const i=A();return function(e,t,n,s){const o=Mt(t);return Qn(i,t.targetGeometry),es(e,i,n,o,0,s)}}();function Sa(i){const e=Go(i);return e?e.valid[1]-e.valid[0]:0}function Oc(i,e){return Math.round(Sa(i)/e)}const Lc=function(){const i=A(),e=A(),t=[0,0,0];return function(n,s,o){yn(i,n,s),Ms(i,i),yn(e,n,o),Ms(e,e),xl(t,i,e);let a=Math.acos(Tl(i,e)/(xs(i)*xs(e)))*Tc;return t[2]<0&&(a=-a),isNaN(a)&&(a=0),a}}(),Ac=function(){const i=A();return function(e,t,n,s){const o=e.targetGeometry;return q(e,t),Ic(i,t,n,s),o.x+=i[0],o.y+=i[1],e}}(),Tn=function(i,e,t){q(i,e);const n=i.targetGeometry;return n.x=t.x,n.y=t.y,n.spatialReference=t.spatialReference,i},zc=function(){const i=A();return function(e,t,n,s,o){o||(o="center"),Jo(i,n,s),Ni(i,i,.5);const a=i[0],l=i[1];switch(o){case"center":N(i,0,0);break;case"left":N(i,-a,0);break;case"top":N(i,0,l);break;case"right":N(i,a,0);break;case"bottom":N(i,0,-l);break;case"top-left":N(i,-a,l);break;case"bottom-left":N(i,-a,-l);break;case"top-right":N(i,a,l);break;case"bottom-right":N(i,a,-l)}return qi(e,t,i),e}}();function sg(i,e,t){return q(i,e),i.rotation+=t,i}function Nc(i,e,t){return q(i,e),i.rotation=t,i}const Fc=function(){const i=A();return function(e,t,n,s,o){return q(e,t),isNaN(n)||n===0||(Ca(i,s,t,o),e.scale=t.scale*n,Ea(i,i,e,o),qi(e,e,N(i,i[0]-s[0],s[1]-i[1]))),e}}();function Gs(i,e,t){return q(i,e),i.scale=t,i}const ka=function(){const i=A();return function(e,t,n,s,o,a){return q(e,t),isNaN(n)||n===0||(Ca(i,o,t,a),e.scale=t.scale*n,e.rotation+=s,Ea(i,i,e,a),qi(e,e,N(i,i[0]-o[0],o[1]-i[1]))),e}}(),og=function(){const i=A(),e=A();return function(t,n,s,o,a,l,c){return Pa(e,l,c),Ml(i,a,e),o?ka(t,n,s,o,i,l):Fc(t,n,s,i,l)}}(),Ca=function(){const i=ye();return function(e,t,n,s){return Se(e,t,Ec(i,n,s,1))}}(),Ea=function(){const i=ye();return function(e,t,n,s){return Se(e,t,ts(i,n,s,1))}}(),qi=function(){const i=A(),e=ye();return function(t,n,s){q(t,n);const o=Mt(n),a=t.targetGeometry;return kl(e,Xn(n)),Bn(e,e,Sl(o,o)),Se(i,s,e),a.x+=i[0],a.y+=i[1],t}}();function hi(){const i=new Float32Array(9);return i[0]=1,i[4]=1,i[8]=1,i}function Hc(i){const e=new Float32Array(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}function Zc(i,e,t,n,s,o,a,l,c){const u=new Float32Array(9);return u[0]=i,u[1]=e,u[2]=t,u[3]=n,u[4]=s,u[5]=o,u[6]=a,u[7]=l,u[8]=c,u}Object.freeze(Object.defineProperty({__proto__:null,clone:Hc,create:hi,fromValues:Zc},Symbol.toStringTag,{value:"Module"}));function qc(i){return i instanceof Float32Array&&i.length>=2}function Gc(i){return Array.isArray(i)&&i.length>=2}function sn(i){return qc(i)||Gc(i)}var Pn;const _e=[0,0];let Me=Pn=class extends Ei{constructor(i){super(i),this._viewpoint2D={center:A(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new nt,this.id=0,this.inverseTransform=ye(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=ye(),this.transformNoRotation=ye(),this.displayMat3=hi(),this.displayViewMat3=hi(),this.viewMat3=hi(),this.viewMat2d=El(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}get visibleArea(){const[i,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],i,e),this.toMap([0,0],i,0)]}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=q(t,i.viewpoint),this._set("size",Ot(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Pn({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return sn(e)?Se(i,e,this.inverseTransform):(_e[0]=e,_e[1]=t,Se(i,_e,this.inverseTransform))}toScreen(i,e,t){return sn(e)?Se(i,e,this.transform):(_e[0]=e,_e[1]=t,Se(i,_e,this.transform))}toScreenNoRotation(i,e,t){return sn(e)?Se(i,e,this.transformNoRotation):(_e[0]=e,_e[1]=t,Se(i,_e,this.transformNoRotation))}wrapMapCoordinate(i,e){Ot(i,e);const[t]=e,[n]=this.center,{extent:s,spatialReference:o}=this;let{xmin:a,xmax:l}=s;if(o.isWrappable){const c=Sa(o)/2;a=Math.max(a,n-c),l=Math.min(l,n+c)}return(t<a||t>l)&&(i[0]=Kn(t,n,o)),i}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return es(i,t,s,e,0,n),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,o=this._get("size"),a=new ae({targetGeometry:new L(i[0],i[1],e),scale:t,rotation:n});if(this._set("viewpoint",a),!o||!e||!t)return;this.resolution=Mt(a),this.rotation=n,this.scale=t,this.spatialReference=e,Ot(this.center,i);const l=o[0]!==0?2/o[0]:0,c=o[1]!==0?-2/o[1]:0;Ll(this.displayMat3,l,0,0,0,c,0,-1,1,1);const u=Al(this.viewMat3),d=Ss(o[0]/2,o[1]/2),m=Ss(-o[0]/2,-o[1]/2),p=Qo(n);$s(u,u,d),zl(u,u,p),$s(u,u,m),Nl(this.displayViewMat3,this.displayMat3,u);const g=Xo(this.viewMat2d,d);return Fi(g,g,p),Nt(g,g,m),kc(this.extent,a,o),ts(this.transform,a,o,s),ea(this.inverseTransform,this.transform),Dc(this.transformNoRotation,a,o,s),this.worldScreenWidth=Oc(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};r([h({readOnly:!0})],Me.prototype,"id",void 0),r([h({value:1,json:{write:!0}})],Me.prototype,"pixelRatio",null),r([h({json:{write:!0}})],Me.prototype,"size",null),r([h()],Me.prototype,"spatialReference",void 0),r([h({type:ae,json:{write:!0}})],Me.prototype,"viewpoint",null),r([h({readOnly:!0})],Me.prototype,"visibleArea",null),Me=Pn=r([v("esri.views.2d.ViewState")],Me);const Ws=Me;var $n,Sn;let ke=$n=class extends x{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new $n({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};r([h()],ke.prototype,"left",void 0),r([h()],ke.prototype,"top",void 0),r([h()],ke.prototype,"right",void 0),r([h()],ke.prototype,"bottom",void 0),ke=$n=r([v("esri.views.2d.PaddedViewState.Padding")],ke);let mt=Sn=class extends Ws{constructor(...i){super(...i),this.paddedViewState=new Ws,this._updateContent=(()=>{const e=A();return()=>{const t=this._get("size"),n=this._get("padding");if(!t||!n)return;const s=this.paddedViewState;N(e,n.left+n.right,n.top+n.bottom),yn(e,t,e),Ot(s.size,e);const o=s.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(w(()=>[this.size,this.padding],()=>this._updateContent(),zt)),this.padding=new ke,this.size=[0,0]}set padding(i){this._set("padding",i||new ke)}set viewpoint(i){if(i){this.paddedViewState.viewpoint=i;let e=i;const t=this._get("padding");t&&(e=Ac(i.clone(),i,this._get("size"),t));const{targetGeometry:n,rotation:s,scale:o}=e,{x:a,y:l,spatialReference:c}=n,u=this._viewpoint2D;u.center[0]=a,u.center[1]=l,u.rotation=s,u.scale=o,u.spatialReference=c,this._update()}}clone(){return new Sn({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};r([h()],mt.prototype,"paddedViewState",void 0),r([h({type:ke})],mt.prototype,"padding",null),r([h()],mt.prototype,"viewpoint",null),mt=Sn=r([v("esri.views.2d.PaddedViewState")],mt);const is=mt;let Wc=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=Fl(),this._schedulerHandle=it(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{var t;this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),((t=this.view.animation)==null?void 0:t.target)==null||Wo(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=t=>{var l,c,u;if(this._updateRequested=!1,(l=this.view)==null?void 0:l.destroyed)return;const{allLayerViews:n,graphicsView:s,labelManager:o,state:{id:a}}=this.view;n==null||n.forEach(this._updateLayerView,this),o!=null&&(o.lastUpdateId!==a&&(o.viewChange(),o.lastUpdateId=a),o.updateRequested&&o.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==a&&(s.viewChange(),s.lastUpdateId=a),s.updateRequested&&s.processUpdate(this._updateParameters)),(c=this.view.graphicsTileStore)==null||c.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Xt.ANIMATING:this.view.interacting?this._scheduler.state=Xt.INTERACTING:this._scheduler.state=Xt.IDLE,this._scheduler.frame(t)||this._updateRequested||this._scheduler.state!==Xt.IDLE||((u=this._frameTaskHandle)==null||u.pause())}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new is,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=w(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=bt(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var s;if(!e.attached)return void this.requestUpdate();const t=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0),n!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((s=e.layerViews)==null||s.forEach(this._updateLayerView,this))}};function jc(i,e){const{spatialReference:t}=e,n=[e.x,e.y];let s,o,a,l;const c=[0,0],u=Uc(i);for(let p=0;p<u.length;p++){const g=u[p];for(let _=0;_<g.length-1;_++){Ar(c,n,g,_);const f=$l(n,c);(s==null||f<s)&&(s=f,o=[...c],a=p,l=_)}}if(s==null||!o||a==null||l==null)throw new S("nearest-coordinate:failed","Failed to find the nearest coordinate");const[d,m]=o;return{coordinate:new L({x:d,y:m,spatialReference:t}),distance:s}}function Uc(i){switch(i.type){case"extent":return[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]];case"polygon":return i.rings;case"polyline":return i.paths}}var kn;let Je=kn=class extends Hn.NumericIdentifiableMixin(x){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Wt(this.geometry,this.spatialReference)}catch(i){return E.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(this.normalizedGeometry==null)return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?Zn(this.normalizedGeometry,t):jo(this.normalizedGeometry,t))return i;const{coordinate:n}=jc(this.normalizedGeometry,t);return n&&(i.targetGeometry=n),i}clone(){var i,e;return new kn({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};r([h({constructOnly:!0})],Je.prototype,"geometry",void 0),r([h({readOnly:!0})],Je.prototype,"normalizedGeometry",null),r([h({constructOnly:!0})],Je.prototype,"spatialReference",void 0),Je=kn=r([v("esri.views.2d.constraints.GeometryConstraint")],Je);var Cn;let Vt=Cn=class extends Hn.NumericIdentifiableMixin(x){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new Cn({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};r([h()],Vt.prototype,"enabled",void 0),r([h()],Vt.prototype,"rotationEnabled",void 0),Vt=Cn=r([v("esri.views.2d.constraints.RotationConstraint")],Vt);const Ia=Vt;var En;let U=En=class extends Hn.NumericIdentifiableMixin(x){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:n,minZoom:s,maxZoom:o}=this,a=-1,l=-1,c=!1,u=!1;if(t!==0&&n!==0&&t<n&&([t,n]=[n,t]),!(e!=null&&e.length))return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",n);e=e.map(d=>d.clone()),e.sort((d,m)=>m.scale-d.scale),e.forEach((d,m)=>d.level=m);for(const d of e)!c&&t>0&&t>=d.scale&&(a=d.level,c=!0),!u&&n>0&&n>=d.scale&&(l=i?i.level:-1,u=!0),i=d;s===-1&&(s=t===0?0:a),o===-1&&(o=n===0?e.length-1:l),s=Math.max(s,0),s=Math.min(s,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),s>o&&([s,o]=[o,s]),t=e[s].scale,n=e[o].scale,e.splice(0,s),e.splice(o-s+1),e.forEach((d,m)=>{this._lodByScale[d.scale]=d,this._scales[m]=d.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",n)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,n=this.effectiveMaxScale,s=i.targetGeometry,o=e&&e.targetGeometry,a=n!==0&&i.scale<n,l=t!==0&&i.scale>t;if(a||l){const c=l?t:n;if(e&&o){const u=(c-e.scale)/(i.scale-e.scale);s.x=o.x+(s.x-o.x)*u,s.y=o.y+(s.y-o.y)*u}i.scale=c}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.floor(i),n=Math.ceil(i);return e[t]+(i-t)*(e[n]-e[t])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,n;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(t=e[s],n=e[s+1],n===i)return s+this.effectiveMinZoom+1;if(t>i&&n<i)return s+this.effectiveMinZoom+1-(i-n)/(t-n)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new En({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};r([h({readOnly:!0})],U.prototype,"effectiveLODs",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMinZoom",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMaxZoom",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMinScale",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMaxScale",void 0),r([h()],U.prototype,"lods",void 0),r([h()],U.prototype,"minZoom",void 0),r([h()],U.prototype,"maxZoom",void 0),r([h()],U.prototype,"minScale",void 0),r([h()],U.prototype,"maxScale",void 0),r([h()],U.prototype,"snapToZoom",void 0),U=En=r([v("esri.views.2d.constraints.ZoomConstraint")],U);const Ra=U,Bc={base:null,key:"type",typeMap:{extent:nt,polygon:Uo}};let D=class extends x{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new R}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,n;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(n=this._geometry)==null?void 0:n.uid}`}get _geometry(){var t,n;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((t=this.view)==null?void 0:t.constraintsInfo.spatialReference)===e.spatialReference?e:new Je({geometry:this.geometry,spatialReference:(n=this.view)==null?void 0:n.constraintsInfo.spatialReference})}get _rotation(){return new Ia({rotationEnabled:this.rotationEnabled})}get _zoom(){var c;const e=this._get("_zoom"),t=this.lods||((c=this.view)==null?void 0:c.constraintsInfo.lods),n=this.minZoom,s=this.maxZoom,o=this.minScale,a=this.maxScale,l=this.snapToZoom;return e&&e.lods===t&&e.minZoom===n&&e.maxZoom===s&&e.minScale===o&&e.maxScale===a&&e.snapToZoom===l?e:new Ra({lods:t,minZoom:n,maxZoom:s,minScale:o,maxScale:a,snapToZoom:l})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),this.customConstraints.forEach(n=>n.constrain(e,t)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(t=>{var n;return(n=t.applyPanConstraint)==null?void 0:n.call(t,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};r([h({readOnly:!0})],D.prototype,"effectiveLODs",null),r([h({readOnly:!0})],D.prototype,"effectiveMinScale",null),r([h({readOnly:!0})],D.prototype,"effectiveMaxScale",null),r([h({readOnly:!0})],D.prototype,"effectiveMinZoom",null),r([h({readOnly:!0})],D.prototype,"effectiveMaxZoom",null),r([h({types:Bc,value:null})],D.prototype,"geometry",null),r([h({type:[al]})],D.prototype,"lods",void 0),r([h()],D.prototype,"minScale",void 0),r([h()],D.prototype,"maxScale",void 0),r([h()],D.prototype,"minZoom",void 0),r([h()],D.prototype,"maxZoom",void 0),r([h()],D.prototype,"rotationEnabled",void 0),r([h()],D.prototype,"snapToZoom",void 0),r([h({type:R})],D.prototype,"customConstraints",void 0),r([h()],D.prototype,"view",void 0),r([h({readOnly:!0})],D.prototype,"version",null),r([h({type:Je,readOnly:!0})],D.prototype,"_geometry",null),r([h({type:Ia})],D.prototype,"_rotation",null),r([h({readOnly:!0,type:Ra})],D.prototype,"_zoom",null),D=r([v("esri.views.2d.MapViewConstraints")],D);const js=D;let Z=class extends x{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([w(()=>{var t;return(t=this.constraints)==null?void 0:t.version},t=>{this.constraints&&t&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},zt)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return this.state.commitProperty("id"),new L({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let t;try{t=this._project(e,this.state.spatialReference)}catch(s){return void E.getLogger(this).error(new S("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const n=this.viewpoint;Tn(n,n,t),this.viewpoint=n}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void E.getLogger(this).error(new S("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let t;try{t=this._project(e,this.state.spatialReference)}catch(s){return void E.getLogger(this).error(new S("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const n=this.viewpoint;Cc(n,n,t,this.state.size,{constraints:this.constraints}),this.viewpoint=n}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;Nc(t,t,e),this.viewpoint=t}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const n=this._get("extent");return void(n&&(this._set("extent",void 0),this._set("center",n.center)))}const t=this.viewpoint;Gs(t,t,e),this.viewpoint=t}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var o;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let t,n;try{t=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?n=new S("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(n=new S("mapview:invalid-viewpoint","geometry not defined"))}catch(a){n=new S("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:a})}if(n)return void E.getLogger(this).error(n);this._scaleBeforeChangingSpatialReference=null;const s=new ae({targetGeometry:new L,scale:0,rotation:0});q(s,t),(o=this.constraints)==null||o.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var s,o;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const a=this._get("extent");return void(a&&(this._set("extent",void 0),this._set("center",a.center)))}const t=((s=this.constraints)==null?void 0:s.zoomToScale(e))??0;if(!t)return void this._set("zoom",-1);const n=this.viewpoint;Gs(n,n,t),this.viewpoint=n,this._set("zoom",((o=this.constraints)==null?void 0:o.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:t,constraints:n}=this,s=this._get("center"),o=this._get("extent"),a=this._get("scale"),l=this._get("rotation"),c=this._get("viewpoint"),u=this._get("zoom"),d=u!=null&&n!=null&&n.zoomToScale(u)||void 0;let m,p,g;const _=c==null?void 0:c.rotation,f=c==null?void 0:c.targetGeometry;(f==null?void 0:f.type)==="extent"?m=f:(f==null?void 0:f.type)==="point"&&(p=f,g=c==null?void 0:c.scale);const T=o??m;return{center:s??p??(T==null?void 0:T.center),rotation:l??_,scale:(a??d??g??(T&&Zi(T,[e[0]-t.left-t.right,e[1]-t.top-t.bottom])))||void 0}}startup(e,t,n,s){var a;const o=e.targetGeometry;try{this._project(e,n)}catch(l){E.getLogger(this).warn(new us("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:n,error:l})),e.targetGeometry=s||new L({x:0,y:0,spatialReference:n})}(a=this.constraints)==null||a.fit(e),this._set("state",new is({padding:this.padding,size:t,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,t],spatialReference:n,rotation:s,scale:o}=this.state.paddedViewState,a=new L({x:e,y:t,spatialReference:n});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){var c;const t=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=t.scale;else{const u=t.viewpoint.clone();u.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=u}const n=t.clone(),[s,o]=t.center;let a=null;try{a=this._project(new L({x:s,y:o,spatialReference:t.spatialReference}),e)}catch(u){zr()||E.getLogger(this).warn(new us("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:a==null?void 0:a.toJSON(),spatialReference:e,error:u}))}a||(a=new L({x:0,y:0,spatialReference:e}));const l=Tn(new ae({targetGeometry:new L,scale:0,rotation:0}),t.viewpoint,a);n.viewpoint=l;try{const d=[t.size[0]/2,t.size[1]/2],m=[d[0]+20,d[1]],p=t.toMap([0,0],m),{x:g,y:_}=this._project(new L({x:p[0],y:p[1],spatialReference:t.spatialReference}),e);p[0]=g,p[1]=_,n.toScreen(p,p);const f=Lc(d,p,m),T=Math.hypot(p[0]-d[0],p[1]-d[1])/20;!Number.isFinite(T)||Math.abs(T)>4?(l.rotation=0,l.targetGeometry=new L({x:0,y:0,spatialReference:e})):(l.scale*=T,l.scale>F("mapview-srswitch-adjust-rotation-scale-threshold")?l.rotation=0:l.rotation+=Number.isFinite(f)?f:0)}catch{}(c=this._get("constraints"))==null||c.constrain(l,void 0),this._get("state").viewpoint=l}resize(e,t){var a;if(!this.ready)return;const n=this.state;let s=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();n.size=[e,t],zc(s,s,o,this.state.paddedViewState.size,this.resizeAlign),s=((a=this.constraints)==null?void 0:a.constrain(s,void 0))??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const t=[0,0],[n,s]=this.state.toMap(t,[e.x,e.y]),o=this.state.spatialReference;return new L({x:n,y:s,spatialReference:o})}toScreen(e,t){if(!this.ready)return null;const n=this._project(e,this.state.spatialReference),s=[n.x,n.y];return(t==null?void 0:t.pickClosestTarget)===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),H(s[0],s[1])}_project(e,t){var o;const n=(e==null?void 0:e.targetGeometry)||e;if(!t)return e;if(!n)return null;if(t.imageCoordinateSystem||(o=n.spatialReference)!=null&&o.imageCoordinateSystem||Vi(t,n.spatialReference))return e;const s=Wt(n,t);if(!s)throw new S("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:n,spatialReference:t});return Kc(e)?(e.targetGeometry=s,e):s}};function Kc(i){return(i==null?void 0:i.declaredClass)==="esri.Viewpoint"}r([h({type:L})],Z.prototype,"center",null),r([h()],Z.prototype,"constraints",void 0),r([h({type:nt})],Z.prototype,"extent",null),r([h({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],Z.prototype,"padding",null),r([h()],Z.prototype,"ready",void 0),r([h()],Z.prototype,"resizeAlign",void 0),r([h({readOnly:!0})],Z.prototype,"resolution",null),r([h({type:Number})],Z.prototype,"rotation",null),r([h({type:Number})],Z.prototype,"scale",null),r([h({readOnly:!0})],Z.prototype,"state",void 0),r([h({type:ae})],Z.prototype,"viewpoint",null),r([h({readOnly:!0})],Z.prototype,"visibleArea",null),r([h()],Z.prototype,"zoom",null),Z=r([v("esri.views.2d.ViewStateManager")],Z);const Us=160;let Dt=class extends x{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=Us&&this.clear()},Us))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};r([h()],Dt.prototype,"_timer",void 0),r([h()],Dt.prototype,"stationary",null),Dt=r([v("esri.views.2d.support.StationaryManager")],Dt);const Yc=i=>{let e=class extends i{constructor(...t){super(...t),this.fullOpacity=1,this.stateManager=new Z({constraints:new js({view:this})}),this.stationaryManager=new Dt,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new Wc(this),this.viewEvents=new ra(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([w(()=>this.viewpoint,()=>this.stationaryManager.flip(),zt)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){var t;return((t=this.stateManager)==null?void 0:t.extent)??null}set extent(t){this.stateManager.extent=t}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(t){const n=this._get("animation");if(t===n)return;if(n&&n.stop(),t!==this.animationManager.animation&&this.animationManager.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t);const s=()=>{var o;this.destroyed||t===this._get("animation")&&(this._set("animation",null),(o=this.frameTask)==null||o.requestFrame())};t.when(s,s)}get constraints(){var t;return(t=this.stateManager)==null?void 0:t.constraints}set constraints(t){t.view=this;const n=this.stateManager.constraints;this.stateManager.constraints=t,n==null||n.destroy()}get padding(){var t;return(t=this.stateManager)==null?void 0:t.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(t){this.stateManager.resizeAlign=t}get rotation(){return this.stateManager.rotation??0}set rotation(t){const{rotationEnabled:n}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=t,this.constraints.rotationEnabled=n}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(t){this.stateManager.viewpoint=t,this.frameTask.requestFrame()}};return r([h({readOnly:!0})],e.prototype,"animationManager",void 0),r([h({readOnly:!0})],e.prototype,"fullOpacity",void 0),r([h()],e.prototype,"stateManager",void 0),r([h()],e.prototype,"constraintsInfo",null),r([h()],e.prototype,"extent",null),r([h({readOnly:!0})],e.prototype,"state",null),r([h({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),r([h()],e.prototype,"renderingOptions",void 0),r([h({readOnly:!0})],e.prototype,"interacting",null),r([h()],e.prototype,"stationary",null),r([h()],e.prototype,"animation",null),r([h({type:js})],e.prototype,"constraints",null),r([h()],e.prototype,"padding",null),r([h()],e.prototype,"resizeAlign",null),r([h()],e.prototype,"rotation",null),r([h({readOnly:!0})],e.prototype,"viewEvents",void 0),r([h({type:ae})],e.prototype,"viewpoint",null),e=r([v("esri.views.Viewport2DBaseMixin")],e),e};let ze=class extends No{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Ii(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new S("view:animation-stopped","ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,t){t||(t=Wo(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};r([h({readOnly:!0})],ze.prototype,"done",null),r([h({readOnly:!0,type:String})],ze.prototype,"state",void 0),r([h()],ze.prototype,"target",void 0),ze=r([v("esri.views.ViewAnimation")],ze),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(ze||(ze={}));const In=ze;let ci=class extends x{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,t){if(!e)return void E.getLogger(this).error("#goTo()","target cannot be null or undefined");const n=new In;this.view.animation=n,await Fn(()=>this.view.ready,t);const s={...t,animate:(t==null?void 0:t.animate)??!pa(),animationMode:(t==null?void 0:t.animationMode)??"auto"},{extent:o,spatialReference:a,size:l,viewpoint:c,constraints:u,padding:d,allLayerViews:m}=this.view,p=$c(e,{extent:o,spatialReference:a,size:l,viewpoint:c,constraints:u,padding:d,allLayerViews:m,pickClosestTarget:(t==null?void 0:t.pickClosestTarget)??!0});return n==null||n.update(p),this._gotoTask={},s.animate?this._gotoAnimated(p,s):this._gotoImmediate(p,s)}_gotoImmediate(e,t){const n=this._gotoTask,s=this.view.animation,o=e.then(a=>{if(He(t),n!==this._gotoTask)throw new S("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=a,s.finish()});return this._cancellableGoTo(n,s,o,t)}_gotoAnimated(e,t){const n=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const o=e.then(a=>{if(He(t),n!==this._gotoTask)throw new S("view:goto-interrupted","Goto was interrupted");return s.update(a),this.view.animationManager.animate(s,this.view.viewpoint,t),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(n,s,o,t)}_cancellableGoTo(e,t,n,s){const o=()=>e===this._gotoTask;return Nr(n,s).finally(()=>{o()&&(t.done||t.stop())})}};r([h({constructOnly:!0})],ci.prototype,"view",void 0),ci=r([v("esri.views.2d.GoToManager")],ci);function Va(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}function Da(i,e){return e.some(t=>Va(i,t))}function Bs(i,{dragPrimary:e,dragSecondary:t,dragTertiary:n}){return[{key:"primary",value:e},{key:"secondary",value:t},{key:"tertiary",value:n}].filter(s=>s.value===i).map(s=>s.key)}let Ks=class extends z{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,n=>this._handleDoubleClick(n,t))}_handleDoubleClick(e,t){Va(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Jc=class extends z{constructor(e,t,n){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",n,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:n}=t;if(n!==this.pointerType)return;e.stopPropagation();const{action:s,delta:o}=t,{view:a}=this,{mapViewNavigation:l}=a;switch(s){case"begin":{const{scale:c}=a;this._startScale=c,this._currentScale=c,this._previousDelta=o,l.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const c=1.015**o.y,u=this._startScale*c,d=u/this._currentScale;l.setViewpointImmediate(d),this._currentScale=u;break}case"end":{const{constraints:c}=a,{effectiveLODs:u,snapToZoom:d}=c;if(!d||!u)return void l.end();const m=c.snapScale(this._currentScale),p=(o.y>0?Math.max(m,c.snapToPreviousScale(this._startScale)):Math.min(m,c.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(p).then(()=>{l.end()});break}}}},Gi=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,n=t.pointers.size;switch(t.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,n;this._startEvent=e,(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Qc=class extends z{constructor(e,t,n){super(!0),this.view=e,this.pointerActions=t,this.registerIncoming("drag",n,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Gi({start:(t,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(t,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(t,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(t,n)=>t===1&&Da(n.data,this.pointerActions)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Xc=class extends z{constructor(e,t,n){super(!0),this._view=e,this.pointerActions=t;const s=this._view.mapViewNavigation;this._dragEventSeparator=new Gi({start:(o,a)=>{s.rotate.begin(this._view,a.data),a.stopPropagation()},update:(o,a)=>{s.rotate.update(this._view,a.data),a.stopPropagation()},end:(o,a)=>{s.rotate.end(),a.stopPropagation()},condition:(o,a)=>o===1&&Da(a.data,this.pointerActions)}),this.registerIncoming("drag",n,o=>this._dragEventSeparator.handle(o))}};function he(i){let e=i*i;return i<0&&(e*=-1),e}function eu(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function tu(i,e,t){const n=t,s=i.state,o=i.device,a=e.tiltDirection==="forward-down"?1:-1,l=1;return o.deviceType==="standard"?(n.translation[0]=he(s.axes[0]),n.translation[1]=he(s.axes[1]),n.translation[2]=he(s.buttons[7])-he(s.buttons[6]),n.heading=he(s.axes[2]),n.tilt=he(s.axes[3])):o.deviceType==="spacemouse"&&(n.translation[0]=1.2*he(s.axes[0]),n.translation[1]=1.2*he(s.axes[1]),n.translation[2]=2*-he(s.axes[2]),n.heading=1.2*he(s.axes[5]),n.tilt=1.2*he(s.axes[3])),n.tilt*=a,Hl(n.translation,n.translation,l),n}function iu(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let nu=class extends z{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Fo,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([w(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=bt({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},W)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){var n;const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,eu(this._transformation)):(this._currentDevice=e.data.device,tu(e.data,this._view.navigation.gamepad,this._transformation)),(n=this._frameTask)==null||n.resume())}_frameUpdate(e){var m;const t=this._transformation;if(iu(t))return void((m=this._frameTask)==null?void 0:m.pause());const n=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,o=ou*s*e;qi(n,n,[t.translation[0]*o,-t.translation[1]*o]);const a=1+t.translation[2]*au*e,l=this._view.constraints.rotationEnabled?-t.heading*su*e:0,c=this._view.size,u=[c[0]/2,c[1]];ka(n,n,a,l,u,c);const d=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=d}};const su=.06,ou=.7,au=6e-4;function Oa(i){const e=()=>i(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Zt(()=>document.removeEventListener("visibilitychange",e))}let ru=class extends z{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const o=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(o==null)return;s.stopPropagation(),s.preventDefault();const a=s.type==="key-down";if(this._pressedKeys[a?"add":"delete"](o),a){if(this._direction===o)return;this._direction=o,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const l=this._timeout===void 0,c=this._pressedKeys.size>0;l||c?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",n,this._handleKey),this.registerIncoming("key-up",n,this._handleKey),this.registerIncoming("blur",n,this._stopMovement),this._visibilityHandle=Oa(s=>s?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const t=this._currentDirection!=null;if(e!=null){if(t||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else t&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},lu=class extends z{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(t),this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",n,s=>this._handleKeyUp(s)),this.registerIncoming("blur",n,()=>this._handleStop()),this._visibilityHandle=Oa(s=>s?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,t){for(const n of e)this._keyToDirection.set(n,t)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),t)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var _t;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(_t||(_t={}));let hu=class extends z{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),t.zoomIn.forEach(s=>this._keysToZoomAction[s]=_t.IN),t.zoomOut.forEach(s=>this._keysToZoomAction[s]=_t.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const s=this._keysToZoomAction[n],{mapViewNavigation:o}=this.view;let a=null;switch(s){case _t.IN:a=o.zoomIn();break;case _t.OUT:a=o.zoomOut();break;default:return}o.begin(),a.then(()=>o.end()),e.stopPropagation()}};const cu=.6;let uu=class extends z{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:n,y:s,deltaY:o}=e.data,a=1/cu**(1/60*o),l=t.zoom(a,[n,s]);l&&(this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},du=class extends z{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new Gi({start:(n,s)=>{t.pinch.begin(this.view,s.data),s.stopPropagation()},update:(n,s)=>{t.pinch.update(this.view,s.data),s.stopPropagation()},end:(n,s)=>{t.pinch.end(this.view),s.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Ys(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value||1:0),axes:e.axes.map(t=>gu(t,i.axisThreshold))}:{buttons:[],axes:[]}}function pu(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function mu(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function gu(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let fu=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const a=o.gamepad,l=a.index,c=this._inputDevices[l];c&&(this._emitGamepadEvent(a,Ys(c),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(c),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=n&&s,this.supported&&(Js(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Yn(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=bt({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;Js(s=>{const o=this._inputDevices[s.index];if(!o)return;const a=this._latestUpdate[s.index],l=Ys(o),c=n||mu(l);a&&(a.timestamp===s.timestamp||!a.active&&c||pu(a.state,l))||this._emitGamepadEvent(s,l,!c)})}_emitGamepadEvent(e,t,n){const s=this._latestUpdate[e.index],o=s&&s.active;if(!o&&!n)return;const a=!o&&n?"start":o&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:a})}};function yu(i){if(!i||!i.connected)return!1;for(let e=0;e<i.axes.length;e++)if(isNaN(i.axes[e]))return!1;return!0}function Js(i){for(const e of navigator.getGamepads())yu(e)&&i(e)}const Qs=F("edge"),vu=F("chrome"),_u=F("ff"),wu=F("safari"),Xs="esri-view-surface",lt={touchNone:`${Xs}--touch-none`,touchPan:`${Xs}--touch-pan`};var tt;let bu=(tt=class{constructor(e,t){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new fu(e,t),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=ce(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const n=this._active[t];this._element.removeEventListener(on[t],n),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&on[t]){const n=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(on[t],n),this._active[t]=n}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1)}setPointerCapture(e,t){t?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?lt.touchNone:lt.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?lt.touchPan:lt.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(lt.touchNone),this._element.classList.remove(lt.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const n=ha(this._element,e);return tt.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,t){const{key:n}=t;n&&e==="key-up"&&this._keyDownState.delete(n);const s={native:t,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&F("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,t){let n=this._getDeltaFromTrackpadOrMouseWheel(t);switch(t.deltaMode){case 0:Qs&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Qs?n*=.7:vu||wu?n*=.6:_u&&(n*=1.375);const s=100,o=Math.abs(n);o>s&&(n=n/o*200/(1+Math.exp(-.02*(o-s))));const a=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,a)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},tt.test={disableSubpixelCoordinates:!1},tt);const on={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Mu=class extends z{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const La=()=>({maximumClickDelay:300}),xu=(i={})=>({...La(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...i}),ns=(i={})=>({...La(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...i});function _i(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function Tu(i,e){const t=e.x-i.x,n=e.y-i.y;return Math.sqrt(t*t+n*n)}function Pu(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:H()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[$,V]=i,[k,Y]=[V.x-$.x,V.y-$.y];return e.radius=Math.sqrt(k*k+Y*Y)/2,e.center.x=($.x+V.x)/2,e.center.y=($.y+V.y)/2,e}let t=0,n=0;for(let $=0;$<i.length;$++)t+=i[$].x,n+=i[$].y;t/=i.length,n/=i.length;const s=i.map($=>$.x-t),o=i.map($=>$.y-n);let a=0,l=0,c=0,u=0,d=0,m=0,p=0;for(let $=0;$<s.length;$++){const V=s[$],k=o[$],Y=V*V,de=k*k;a+=Y,l+=de,c+=V*k,u+=Y*V,d+=de*k,m+=V*de,p+=k*Y}const g=.5*(u+m),_=.5*(d+p),f=a*l-c*c,T=(g*l-_*c)/f,P=(a*_-c*g)/f,O=H(T+t,P+n);return{radius:Math.sqrt(T*T+P*P+(a+l)/i.length),center:O}}function Xe(i){const{native:e}=i,{pointerId:t,button:n,pointerType:s}=e;return s==="mouse"?`${t}:${n}`:`${s}`}let $u=class extends z{constructor(e={},t=Gt){super(!1),this._clock=t,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=H(0,0),this._pointerState=new Map,this._parameters=ns(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Gi({start:(n,s)=>this._dragStart(n,s),update:(n,s)=>this._dragUpdate(s),end:(n,s)=>this._dragEnd(s)}),this.registerIncoming("drag",n=>this._dragEventSeparator.handle(n)),this.registerIncoming("pointer-down",n=>this._handlePointerDown(n)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=ue(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=ue(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:s}=t,{center:o}=n;this._dragStartCenter=o;const a=an("begin",H(0,0),n);this._doubleTapDrag.emit(a,void 0,s),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:s}=t,o=an("update",H(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(o,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:s}=t,o=an("end",H(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(o,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,n=Xe(t),s=this._pointerState.get(n),{pointerType:o}=t.native;if(s){const a=o==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(n),_i(s.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:n}=t.native,s=Xe(t),o=n==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._clearPointerDown(s),o);this._pointerState.set(s,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}};function an(i,e,t){const{button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}=t;return{action:i,delta:e,button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}}let Su=class extends z{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,n,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:s,pointers:ku(this._activePointerMap),pointer:t,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const t=e.native.pointerId,n=ii(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,s);const o=ui(s,Aa(this._activePointerMap));s.initialAngle=o,s.lastAngle=o,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,n=this._activePointerMap.get(t);n?n.event=e:this._addPointer(e)}_removePointer(e){const t=ii(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=ii(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=ui(n,t)-e,n.lastAngle=ui(n,t)-e})}_emitEvent(e,t,n){const s=ii(this._activePointerMap);this._drag.emit(this._createPayload(e,t,s,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,n=oe(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,oe(e.timestamp))))}_handlePointerDrag(e){const t=e.data,n=t.currentEvent,s=oe(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Aa(i){const e=[];return i.forEach(t=>{e.push(H(t.event.x,t.event.y))}),Pu(e)}function ii(i){const e=Aa(i);let t=0;return i.forEach(n=>{let s=ui(n,e),o=s-n.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;s=n.lastAngle+o,n.lastAngle=s;const a=s-n.initialAngle;t+=a}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function ku(i){const e=new Map;return i.forEach((t,n)=>e.set(n,t.event)),e}function ui(i,e){const t=i.event,n=t.x-e.center.x,s=t.y-e.center.y;return Math.atan2(s,n)}var eo;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(eo||(eo={}));let Cu=class extends z{constructor(e={},t=Gt){super(!1),this._clock=t,this._pointerState=new Map,this._parameters=ns(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=Xe(t);if(!this._pointerState.has(n)){const s={downButton:t.native.button,x:t.x,y:t.y,immediateDoubleClick:null};this._pointerState.set(n,s),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,n=Xe(t),s=this._pointerState.get(n);if(s&&s.downButton===t.native.button){const o=s.immediateDoubleClick,a=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;o?(o.timeoutHandle.remove(),_i(o,e.data)>a?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(t))):_i(s,e.data)>a?this._removeState(t):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,t){const n=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const t=Xe(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},Eu=class extends z{constructor(e={},t=Gt){super(!1),this._clock=t,this._pointerState=new Map,this._parameters=xu(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",n=>this._handlePointerDown(n)),this.registerIncoming("pointer-up",n=>this._handlePointerLoss(n,"pointer-up")),this.registerIncoming("pointer-capture-lost",n=>this._handlePointerLoss(n,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",n=>this._handlePointerLoss(n,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",n=>this._handlePointerMove(n)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=ue(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=t.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const a=this._pointerState.get(n);if(a){if(!a.isDragging){const l=a.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}},this._parameters.holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(n,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const t=e.data,n=t.native.pointerId,s=this._pointerState.get(n);s&&(s.isDragging?this._pointerDrag.emit(ni("update",s,t),void 0,s.modifiers):Tu(t,s.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),s.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const t=e.data,n=t.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,n===s.startEvent.native.pointerId?this._pointerDrag.emit(ni("start",s,t)):this._pointerDrag.emit(ni("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const n=e.data,s=n.native.pointerId,o=this._pointerState.get(s);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(ni("end",o,t==="pointer-up"?n:o.previousEvent),void 0,o.modifiers):t==="pointer-up"&&o.downButton===n.native.button&&e.timestamp-o.startTimestamp<=this._parameters.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(s),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};function ni(i,e,t){return{action:i,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:t}}let Iu=class extends z{constructor(e={},t=Gt){super(!1),this._clock=t,this._pointerState=new Map,this._parameters=ns(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",n=>this._handleImmediateClick(n)),this.registerIncoming("pointer-down",n=>this._handlePointerDown(n))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=ue(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,t){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=ue(n.doubleClickTimer),t&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const t=e.data,{pointerType:n}=t.native,s=Ru(t);if(!this._pointerState.has(s))return void this._startClick(e);const o=this._pointerState.get(s),{data:a,modifiers:l}=o.event,c=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;_i(a,t)>c?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),o.pointerDownCount===2&&this._doubleClick.emit(a,void 0,l))}_handlePointerDown(e){const t=Xe(e.data),n=this._pointerState.get(t);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:n}}=t,s=Xe(t),o=n==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),o);this._pointerState.set(s,{event:e,doubleClickTimer:a,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Ru(i){const{pointerId:e,pointerType:t,button:n}=i.native;return t==="mouse"?`${e}:${n}`:`${t}`}const si={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},to=Symbol("handles");let Ue=class extends x{initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this.addHandles([it(()=>!e(),()=>this._disconnect()),it(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}isModifierKeyDown(e){var t;return((t=this._inputManager)==null?void 0:t.isModifierKeyDown(e))??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(to),this._inputManager=ce(this._inputManager)}_connect(){const e=this.view.surface,t=new bu(e,this.view.input),n=[new Cu,new Eu,new Iu,new Su(this.view.navigation),new $u],s=new te({eventSource:t,recognizers:n}),o=new Qc(this.view,["primary"]),a=new Xc(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new Mu],Ce.INTERNAL),s.installHandlers("navigation",[new du(this.view),new nu(this.view),new uu(this.view),new Ks(this.view),new Ks(this.view,[si.counter]),o,new ru(this.view,si.pan),new hu(this.view,si.zoom),new lu(this.view,si.rotate),a,new Jc(this.view,"touch")],Ce.INTERNAL),this.view.viewEvents.connect(s),this._source=t,this._inputManager=s,this.addHandles([w(()=>{var l,c;return(c=(l=this.view)==null?void 0:l.navigation)==null?void 0:c.browserTouchPanEnabled},l=>{this._source&&(this._source.browserTouchPanningEnabled=!l)},W),w(()=>{const{actionMap:l}=this.view.navigation;return{panActions:Bs("pan",l),rotateActions:Bs("rotate",l)}},({panActions:l,rotateActions:c})=>{o.pointerActions=l,a.pointerActions=c},ne)],to)}get test(){}};r([h()],Ue.prototype,"view",void 0),r([h()],Ue.prototype,"latestPointerType",null),r([h()],Ue.prototype,"latestPointerLocation",null),r([h()],Ue.prototype,"multiTouchActive",null),Ue=r([v("esri.views.2d.input.MapViewInputManager")],Ue);const Vu=Ue,Du=i=>{let e=class extends i{constructor(...t){super(...t),this.goToManager=new ci({view:this}),this.inputManager=new Vu({view:this}),this.addHandles([this.on("resize",n=>this.stateManager.resize(n.width,n.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(t,n,s,o){return this.inputManager&&this.viewEvents.on(t,n,s,o)||super.on(t,n)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}goTo(t,n){return this.goToManager.goTo(t,n)}toMap(t){if(!this.ready)return null;const n=ua(t)?ca(this,t):t;return this.stateManager.toMap(n)}};return r([h()],e.prototype,"goToManager",void 0),r([h({readOnly:!0})],e.prototype,"interacting",null),r([h()],e.prototype,"stationary",null),r([h({readOnly:!0})],e.prototype,"inputManager",void 0),e=r([v("esri.views.Viewport2DMixin")],e),e};let io=class{constructor(e){this._view=e,this.viewpoint=new ae({targetGeometry:new L,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,t]=this._view.size;return Math.sqrt(e*e+t*t)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return $a(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,t){t.pan=Fr(this.center,e.center);let n=Math.abs(e.rotation-this.rotation);n=n>=180?360-n:n,t.rotate=Di(n),t.sourceZoom=this.scale,t.targetZoom=e.scale}interpolate(e,t,n){const{pan:s,rotate:o,zoom:a,zoomOffset:l}=n,{center:c}=this;c.spatialReference=e.center.spatialReference,c.x=Jt(e.center.x,t.center.x,s),c.y=Jt(e.center.y,t.center.y,s),this.viewpoint.scale=Jt(e.scale,t.scale+l,a);let u=e.rotation;const d=t.rotation;Math.abs(d-u)>=180&&(u+=360*(u<d?1:-1)),this.viewpoint.rotation=Jt(u,d,o)}copyFrom(e){q(this.viewpoint,e.viewpoint),this._view=e.view}};const Ou=i=>i,Ht=i=>i*i,wi=i=>1-Ht(1-i),no=i=>i<.5?Ht(2*i)/2:(wi(2*(i-.5))+1)/2,bi=i=>i*i*i,Rn=i=>1-bi(1-i),so=i=>i<.5?bi(2*i)/2:(Rn(2*(i-.5))+1)/2,Mi=i=>i*i*i*i,Vn=i=>1-Mi(1-i),oo=i=>i<.5?Mi(2*i)/2:(Vn(2*(i-.5))+1)/2,xi=i=>i*i*i*i*i,Dn=i=>1-xi(1-i),ao=i=>i<.5?xi(2*i)/2:(Dn(2*(i-.5))+1)/2,Ti=i=>1-Math.cos(i*Math.PI/2),On=i=>1-Ti(1-i),ro=i=>i<.5?Ti(2*i)/2:(On(2*(i-.5))+1)/2,Pi=i=>2**(10*(i-1)),$i=i=>1-Pi(1-i),lo=i=>i<.5?Pi(2*i)/2:($i(2*(i-.5))+1)/2,Si=i=>-(Math.sqrt(1-i*i)-1),Ln=i=>1-Si(1-i),ho=i=>i<.5?Si(2*i)/2:(Ln(2*(i-.5))+1)/2;function re(i){const e=2*(i-Math.sqrt((i-1)*i)),t=e/2/i;return n=>n<t?i*n*n:e*n-e+1}function le(i,e){return(t,n)=>t<e?e*i(t/e,n):1-i((1-t)/(1-e),n)*(1-e)}const co=le(re(1),1),uo=le(re(1),0),ki=le(re(1),.5),po=le(re(2),1),mo=le(re(2),0),go=le(re(2),.5),fo=le(re(3),1),yo=le(re(3),0),vo=le(re(3),.5),_o=le(re(4),1),wo=le(re(4),0),bo=le(re(4),.5),Mo={linear:Ou,"in-quad":Ht,"out-quad":wi,"in-out-quad":no,"in-coast-quad":co,"out-coast-quad":uo,"in-out-coast-quad":ki,"in-cubic":bi,"out-cubic":Rn,"in-out-cubic":so,"in-coast-cubic":po,"out-coast-cubic":mo,"in-out-coast-cubic":go,"in-quart":Mi,"out-quart":Vn,"in-out-quart":oo,"in-coast-quart":fo,"out-coast-quart":yo,"in-out-coast-quart":vo,"in-quint":xi,"out-quint":Dn,"in-out-quint":ao,"in-coast-quint":_o,"out-coast-quint":wo,"in-out-coast-quint":bo,"in-sine":Ti,"out-sine":On,"in-out-sine":ro,"in-expo":Pi,"out-expo":$i,"in-out-expo":lo,"in-circ":Si,"out-circ":Ln,"in-out-circ":ho,"quad-in":Ht,"quad-out":wi,"quad-in-out":no,"quad-in-coast":co,"quad-out-coast":uo,"quad-in-out-coast":ki,"cubic-in":bi,"cubic-out":Rn,"cubic-in-out":so,"cubic-in-coast":po,"cubic-out-coast":mo,"cubic-in-out-coast":go,"quart-in":Mi,"quart-out":Vn,"quart-in-out":oo,"quart-in-coast":fo,"quart-out-coast":yo,"quart-in-out-coast":vo,"quint-in":xi,"quint-out":Dn,"quint-in-out":ao,"quint-in-coast":_o,"quint-out-coast":wo,"quint-in-out-coast":bo,"sine-in":Ti,"sine-out":On,"sine-in-out":ro,"expo-in":Pi,"expo-out":$i,"expo-in-out":lo,"circ-in":Si,"circ-out":Ln,"circ-in-out":ho,ease:i=>ei.ease(i),"ease-in":i=>ei.easeIn(i),"ease-out":i=>ei.easeOut(i),"ease-in-out":i=>ei.easeInOut(i)};let Lu=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Ci={desiredScreenFlow:2,minDuration:oe(500),maxDuration:oe(8e3)},za={maxDuration:oe(4e3)};let Au=class Na{constructor(e){this._createCamera=e,this.compared=new Lu,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Ci.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Na(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,n){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=n.desiredScreenFlow??Ci.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>ji()}get hasFov(){return Math.abs(this.compared.fov)>ji()}get hasRotate(){return this.compared.rotate>ji()}},zu=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Nu=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,t)=>ee(e+t.time),ee(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let n=0,s=0;const o=this.definition,a=this.segments.reduce((l,c)=>l||c.definition.hasZoom,!1);for(let l=0;l<this.segments.length;l++){const c=this.segments[l],u=c.definition;if(e<=c.time||l===this.segments.length-1){if(this.segmentInterpolateComponentsAt(c,c.time===0?0:e/c.time,t),o.hasPan&&!isNaN(t.pan)&&isFinite(o.compared.pan)?t.pan=(n+u.compared.pan*t.pan)/o.compared.pan:t.pan=1,o.hasRotate&&!isNaN(t.rotate)&&isFinite(o.compared.rotate)?t.rotate=(s+u.compared.rotate*t.rotate)/o.compared.rotate:t.rotate=1,a&&!isNaN(t.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:d,targetZoom:m}=u.compared,p=t.zoom*(m-d)+d,g=this.segments[0].definition.compared.sourceZoom,_=this.segments[this.segments.length-1].definition.compared.targetZoom,f=Math.abs(m-g)>Math.abs(d-g)?m:d;t.zoomOffset=f-_,t.zoom=(p-g)/(f-g)}else t.zoom=1;return t}e-=c.time,n+=u.compared.pan,s+=u.compared.rotate}}segmentInterpolateComponentsAt(e,t,n){e.interpolateComponentsAt(t,n)}},rn=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,n=t.sourceZoom,s=t.targetZoom;this._zoomSign=n>s?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(n);const o=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=t.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:n,hasPan:s,hasRotate:o}=this.definition;let a=0,l=0;n&&(s&&(a=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),o&&(l=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const c=this.definition.desiredPixelFlow;if(n&&s&&o){const u=a+l+a*l;this._zoomPixelFlow=a*l/u*c,this._panPixelFlow=l/u*c,this._rotatePixelFlow=a/u*c}else if(n&&s){const u=1+a;this._zoomPixelFlow=a/u*c,this._panPixelFlow=1/u*c}else if(n&&o){const u=1+l;this._zoomPixelFlow=l/u*c,this._rotatePixelFlow=1/u*c}else if(s&&o){const u=this._panPixelsAtSource/this._rotatePixels,d=1+u;this._panPixelFlow=u/d*c,this._rotatePixelFlow=1/d*c}else s?this._panPixelFlow=c:n?this._zoomPixelFlow=c:o&&(this._rotatePixelFlow=c);if(this._time=ee(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?ee(this._rotatePixels/this._rotatePixelFlow):ee(0)}get zoomTime(){return this.definition.hasZoom?ee(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):ee(0)}get fovTime(){return this.definition.hasFov?ee(Math.abs(this.definition.compared.fov)/Fu):ee(0)}get panTime(){if(!this.definition.hasPan)return ee(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return ee(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return ee(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom;return(t*(t/n)**-e-t)/(n-t)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:t,segmentEnd:n}=this.definition;return t+e*(n-t)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),t.zoom=this._interpolateComponentsZoom(e),t.pan=this._interpolateComponentsPan(e),t.rotate=this._interpolateComponentsRotate(e),t.zoomOffset=0,t.fov=this._interpolateComponentsFov(e)}};const Fu=Di(45);function Hu(i,e,t){const n=e-i.compared.sourceZoom,s=i.halfWindowPanAtZoom(n);return-i.halfWindowSize*(t.ascensionFactor*Math.LN2*i.compared.pan+s)*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2*s)}function Zu(i,e,t){const n=1/e,s=Math.log(i.compared.sourceZoom*n),o=1/i.desiredPixelFlow,a=1/Math.LN2,l=e-i.compared.sourceZoom,c=1/l,u=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(l))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*o*a*c*u-i.halfWindowSize*s*o*a*c+i.halfWindowSize*s*o*a*u/(l*l)}function qu(i,e,t){const n=e-i.compared.sourceZoom,s=1/n,o=1/e,a=Math.log(i.compared.sourceZoom*o),l=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(n))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*s*(-2*s*o*l+2*s*a+2*o-2*a*l/(n*n)-l/(e*e))/(i.desiredPixelFlow*Math.LN2)}function Gu(i,e){return-i.halfWindowSize*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2)}function Wu(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function ju(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function Uu(i,e,t){return-i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e))}function Bu(i,e,t){return i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e))}function Ku(i,e,t){return-2*i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e*e))}function Yu(i,e,t){return i.halfWindowSize*(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*i.halfWindowPanAtZoom(-e+i.compared.targetZoom))}function Ju(i,e,t){const n=Math.log(e/i.compared.targetZoom),s=1/i.desiredPixelFlow,o=1/Math.LN2,a=-e+i.compared.targetZoom,l=1/a,c=(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return-i.halfWindowSize*n*s*o*l+i.halfWindowSize*n*s*o*c/(a*a)+i.halfWindowSize*s*o*l*c/e}function Qu(i,e,t){const n=e-i.compared.targetZoom,s=1/n,o=1/e,a=Math.log(e/i.compared.targetZoom),l=(i.halfWindowPanAtZoom(e)+t.descensionFactor*Math.LN2*i.compared.pan-i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*s*(-2*s*o*l-2*s*a+2*o+2*a*l/(n*n)-l/(e*e))/(i.desiredPixelFlow*Math.LN2)}function Xu(i,e){return i.halfWindowSize*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2)}function ed(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function td(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function id(i){const e=i.compared.sourceZoom-i.compared.targetZoom;if(e===0)return i.compared.pan*i.halfWindowSize/(i.desiredPixelFlow*i.halfWindowPanAtZoom(i.compared.sourceZoom));const t=Math.LN2*i.compared.pan,n=e,s=i.halfWindowPanAtZoom(n),o=i.halfWindowSize*Math.log(i.compared.sourceZoom/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*s);return i.compared.sourceZoom<=i.compared.targetZoom?o*(t-s):o*(t+s)}function nd(i,e){let t=sd(i,e);const n={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=n.ascensionFactor===0,o=n.descensionFactor===0,a=s?Gu:Hu,l=s?Wu:Zu,c=s?ju:qu,u=o?Xu:Yu,d=o?ed:Ju,m=o?td:Qu,p=k=>a(i,k,n)+Uu(i,k,n)+u(i,k,n),g=k=>l(i,k,n)+Bu(i,k,n)+d(i,k,n),_=k=>c(i,k,n)+Ku(i,k,n)+m(i,k,n);let f=p(t);const T=id(i);let P;const O=e.maximumIterations||20,$=e.maximumDistance!=null?e.maximumDistance:1/0;for(P=0;P<O;P++){const k=e.desiredSlope??1e-6;let Y=g(t);Math.abs(Y)>k&&(Y+=k);const de=Y/_(t);if(isNaN(de)||t>=$&&de<0){if(!isFinite($))return null;t=$,f=p(t);break}if(t-=de,t<=i.compared.sourceZoom||t<=i.compared.targetZoom)return null;const xt=p(t);if(Math.abs(xt-f)/f<=.005)break;f=xt}return isNaN(f)||f>T*(1-.3)||t<=i.compared.sourceZoom||t<=i.compared.targetZoom?null:t}function sd(i,e){const t=Math.max(i.compared.sourceZoom,i.compared.targetZoom),n=i.source.zoomAtPixelsPerPan(i.desiredPixelFlow/i.compared.pan)/2;return n<t?e.maximumDistance!=null?t+(e.maximumDistance-t)/2:1.5*t:e.maximumDistance?Math.min(e.maximumDistance,n):n}let od=class extends Nu{constructor(e,t){super(),this._preallocSegments=[new rn,new rn,new rn],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const n=t!=null&&t.apex?nd(e,t.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,n?this._updateWithApex(n,t==null?void 0:t.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,t,n){e.interpolateComponentsAt(t,n),e===this._ascensionSegment?n.zoom=wi(n.zoom):e===this._descensionSegment&&(n.zoom=Ht(n.zoom))}_updateWithApex(e,t){const[n,s,o]=this._preallocSegments,a=(t==null?void 0:t.ascensionFactor)??.5,l=Math.min(1-a,(t==null?void 0:t.ascensionFactor)!=null&&t.descensionFactor!=null?t.descensionFactor:.5),c=1-a-l;n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentEnd=a,n.update(),this._ascensionSegment=n,this.segments.push(n),c>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*c,s.definition.compared.rotate=this.definition.compared.rotate*c,s.definition.segmentStart=n.definition.segmentEnd,s.definition.segmentEnd=n.definition.segmentEnd+c,s.update(),this.segments.push(s)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*l,o.definition.compared.rotate=this.definition.compared.rotate*l,o.definition.segmentStart=a+c,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const ad=new zu;let rd=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=oe(0),this._easing=ki,this.definition=new Au(e),this.path=new od}update(e,t,n){this.definition.update(e,t,n),this.path.update(this.definition,n),this._time=this._applyTimeSettings(Hr(isFinite(this.path.time)?this.path.time:ee(0)),n),this._easing=n.easing??(this._time>=1e3?ki:$i)}cameraAt(e,t){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const n=this.path.interpolateComponentsAt(e,ad);t.interpolate(this.definition.source,this.definition.target,n)}_normalizedEasing(e){const t=this._easing(0,this._time),n=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(n-t)}_applyTimeSettings(e,t){const n=t.speedFactor!=null?t.speedFactor:1,s=t.minDuration??Ci.minDuration/n,o=t.maxDuration??Ci.maxDuration/n;return e=t.duration!=null?oe(t.duration):oe(Math.min(Math.max(e/n,s),o))}};const ld=2e3,hd=64;let cd=class{constructor(e){this._view=e,this._animation=new rd(()=>new io(this._view)),this._current=new io(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,t,n={}){q(this._current.viewpoint,e),q(this._source.viewpoint,e),q(this._target.viewpoint,t),this._animation.update(this._source,this._target,n)}applyRatio(e,t){this._animation.cameraAt(t,this._current),q(e,this._current.viewpoint)}},gt=class extends x{constructor(e){super(e),this._animation=null,this._destinationViewState=new is,this.updateFunction=null,this.easing=Mo.ease,this.viewpoint=new ae({targetGeometry:new L,scale:0,rotation:0}),this._updateTask=bt({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new cd(e.view)}destroy(){this._updateTask=ue(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,t,n){this.stop();const s=this.viewpoint;q(s,t);const o=e.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(Math.min(t.scale,o.scale)*hd,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:n==null?void 0:n.duration,maxDuration:(n==null?void 0:n.animationMode)==="auto"?oe(1/0):(n==null?void 0:n.maxDuration)??za.maxDuration,speedFactor:n==null?void 0:n.speedFactor,easing:(typeof(n==null?void 0:n.easing)=="string"?Mo[n.easing]:n==null?void 0:n.easing)||this.easing}),(n==null?void 0:n.animationMode)==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,ud(this._transition.animation,n,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:oe(0)}));const a=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const n=new In({target:e.clone()}),s=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var n,s;const t=this.animation;if(t&&t.state!==In.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),(n=this.animation)==null||n.update(this.viewpoint);else{const o=performance.now()-this._startTime,a=this._transition.duration,l=a>0?o/a:1,c=l>=1;this._transition.applyRatio(this.viewpoint,l),c&&((s=this.animation)==null||s.finish())}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function ud(i,e,t,n){if((e==null?void 0:e.duration)!=null)return!0;const{time:s,isLinear:o}=i,a=(e==null?void 0:e.speedFactor)||1;if(s>((e==null?void 0:e.maxDuration)??za.maxDuration/a))return!1;if(o){const c=A(),u=H(...n.toScreen(c,...t.center)),d=H(...t.toScreen(c,...n.center)),m=d!=null&&d.x>-1*t.size[0]&&d.x<(1.5+.5)*t.size[0]&&d.y>-1*t.size[1]&&d.y<(1.5+.5)*t.size[1],p=u!=null&&u.x>-1*n.size[0]&&u.x<(1.5+.5)*n.size[0]&&u.y>-1*n.size[1]&&u.y<(1.5+.5)*n.size[1];if(s>ld/a&&!m&&!p)return!1}return!0}r([h()],gt.prototype,"easing",void 0),r([h()],gt.prototype,"view",void 0),r([h()],gt.prototype,"viewpoint",void 0),gt=r([v("esri.views.2d.AnimationManager")],gt);const dd=gt;function I(){return Promise.all([M(()=>import("./webglDeps-DNAo8tU8.js"),__vite__mapDeps([152,153,1,2,154,155,156,83,157,158])),M(()=>import("./mapViewDeps-8pyWrqvq.js"),__vite__mapDeps([159,2,1,147,143,73,54,74,160,161,22,24,21,17,84,83,162,60,58,59,163,164,165,144,145,146,103,139,148,31,18,29,30,32,166,167,168,155,156,169,42,43,170,171,172,173,154,157,153,174,175,176,177,178,179,180,181,182,109,52,53,183,184,185,186,187,23,85,19,39,188,189,190,191,192,193,194,67,68,4,55,69,70,71,195,196,152,158,197,198,199,200,201,202,203,204,205,206,82,207,6,49,45,208,87,78,79,76,80,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,28,224,112,225,226,14,227,102,5,228,229,7,8,9,10,230,231,232,125,233,33,234,121,235,236,237,238,239,16,3,20,25,94,240,241,242,243,66]))])}const $t=()=>I().then(()=>M(()=>import("./TileLayerView2D-BSlMYYAA.js"),__vite__mapDeps([244,1,2,239,16,3,4,17,18,19,20,21,22,23,24,25,143,73,54,74,59,60,165,163,160,161,84,83,162,58,164,144,145,146,103,139,147,148,31,29,30,32,166,167,168,155,156,169,42,43,170,194,67,68,55,69,70,71,195,182,109,52,53,179,153,154,178,180,181,183,184,185,186,187,85,196,197,173,157,174,175,176,177,198,199,200,82,172,171,39,188,189,190,192,193,202,203,204,216,207,6,49,45,208,87,78,79,76,80,209,210,217,218,219,28,245,246,247,223,248,149,249,221,222,250,251,112,252,253,254,255,241,14,227,102,5,228,229,7,8,9,10,230,231,232,125,233,33,234,121,235,236,237,238,94,240,242,206,243,66]))),qe=()=>I().then(()=>M(()=>import("./FeatureLayerView2D-ChmIZwDV.js").then(i=>i.F),__vite__mapDeps([256,1,2,16,3,4,17,18,19,20,21,22,23,24,25,170,182,109,52,53,54,187,84,83,85,117,31,29,30,32,27,28,8,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,257,88,258,259,208,87,78,79,76,80,209,260,55,248,139,149,222,163,160,161,162,60,58,59,164,165,144,145,146,103,147,148,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,171,172,173,174,175,176,177,188,189,190,198,102,5,6,123,72,73,74,191,261,262,113,116,108,252,255,250]))),xo={"base-dynamic":()=>I().then(()=>M(()=>import("./BaseDynamicLayerView2D-DUe0qMK3.js"),__vite__mapDeps([263,1,2,264,144,54,145,146,103,139,147,148,31,17,18,29,30,32,179,168,155,163,166,156,169,153,154,83,178,180,181,182,109,22,52,53,183,60,184,185,186,187,23,84,85,19,246,173,157,174,175,172,247,248,149,170,265,228,229,250,14,227,102,5,6,87,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,16,3,4,20,21,24,25,94,55,240,78,79,76,80,241,242,206,189,243,66]))),"base-tile":$t,"bing-maps":$t,catalog:()=>I().then(()=>M(()=>import("./CatalogLayerView2D-8fNC9PEN.js"),__vite__mapDeps([266,1,2,248,182,109,22,52,53,54,139,17,149,170,14,18,227,102,103,5,6,87,228,229,7,8,9,10,28,147,230,231,232,125,233,33,234,121,235,236,237,238,32,239,16,3,4,19,20,21,23,24,25,94,55,31,29,30,240,146,186,144,145,148,78,79,76,80,178,166,241,180,242,163,155,154,156,206,189,243,66]))),"catalog-dynamic-group":()=>I().then(()=>M(()=>import("./CatalogDynamicGroupLayerView2D-B7SE9GHl.js"),__vite__mapDeps([267,1,2,248,182,109,22,52,53,54,139,17,149,170,4,14,18,227,102,103,5,6,87,228,229,7,8,9,10,28,147,230,231,232,125,233,33,234,121,235,236,237,238,32,239,16,3,19,20,21,23,24,25,94,55,31,29,30,240,146,186,144,145,148,78,79,76,80,178,166,241,180,242,163,155,154,156,206,189,243,66]))),"catalog-footprint":()=>I().then(()=>M(()=>import("./CatalogFootprintLayerView2D-T0O2fXhE.js"),__vite__mapDeps([268,1,2,256,16,3,4,17,18,19,20,21,22,23,24,25,170,182,109,52,53,54,187,84,83,85,117,31,29,30,32,27,28,8,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,257,88,258,259,208,87,78,79,76,80,209,260,55,248,139,149,222,163,160,161,162,60,58,59,164,165,144,145,146,103,147,148,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,171,172,173,174,175,176,177,188,189,190,198,102,5,6,123,72,73,74,191,261,262,113,116,108,252,255,250,14,227,228,229,7,9,10,230,231,232,125,233,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),csv:qe,"geo-rss":()=>I().then(()=>M(()=>import("./GeoRSSLayerView2D-BmW4b_Ak.js"),__vite__mapDeps([269,1,2,3,4,34,35,36,37,22,38,16,17,18,19,20,21,23,24,25,39,40,33,41,42,43,120,63,64,46,61,62,65,66,67,68,55,69,70,71,58,59,60,72,73,54,74,44,45,47,88,29,30,248,182,109,52,53,139,149,170,220,144,145,146,103,147,148,31,32,221,222,163,160,161,84,83,162,164,165,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,187,85,171,172,173,174,175,176,177,188,189,190,78,79,76,80,216,194,143,195,207,6,49,208,87,209,210,217,218,219,14,227,102,5,228,229,7,8,9,10,28,230,231,232,125,233,234,121,235,236,237,238,239,94,240,241,242,206,243]))),feature:qe,geojson:qe,parquet:qe,graphics:()=>I().then(()=>M(()=>import("./GraphicsLayerView2D-CeMShTUF.js"),__vite__mapDeps([270,1,2,16,3,4,17,18,19,20,21,22,23,24,25,248,182,109,52,53,54,139,149,170,220,144,145,146,103,147,148,31,29,30,32,221,222,163,160,161,84,83,162,60,58,59,164,165,166,167,168,155,156,169,42,43,157,153,154,223,179,178,180,181,183,184,185,186,187,85,171,172,173,174,175,176,177,39,188,189,190,78,79,76,80,216,67,68,55,194,143,73,74,69,70,71,195,207,6,49,45,208,87,209,210,217,218,219,14,227,102,5,228,229,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),group:()=>I().then(()=>M(()=>import("./GroupLayerView2D-Di-54unU.js"),__vite__mapDeps([271,1,2,248,182,109,22,52,53,54,139,17,149,170,14,18,227,102,103,5,6,87,228,229,7,8,9,10,28,147,230,231,232,125,233,33,234,121,235,236,237,238,32,239,16,3,4,19,20,21,23,24,25,94,55,31,29,30,240,146,186,144,145,148,78,79,76,80,178,166,241,180,242,163,155,154,156,206,189,243,66]))),imagery:()=>I().then(()=>M(()=>import("./ImageryLayerView2D-BwVfx9rG.js"),__vite__mapDeps([272,1,2,16,3,4,17,18,19,20,21,22,23,24,25,239,273,178,54,153,154,155,156,83,169,274,179,168,163,144,145,146,103,139,147,148,31,29,30,32,166,180,181,182,109,52,53,183,60,184,185,186,187,84,85,248,149,170,216,67,68,55,160,161,162,58,59,164,165,167,42,43,194,143,73,74,69,70,71,195,207,6,49,45,177,208,87,78,79,76,80,209,210,171,172,173,157,174,175,176,39,188,189,190,217,218,219,249,221,222,223,264,246,247,265,228,229,275,257,255,250,14,227,102,5,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,94,240,241,242,206,243,66]))),"imagery-tile":()=>I().then(()=>M(()=>import("./ImageryTileLayerView2D-Chi_SsaL.js"),__vite__mapDeps([276,1,2,277,29,30,273,16,3,4,17,18,19,20,21,22,23,24,25,178,54,153,154,155,156,83,169,274,179,168,163,144,145,146,103,139,147,148,31,32,166,180,181,182,109,52,53,183,60,184,185,186,187,84,85,248,149,170,278,279,223,173,157,174,175,172,247,176,177,228,229,280,275,87,241,189,257,255,250,14,227,102,5,6,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,55,240,78,79,76,80,242,206,243,66]))),kml:()=>I().then(()=>M(()=>import("./KMLLayerView2D-CnDz6IMB.js"),__vite__mapDeps([281,1,2,87,282,3,4,23,120,63,64,35,36,37,22,38,16,17,18,19,20,21,24,25,39,40,33,41,42,43,46,61,62,65,66,67,68,55,69,70,71,58,59,60,72,73,54,74,34,44,45,47,88,29,30,76,239,246,178,166,182,109,52,53,155,154,156,163,173,144,145,146,103,139,147,148,31,32,157,153,83,174,175,172,247,264,179,168,169,180,181,183,184,185,186,187,84,85,248,149,170,220,221,222,160,161,162,164,165,167,223,171,176,177,188,189,190,78,79,80,216,194,143,195,207,6,49,208,209,210,217,218,219,214,215,275,201,152,158,202,203,204,199,279,14,227,102,5,228,229,7,8,9,10,28,230,231,232,125,233,234,121,235,236,237,238,94,240,241,242,206,243]))),"knowledge-graph":()=>I().then(()=>M(()=>import("./KnowledgeGraphLayerView2D-0i2JFw9N.js"),__vite__mapDeps([283,1,2,248,182,109,22,52,53,54,139,17,149,170,14,18,227,102,103,5,6,87,228,229,7,8,9,10,28,147,230,231,232,125,233,33,234,121,235,236,237,238,32,239,16,3,4,19,20,21,23,24,25,94,55,31,29,30,240,146,186,144,145,148,78,79,76,80,178,166,241,180,242,163,155,154,156,206,189,243,66]))),"link-chart":()=>I().then(()=>M(()=>import("./KnowledgeGraphLayerView2D-0i2JFw9N.js"),__vite__mapDeps([283,1,2,248,182,109,22,52,53,54,139,17,149,170,14,18,227,102,103,5,6,87,228,229,7,8,9,10,28,147,230,231,232,125,233,33,234,121,235,236,237,238,32,239,16,3,4,19,20,21,23,24,25,94,55,31,29,30,240,146,186,144,145,148,78,79,76,80,178,166,241,180,242,163,155,154,156,206,189,243,66]))),"knowledge-graph-sublayer":qe,"map-image":()=>I().then(()=>M(()=>import("./MapImageLayerView2D-Dp9Rx7NV.js"),__vite__mapDeps([284,1,2,239,16,3,4,17,18,19,20,21,22,23,24,25,264,144,54,145,146,103,139,147,148,31,29,30,32,179,168,155,163,166,156,169,153,154,83,178,180,181,182,109,52,53,183,60,184,185,186,187,84,85,246,173,157,174,175,172,247,248,149,170,216,67,68,55,160,161,162,58,59,164,165,167,42,43,194,143,73,74,69,70,71,195,207,6,49,45,177,208,87,78,79,76,80,209,210,171,176,39,188,189,190,217,218,219,249,221,222,223,265,228,229,285,112,252,254,257,250,251,253,255,14,227,102,5,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,94,240,241,242,206,243,66]))),"map-notes":()=>I().then(()=>M(()=>import("./MapNotesLayerView2D-5rukOnFy.js"),__vite__mapDeps([286,1,2,16,3,4,17,18,19,20,21,22,23,24,25,248,182,109,52,53,54,139,149,170,220,144,145,146,103,147,148,31,29,30,32,221,222,163,160,161,84,83,162,60,58,59,164,165,166,167,168,155,156,169,42,43,157,153,154,223,179,178,180,181,183,184,185,186,187,85,171,172,173,174,175,176,177,39,188,189,190,78,79,76,80,216,67,68,55,194,143,73,74,69,70,71,195,207,6,49,45,208,87,209,210,217,218,219,14,227,102,5,228,229,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),media:()=>I().then(()=>M(()=>import("./MediaLayerView2D-CVeLhojF.js"),__vite__mapDeps([287,2,1,16,3,4,17,18,19,20,21,22,23,24,25,288,87,217,79,178,54,218,146,180,34,35,36,37,38,39,40,33,41,42,43,143,73,74,59,60,165,163,160,161,84,83,162,58,164,144,145,103,139,147,148,31,29,30,32,166,167,168,155,156,169,170,194,67,68,55,69,70,71,195,182,109,52,53,179,153,154,181,183,184,185,186,187,85,196,197,173,157,174,175,176,177,198,199,200,82,172,171,188,189,190,192,193,202,203,204,216,207,6,49,45,208,78,76,80,209,210,219,28,211,289,212,248,149,241,14,227,102,5,228,229,7,8,9,10,230,231,232,125,233,234,121,235,236,237,238,239,94,240,242,206,243,66]))),"ogc-feature":()=>I().then(()=>M(()=>import("./OGCFeatureLayerView2D-Y_CMGnnc.js"),__vite__mapDeps([290,1,2,256,16,3,4,17,18,19,20,21,22,23,24,25,170,182,109,52,53,54,187,84,83,85,117,31,29,30,32,27,28,8,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,257,88,258,259,208,87,78,79,76,80,209,260,55,248,139,149,222,163,160,161,162,60,58,59,164,165,144,145,146,103,147,148,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,171,172,173,174,175,176,177,188,189,190,198,102,5,6,123,72,73,74,191,261,262,113,116,108,252,255,250,14,227,228,229,7,9,10,230,231,232,125,233,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),"open-street-map":$t,"oriented-imagery":qe,route:()=>I().then(()=>M(()=>import("./RouteLayerView2D-CkkUQgn3.js"),__vite__mapDeps([291,2,1,227,292,16,3,4,17,18,19,20,21,22,23,24,25,293,248,182,109,52,53,54,139,149,170,220,144,145,146,103,147,148,31,29,30,32,221,222,163,160,161,84,83,162,60,58,59,164,165,166,167,168,155,156,169,42,43,157,153,154,223,179,178,180,181,183,184,185,186,187,85,171,172,173,174,175,176,177,39,188,189,190,78,79,76,80,216,67,68,55,194,143,73,74,69,70,71,195,207,6,49,45,208,87,209,210,217,218,219,14,102,5,228,229,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),stream:()=>I().then(()=>M(()=>import("./StreamLayerView2D-D5-hDpb4.js"),__vite__mapDeps([294,1,2,88,16,3,4,17,18,19,20,21,22,23,24,25,29,30,256,170,182,109,52,53,54,187,84,83,85,117,31,32,27,28,8,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,257,258,259,208,87,78,79,76,80,209,260,55,248,139,149,222,163,160,161,162,60,58,59,164,165,144,145,146,103,147,148,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,171,172,173,174,175,176,177,188,189,190,198,102,5,6,123,72,73,74,191,261,262,113,116,108,252,255,250,14,227,228,229,7,9,10,230,231,232,125,233,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),"subtype-group":()=>I().then(()=>M(()=>import("./SubtypeGroupLayerView2D-BA4tWaIz.js"),__vite__mapDeps([295,1,2,256,16,3,4,17,18,19,20,21,22,23,24,25,170,182,109,52,53,54,187,84,83,85,117,31,29,30,32,27,28,8,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,257,88,258,259,208,87,78,79,76,80,209,260,55,248,139,149,222,163,160,161,162,60,58,59,164,165,144,145,146,103,147,148,166,167,168,155,156,169,157,153,154,223,179,178,180,181,183,184,185,186,171,172,173,174,175,176,177,188,189,190,198,102,5,6,123,72,73,74,191,261,262,113,116,108,252,255,250,14,227,228,229,7,9,10,230,231,232,125,233,234,121,235,236,237,238,239,94,240,241,242,206,243,66]))),tile:$t,"vector-tile":()=>I().then(()=>M(()=>import("./VectorTileLayerView2D-WmYFH3Xx.js"),__vite__mapDeps([296,1,2,45,196,102,103,5,6,167,155,154,156,82,83,164,165,59,60,163,145,61,62,144,54,146,139,147,148,31,17,18,29,30,32,200,184,162,183,178,153,179,168,166,169,180,181,182,109,22,52,53,185,186,187,23,84,85,19,228,229,223,16,3,4,20,21,24,25,297,298,299,143,73,74,242,248,149,170,250,241,14,227,87,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,55,240,78,79,76,80,206,189,243,66]))),video:()=>I().then(()=>M(()=>import("./VideoLayerView2D-DQCEDrIf.js"),__vite__mapDeps([300,1,2,16,3,4,17,18,19,20,21,22,23,24,25,301,239,32,107,92,108,109,52,53,54,127,96,39,302,57,58,59,60,56,28,61,62,289,178,166,181,78,79,76,80,144,145,146,103,139,147,148,31,29,30,179,168,155,163,156,169,153,154,83,180,182,183,184,185,186,187,84,85,171,160,161,162,164,165,167,42,43,170,172,173,157,174,175,176,177,188,189,190,212,87,248,149,220,221,222,223,216,67,68,55,194,143,73,74,69,70,71,195,207,6,49,45,208,209,210,217,218,219,14,227,102,5,228,229,7,8,9,10,230,231,232,125,233,33,234,121,235,236,237,238,94,240,241,242,206,243,66]))),wcs:()=>I().then(()=>M(()=>import("./ImageryTileLayerView2D-Chi_SsaL.js"),__vite__mapDeps([276,1,2,277,29,30,273,16,3,4,17,18,19,20,21,22,23,24,25,178,54,153,154,155,156,83,169,274,179,168,163,144,145,146,103,139,147,148,31,32,166,180,181,182,109,52,53,183,60,184,185,186,187,84,85,248,149,170,278,279,223,173,157,174,175,172,247,176,177,228,229,280,275,87,241,189,257,255,250,14,227,102,5,6,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,94,55,240,78,79,76,80,242,206,243,66]))),"web-tile":$t,wfs:qe,wms:()=>I().then(()=>M(()=>import("./WMSLayerView2D-wHbrTaJs.js"),__vite__mapDeps([303,1,2,264,144,54,145,146,103,139,147,148,31,17,18,29,30,32,179,168,155,163,166,156,169,153,154,83,178,180,181,182,109,22,52,53,183,60,184,185,186,187,23,84,85,19,246,173,157,174,175,172,247,248,149,170,265,228,229,250,304,257,14,227,102,5,6,87,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,16,3,4,20,21,24,25,94,55,240,78,79,76,80,241,242,206,189,243,66]))),wmts:()=>I().then(()=>M(()=>import("./WMTSLayerView2D-C-aB_1Zx.js"),__vite__mapDeps([305,1,2,245,246,178,54,166,182,109,22,52,53,155,154,156,163,173,144,145,146,103,139,147,148,31,17,18,29,30,32,157,153,83,174,175,172,247,179,168,169,180,181,183,60,184,185,186,187,23,84,85,19,223,248,149,170,250,241,14,227,102,5,6,87,228,229,7,8,9,10,28,230,231,232,125,233,33,234,121,235,236,237,238,239,16,3,4,20,21,24,25,94,55,240,78,79,76,80,242,206,189,243,66]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function pd(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new S(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const To={hasLayerViewModule:i=>xo[i.type]!=null,importLayerView:i=>{const e=xo[i.type];if(e==null)throw pd(i);return e(i)}};let md=class{constructor(e,t={}){this.events=new qt,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):t.canvas!=null&&(this._canvas=t.canvas);const n={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",n);s||(s=this._canvas.getContext("webgl2",{...n,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=zo([Oo(this._canvas,"webglcontextlost",o=>this.events.emit("webgl-context-lost",o))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,t){if(this._hasMajorPerformanceCaveat||F("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=F("esri-performance-mode-frames-between-render")&&(t(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[n,s,o,a,l,c]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${n}, ${s}, ${o}, ${a}, ${l}, ${c})`}}else t()}resize(e){const t=this._canvas,n=t.style,{state:{size:s},pixelRatio:o}=e,a=s[0],l=s[1],c=Math.round(a*o),u=Math.round(l*o);t.width===c&&t.height===u||(t.width=c,t.height=u),n.width=a+"px",n.height=l+"px"}_computeViewTransform(e,t){const[n,s]=e.center,[o,a]=t.center,[l,c]=e.toScreen([0,0],o,a),[u,d]=e.toScreen([0,0],n,s),m=u-l,p=d-c,g=e.scale/t.scale,_=t.rotation-e.rotation,f=ye();return Il(f),Bn(f,f,[g,g]),Fi(f,f,Di(_)),Nt(f,f,[m,p]),f}};const Ge={added:[],removed:[]},ln=new Set,gd=new Zl(0,0,0,0);function fd(i,e){const t=Go(e);if(!t)return null;const[n,s]=t.valid;return i[2]>s?[Qt([i[0],i[1],s,i[3]]),Qt([n,i[1],n+i[2]-s,i[3]])]:i[0]<n?[Qt([n,i[1],i[2],i[3]]),Qt([s-(n-i[0]),i[1],s,i[3]])]:null}let yd=class extends qt{constructor(e){super(),this._tiles=new Map,this._index=Rl(9,F("esri-csp-restrictions")?t=>({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||Zr(e)===0||qr(e)===0)return[];const t=fd(e,this.tileScheme.spatialReference);return t!=null?[...new Set([...this.boundsIntersections(t[0]),...this.boundsIntersections(t[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const n of e.added)if(!this.has(n)){const s=new Ts(this.tileScheme,n);this._tiles.set(n,s),this._index.insert(s),t.added.push(s)}for(const n of e.removed)if(this.has(n)){const s=this.get(n);this._tiles.delete(n),this._index.remove(s),t.removed.push(s)}this.tiles.length=0,this._tiles.forEach(n=>this.tiles.push(n)),(t.added.length||t.removed.length)&&this.emit("update",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:n,lodInfo:s}=t,{level:o}=s;if(n.length>0)for(const{row:a,colFrom:l,colTo:c}of n)for(let u=l;u<=c;u++){const d=gd.set(o,a,s.normalizeCol(u),s.getWorldForColumn(u)).id;if(ln.add(d),!this.has(d)){const m=new Ts(this.tileScheme,d);this._tiles.set(d,m),this._index.insert(m),this.tiles.push(m),Ge.added.push(m)}}for(let a=this.tiles.length-1;a>=0;a--){const l=this.tiles[a];ln.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(a,1),this._index.remove(l),Ge.removed.push(l))}(Ge.added.length||Ge.removed.length)&&this.emit("update",Ge),Vl.pool.release(t),ln.clear(),Ge.added.length=0,Ge.removed.length=0}};const vd=1,Zg=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],qg=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],St=256,hn=()=>E.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function _d(i,e){e.fillColor[0]=i.color.r/255,e.fillColor[1]=i.color.g/255,e.fillColor[2]=i.color.b/255,e.fillColor[3]=i.color.a,i.haloColor?(e.outlineColor[0]=i.haloColor.r/255,e.outlineColor[1]=i.haloColor.g/255,e.outlineColor[2]=i.haloColor.b/255,e.outlineColor[3]=i.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=i.fillOpacity,e.outlineColor[3]*=i.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-i.haloBlur)*i.haloWidth,e.outerHaloWidth=i.haloBlur*i.haloWidth/2,e.innerHaloWidth=i.haloBlur*i.haloWidth/2,e.outlinePosition=0}const wd=[0,0,0,0];let Fa=class{constructor(){this.type="single",this._highlightOptions=new Ze,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*St),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,t){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,ql),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){var e;(e=this._shadeTex)==null||e.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<Gl)-1,activeGradient:this}]}_updateGradientTexture(e){const t=bd(this._highlightOptions);if(t===this._optionsShadeTexKey)return;this._optionsShadeTexKey=t,_d(this._highlightOptions,this._convertedHighlightOptions);const n=this._convertedHighlightOptions,s=n.outlinePosition-n.outlineWidth/2-n.outerHaloWidth,o=n.outlinePosition-n.outlineWidth/2,a=n.outlinePosition+n.outlineWidth/2,l=n.outlinePosition+n.outlineWidth/2+n.innerHaloWidth,c=Math.sqrt(Math.PI/2)*vd,u=Math.abs(s)>c?Math.round(10*(Math.abs(s)-c))/10:0,d=Math.abs(l)>c?Math.round(10*(Math.abs(l)-c))/10:0;let m;u&&!d?hn().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&d?hn().error("The inner rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&d&&hn().error("The highlight is "+Math.max(u,d)+"px away from the edge of the feature; consider reducing some width values.");const p=[void 0,void 0,void 0,void 0];function g(f,T,P){p[0]=(1-P)*f[0]+P*T[0],p[1]=(1-P)*f[1]+P*T[1],p[2]=(1-P)*f[2]+P*T[2],p[3]=(1-P)*f[3]+P*T[3]}const{_texelData:_}=this;for(let f=0;f<St;++f)m=s+f/(St-1)*(l-s),m<s?(p[0]=0,p[1]=0,p[2]=0,p[3]=0):m<o?g(wd,n.outlineColor,(m-s)/(o-s)):m<a?[p[0],p[1],p[2],p[3]]=n.outlineColor:m<l?g(n.outlineColor,n.fillColor,(m-a)/(l-a)):[p[0],p[1],p[2],p[3]]=n.fillColor,_[4*f]=255*p[0],_[4*f+1]=255*p[1],_[4*f+2]=255*p[2],_[4*f+3]=255*p[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=l,!this._shadeTex){const f=new Ul;f.wrapMode=Wl.CLAMP_TO_EDGE,f.width=St,f.height=1,this._shadeTex=new Bl(e,f)}this._shadeTex.updateData(0,0,0,St,1,this._texelData)}};function bd(i){return`${i.color};${i.haloColor};${i.haloOpacity};${i.fillOpacity};${i.haloWidth};${i.haloBlur}`}let Md=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let t=0;t<e.length;t++)this.gradients[t]||(this.gradients[t]=new Fa),this.gradients[t].setHighlightOptions(e[t]);for(let t=e.length+1;t<this.gradients.length;t++)this.gradients[t].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const t=[];for(let n=0;n<this.gradients.length;n++){const s=this.gradients[n];t.push({activeReasons:e,activeGradient:s}),e<<=1}return t}};const Ha={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:i=>i.stencilRef,compare:jl.EQUAL,mask:255,op:{fail:Ui.KEEP,zFail:Ui.KEEP,zPass:Ui.REPLACE}}}},xd={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},Td={...Ha,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function Pd({pixelRatio:i,state:e,displayLevel:t,requiredLevel:n},s){const o=1/2**(t-s.key.level),a=1/2**(n-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:o,requiredZoomFactor:a,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:t,metersPerSRUnit:Zo(e.spatialReference),rotation:e.rotation,pixelRatio:i}}function Za(i){var e;return((e=i.passOptions)==null?void 0:e.type)==="highlight"}function qa(i){var e;return((e=i.passOptions)==null?void 0:e.type)==="hittest"}function $d(i){if(!qa(i))return null;const{position:e,distance:t,smallSymbolDistance:n,smallSymbolSizeThreshold:s}=i.passOptions;return{position:e,distance:t,smallSymbolDistance:n,smallSymbolSizeThreshold:s}}function Sd(i){if(!Za(i))return null;const{activeReasons:e,highlightAll:t}=i.passOptions;return{activeReasons:e,highlightAll:t?1:0}}function jg(i,e,t){const n={};for(const s in t)typeof t[s]!="function"?n[s]=t[s]:n[s]=t[s](i,e);return n}function Ug(i,e){const{attributeView:t,context:n}=i;return{storage:t.getUniforms(n),view:Pd(i,e),hittestRequest:$d(i),highlight:Sd(i)}}function Bg(i){return{inside:i.selection===Ps.InsideEffect,outside:i.selection===Ps.OutsideEffect}}function kd(i){return qa(i)?xd:Za(i)&&i.passOptions.stepType==="clear"?Td:Ha}function Kg(i){const{row:e,col:t}=i.key,n=t*ks,s=e*ks;return{tileOffsetFromLocalOrigin:[n%ti,s%ti],maxIntsToLocalOrigin:[Math.floor(n/ti),Math.floor(s/ti)]}}const Cd=new Gr({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function Yg(i){return Cd.toJSON(i)}function Jg(i){const{bandCount:e,attributeTable:t,colormap:n,pixelType:s}=i.raster.rasterInfo;return e===1&&(t!=null||n!=null||s==="u8"||s==="s8")}function Ed(i,e){return e==null?(i==null||i.destroy(),null):((i==null?void 0:i.type)==="single"&&Array.isArray(e)&&(i.destroy(),i=null),(i==null?void 0:i.type)!=="multi"||Array.isArray(e)||(i.destroy(),i=null),i||(i=Array.isArray(e)?new Md:new Fa),Array.isArray(e)?i.type==="multi"&&i.setHighlightOptions(e):i.type==="single"&&i.setHighlightOptions(e),i)}function Qg(i,e,t,n){const{painter:s,highlightGradient:o}=i,{highlight:a}=s.effects;if(!o)return;const l=i.passOptions,c=o.getReasonsWithGradients();for(let u=0;u<c.length;u++){const d={...i,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:c[u].activeReasons,stepType:"burn",highlightAll:e}};if(a.bind(d),t(d),u<c.length-1){let p=0;for(let g=u+1;g<c.length;g++)p|=c[g].activeReasons;t({...i,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:p,stepType:"clear",highlightAll:e}})}const m={...i,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:c[u].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(kd(i)),s.updatePipelineState(i.context),a.draw(m),a.unbind()}i.passOptions=l}const oi=i=>parseFloat(i)/100;function Id(i,e,t){const n=typeof i.left=="string"?oi(i.left)*e:i.left,s=typeof i.right=="string"?oi(i.right)*e:i.right,o=typeof i.top=="string"?oi(i.top)*t:i.top,a=typeof i.bottom=="string"?oi(i.bottom)*t:i.bottom,l=o;return{xmin:n,xmax:Math.max(e-s,n),ymin:l,ymax:Math.max(t-a,o)}}function Ga(i,e,t,n){switch(e.type){case"rect":{const{width:s,height:o}=i,{xmin:a,xmax:l,ymin:c,ymax:u}=Id(e,s,o),{x:d,y:m}=t;return d>a&&d<l&&m>c&&m<u}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||Wr(e.path,[t.x,t.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?jo(e.geometry,n):Zn(e.geometry,n))}}function Rd(i){if(!i.highlights)return null;const e=i.highlights.findIndex(t=>t.name==="default");return e===-1?null:i.highlights.items[e]}function Vd(i,e){if(!i.highlights){if(!e)return;i.highlights=new R([new Ze])}const t=i.highlights.findIndex(n=>n.name==="default");e?i.highlights.items[t].assignFrom(e):(i.highlights.removeAt(t),i.highlights.length===0&&(i.highlights=null))}async function Dd(i,e,t){const n=ua(e)?ca(i,e):e;if(!i.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let s=new Set;const o=new Set;let a=!1,l=null,c=null;t!=null&&t.include?$o(t.include,Po(i,p=>{s.add(p),cn(p,g=>o.add(g))},(p,g)=>{o.add(p),s.add(g)},p=>{l||(l=new Set),l.add(p)},p=>s.add(p),()=>a=!0)):(a=!0,s=new Set(i.allLayerViews),s.forEach(p=>{cn(p,g=>o.add(g))})),t!=null&&t.exclude&&$o(t.exclude,Po(i,p=>{s.delete(p),cn(p,g=>o.delete(g))},p=>o.delete(p),p=>{c||(c=new Set),c.add(p)}));const u=i.toMap(n),d=i.allLayerViews.filter(p=>!p.suspended&&s.has(p)&&p.clips.every(g=>Ga(i,g,n,u))).reverse();let m=[...a?i.graphicsView.hitTest(u).map(p=>({type:"graphic",graphic:p,layer:null,mapPoint:u})):[],...await Promise.all(d.map(p=>p.hitTest(u,n)).toArray())].filter(At).flat().filter(At);return m=m.filter(p=>{var g;return p.type!=="graphic"||((g=p.layer)==null?void 0:g.type)!=="subtype-group"||o.has(p.graphic.layer)}),l&&(m=m.filter(p=>!("graphic"in p)||!p.graphic||(l==null?void 0:l.has(An(p.graphic))))),c&&(m=m.filter(p=>!("graphic"in p)||!p.graphic||!(c!=null&&c.has(An(p.graphic))))),{screenPoint:n,results:m}}function Po(i,e,t,n,s,o){return a=>{if(a instanceof Kl){if(a.layer===i)o==null||o();else{const l=i.allLayerViews.find(c=>c.layer===a.layer);l&&(s==null||s(l))}n(An(a))}else if(!("layer"in a&&"element"in a))if(a.type==="subtype-sublayer"){const l=i.allLayerViews.find(c=>c.layer===a.parent);l&&t(a,l)}else{const l=i.allLayerViews.find(c=>c.layer===a);l&&e(l)}}}function $o(i,e){if(i)if(ds(i))for(const t of i)if(ds(t))for(const n of t)e(n);else e(t);else e(i)}function An(i){var t,n;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((n=i.sourceLayer)==null?void 0:n.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function cn({layer:i},e){(i==null?void 0:i.type)==="subtype-group"&&i.sublayers.forEach(t=>{e(t)})}function Wa(i,e,t){const{ctx:n,canvas:s}=Ua(i,t),o=n.getImageData(0,0,i.width,i.height),a=Ka(s,e);return Ba(s),{dataUrl:a,data:o}}function ja(i,e){const{ctx:t,canvas:n}=Ua(i,e),s=t.getImageData(0,0,i.width,i.height);return Ba(n),s}function Ua(i,e){const t=Od();e.premultipliedAlpha&&Nd(i),t.width=i.width,t.height=i.height;const n=t.getContext("2d",{willReadFrequently:!0});return n.putImageData(i,0,0),e.flipY&&zd(n),{ctx:n,canvas:t}}function Ba(i){i.width=0,i.height=0}function Od(){return un==null&&(un=document.createElement("canvas")),un}let un=null;function Ka(i,e){const t=Fd[e.format],n=e.quality/100;return i.toDataURL(t,n)}function Ya(i,e){const t=Ad(i),n=Zd[t];return{format:t,quality:Lt(e??n,0,100)}}function Ja(i,e){return e/Math.max(i[0],i[1])}function Ld(i,e,t,n=0,s=0,o=i.width-n,a=i.height-s,l=!1){const{data:c}=i,{width:u,height:d,data:m}=e,p=o/u,g=a/d,_=Math.ceil(p/2),f=Math.ceil(g/2),T=i.width;for(let P=0;P<d;P++)for(let O=0;O<u;O++){const $=4*(O+(l?d-P-1:P)*u);let V=0,k=0,Y=0,de=0,xt=0,ss=0;const gr=(P+.5)*g;for(let Ut=Math.floor(P*g);Ut<(P+1)*g;Ut++){const os=Math.abs(gr-(Ut+.5))/f,fr=(O+.5)*p,yr=os*os;for(let Bt=Math.floor(O*p);Bt<(O+1)*p;Bt++){const as=Math.abs(fr-(Bt+.5))/_,st=Math.sqrt(yr+as*as);if(st>=1)continue;let Ee=2*st*st*st-3*st*st+1;const ot=4*(n+Bt+(s+Ut)*T);ss+=Ee*c[ot+3],k+=Ee,!t&&c[ot+3]<255&&(Ee=Ee*c[ot+3]/255),Y+=Ee*c[ot],de+=Ee*c[ot+1],xt+=Ee*c[ot+2],V+=Ee}}m[$]=Y/V,m[$+1]=de/V,m[$+2]=xt/V,m[$+3]=ss/k}return e}function Ad(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Hd}}function zd(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function Nd(i){const e=i.data,t=e.length;for(let n=0;n<t;n+=4){const s=e[n+3];if(s!==255&&s>0){const o=255/s;e[n]=e[n]*o,e[n+1]=e[n+1]*o,e[n+2]=e[n+2]*o}}}const Fd={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},So=98,Hd="png",Zd={png:100,jpg:So,jpeg:So},Xg=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:Yl,encode:Wa,encodeData:ja,getFormatAndQuality:Ya,getMaximumResolutionScale:Ja,resampleHermite:Ld,toDataUrl:Ka},Symbol.toStringTag,{value:"Module"})),Qa={flipY:!0,premultipliedAlpha:!0};async function qd(i,e){const t=await Xa(i,e),{format:n,quality:s}=Ya(e==null?void 0:e.format,e==null?void 0:e.quality);return Wa(t,{format:n,quality:s},Qa)}async function Gd(i,e){const t=await Xa(i,e);return ja(t,Qa)}function Xa(i,e){const t=Ud(e||{},jd(i.stage,i.size),i.size,i.padding),n=Wd(e,i.allLayerViews);return i.stage.takeScreenshot(t,n,i.backgroundColor,e==null?void 0:e.rotation)}function Wd(i={},e){if(!i.layers)return;const t=[];return i.layers.forEach(n=>{const s=e.find(o=>o.layer.id===n.id);s!=null&&s.container&&t.push(s.container)}),t}function jd(i,e){return Math.min(4,Ja(e,Math.min(4096,i.context.parameters.maxTextureSize)))}function Ud(i,e,t,n){i.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let s=null;i.width!=null&&i.height!=null?s=[i.width,i.height]:i.width==null&&i.height!=null?s=[i.height,i.height]:i.width!=null&&i.height==null?s=[i.width,i.width]:i.width==null&&i.height==null&&(s=null);const o=t[0]-(n.left+n.right),a=t[1]-(n.top+n.bottom);let l,c,u=i.area||{x:0,y:0,width:o,height:a};if(s){const d=o/a,m=s[0]/s[1];if(m>d){const p=u.width/m;u={x:u.x,y:Math.round(u.y+(u.height-p)/2),width:u.width,height:Math.round(p)}}else{const p=u.height*m;u={x:Math.round(u.x+(u.width-p)/2),y:u.y,width:Math.round(p),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(l=Math.min(s[0]/u.width,e),c=s[0]/u.width/l):(l=1,c=s[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*l),y:Math.round((u.y+n.top)*l),width:Math.round(u.width*l),height:Math.round(u.height*l)},outputScale:c,resolutionScale:l}}const Bd=i=>i.includes("Brush");let er=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Bd(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function Kd(i){const e=Jl();return e.available?i==="3d"&&e.majorPerformanceCaveat?new S("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new S("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new S("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new S("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Yd(i){return i&&"nodeType"in i}function Jd(i){return i&&typeof i.render=="function"}const ko={component:"esri-component"};let Be=class extends x{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,t;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((t=this.node)==null?void 0:t.id)}set id(e){this._set("id",e)}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(ko.component),t&&t.classList.remove(ko.component),this._set("node",e))}castNode(e){var t;return(t=this.widget)==null||t.destroy(),e?typeof e=="string"||Yd(e)?(this._set("widget",null),Ko(e)):(Jd(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};r([h()],Be.prototype,"id",null),r([h()],Be.prototype,"node",null),r([Qe("node")],Be.prototype,"castNode",null),r([h({readOnly:!0})],Be.prototype,"widget",void 0),Be=r([v("esri.views.ui.Component")],Be);const di=Be,Qd={left:0,top:0,bottom:0,right:0},tr={bottom:30,top:15,right:15,left:15},we="esri-ui",j={ui:we,corner:`${we}-corner`,innerContainer:`${we}-inner-container`,manualContainer:`${we}-manual-container`,cornerContainer:`${we}-corner-container`,topLeft:`${we}-top-left`,topRight:`${we}-top-right`,bottomLeft:`${we}-bottom-left`,bottomRight:`${we}-bottom-right`};function Xd(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function ai(i){return i===0?"0":`${i}px`}function dn(i){const e=typeof i=="object"&&i!==null&&Object.getPrototypeOf(i);return(e===null||e===Object.prototype)&&("component"in i||"index"in i||"position"in i)?i:null}function pn(i,{top:e,bottom:t,left:n,right:s}){i.style.top=e,i.style.bottom=t,i.style.left=n,i.style.right=s}let fe=class extends qt.EventedAccessor{constructor(i){super(i),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=jr(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&pn(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&pn(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([w(()=>{var i;return[(i=this.view)==null?void 0:i.padding,this.container]},this._applyViewPadding,W),w(()=>this.padding,this._applyUIPadding,W),w(()=>[this.container,this._locale],([i,e])=>{i&&i.setAttribute("lang",e)},W),Ur(i=>{this._locale=i})])}destroy(){this.container=null;for(const i of this._components)i.destroy();this._components.length=0,this._componentMap.clear()}set container(i){const e=this._get("container");i!==e&&(i&&(i.classList.add(j.ui),ll(i),this._attachContainers(i)),e&&(e.classList.remove(j.ui),pn(e,{top:"",bottom:"",left:"",right:""}),e.textContent=""),this._set("container",i))}get height(){var s;const i=((s=this.view)==null?void 0:s.height)??0;if(i===0)return i;const e=this._getViewPadding(),{top:t,bottom:n}=e;return Math.max(i-t-n,0)}get padding(){return this._get("padding")}set padding(i){this._overrideIfSome("padding",i)}castPadding(i){return typeof i=="number"?{bottom:i,top:i,right:i,left:i}:{...tr,...i}}get width(){var s;const i=((s=this.view)==null?void 0:s.width)??0;if(i===0)return i;const e=this._getViewPadding(),{left:t,right:n}=e;return Math.max(i-t-n,0)}add(i,e){let t,n,s;if(Array.isArray(i))return void i.forEach(a=>this.add(a,e));const o=dn(i);o&&({index:t,position:e,component:i,key:n}=o),e&&typeof e=="object"&&({index:t,key:n,position:e,internal:s}=e),!i||e&&!this._isValidPosition(e)||this._add(i,e,t??this._getNumComponentsAtPosition(e),n,s)}remove(i,e){var n;if(!i)return;if(Array.isArray(i))return i.map(s=>this.remove(s,e));const t=this._find(i);if(t){const s=this._componentMap.get(t);if(!s||s.key!==e)return;const o=this._components.indexOf(t),a=t.node.parentNode;return a==null||a.removeChild(t.node),this._componentMap.delete(t),(n=t.widget)==null||n.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(l=>{const c=this._componentMap.get(l);c&&c.position===s.position&&c.index>s.index&&c.index--}),this._components.splice(o,1)[0]}}empty(i,e={removeInternal:!1}){if(Array.isArray(i)){for(const s of i)this.empty(s,e);return}const t=this._positionNameToContainerLookup[i??"manual"],n=Array.prototype.slice.call(t.children).map(s=>this._findByNode(s)).filter(s=>{var o;return s==null?!1:!(((o=this._componentMap.get(s))==null?void 0:o.internal)??!1)||e.removeInternal});for(const s of n)this.remove(s)}move(i,e){if(Array.isArray(i)&&i.forEach(o=>this.move(o,e)),!i)return;let t;const n=dn(i)||dn(e);if(n&&(t=n.index,e=n.position,i=n.component||i),e&&!this._isValidPosition(e))return;const s=this.remove(i);s&&this.add(s,{position:e,index:t})}find(i){if(!i)return null;const e=this._findById(i);return e&&(e.widget||e.node)}getComponents(i,e={includeInternal:!1}){return i?Array.isArray(i)?i.flatMap(t=>this._getComponentsAtPosition(t,e)):this._getComponentsAtPosition(i,e):this._components.filter(t=>{var n;return e.includeInternal||!((n=this._componentMap.get(t))!=null&&n.internal)}).map(({widget:t,node:n})=>t??n)}getPosition(i){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(i))return e;return null}_add(i,e,t,n,s){i instanceof di||(i=new di({node:i}));const{widget:o}=i;o!=null&&o instanceof x&&o.addHandles(Zt(()=>{queueMicrotask(()=>this.remove(i))}),this._removeWidgetHandleKey),this._components.some(a=>{var l,c;return((l=this._componentMap.get(a))==null?void 0:l.position)===e&&((c=this._componentMap.get(a))==null?void 0:c.index)===t})&&this._components.forEach(a=>{const l=this._componentMap.get(a);l&&l.position===e&&l.index>=t&&l.index++}),this._place({component:i,position:e,index:t}),this._components.push(i),this._componentMap.set(i,{key:n,position:e,internal:s,index:t})}_find(i){return i?i instanceof di?this._findByComponent(i):typeof i=="string"?this._findById(i):"domNode"in i?this._findByNode(i.domNode):this._findByNode(i):null}_getViewPadding(){var i;return((i=this.view)==null?void 0:i.padding)??Qd}_attachContainers(i){i.appendChild(this._innerContainer),i.appendChild(this._manualContainer)}_initContainers(){const i=document.createElement("div");i.classList.add(j.innerContainer,j.cornerContainer);const e=document.createElement("div");e.classList.add(j.innerContainer,j.manualContainer);const t=document.createElement("div");t.classList.add(j.topLeft,j.corner),i.appendChild(t);const n=document.createElement("div");n.classList.add(j.topRight,j.corner),i.appendChild(n);const s=document.createElement("div");s.classList.add(j.bottomLeft,j.corner),i.appendChild(s);const o=document.createElement("div");o.classList.add(j.bottomRight,j.corner),i.appendChild(o),this._innerContainer=i,this._manualContainer=e;const a=hl();this._cornerNameToContainerLookup={"top-left":t,"top-right":n,"bottom-left":s,"bottom-right":o,"top-leading":a?n:t,"top-trailing":a?t:n,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(i){return!!this._positionNameToContainerLookup[i]}_place(i){var l,c;const e=i.position??"manual",{component:t,index:n}=i,s=this._positionNameToContainerLookup[e],o=n!=null&&n>-1;if(Xd(t.widget)&&t.widget.startup(),!o)return void s.appendChild(t.node);const a=Array.from(s.children);if(a.length!==0){for(const u of a){const d=this._findByNode(u);if(d&&n<(((l=this._componentMap.get(d))==null?void 0:l.index)??0))return void((c=u.parentNode)==null?void 0:c.insertBefore(t.node,u))}s.appendChild(t.node)}else s.appendChild(t.node)}_toPixelPosition(i){return{top:ai(i.top),left:ai(i.left),right:ai(i.right),bottom:ai(i.bottom)}}_findByComponent(i){return this._components.find(e=>e===i)??null}_findById(i){return this._components.find(({id:e})=>e===i)??null}_findByNode(i){return i?this._components.find(({node:e})=>e===i):null}_getComponentsAtPosition(i,e){const t=this._positionNameToContainerLookup[i];return Array.prototype.slice.call(t.children).map(n=>this._findByNode(n)).filter(At).filter(n=>{var s;return e.includeInternal||!((s=this._componentMap.get(n))!=null&&s.internal)}).map(({widget:n,node:s})=>n??s)}_getNumComponentsAtPosition(i){const e=this._positionNameToContainerLookup[i];return(e==null?void 0:e.children.length)??0}};r([h()],fe.prototype,"_locale",void 0),r([h()],fe.prototype,"container",null),r([h()],fe.prototype,"height",null),r([h({value:tr})],fe.prototype,"padding",null),r([Qe("padding")],fe.prototype,"castPadding",null),r([h()],fe.prototype,"view",void 0),r([h()],fe.prototype,"width",null),fe=r([v("esri.views.ui.UI")],fe);const ep=fe,tp=new Map;function ip(i){return tp.get(i)}function Co(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function np(i,e){return i.length!==e.length||i.some((t,n)=>t.text!==e[n].text)}function kt(i,e,t){!t||!e||i.find(n=>n.layerView===e&&n.text===t)||i.push({text:t,layerView:e})}function sp(i){return i.type==="bing-maps"}const be=[];let ft=class extends x{constructor(i){super(i),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new R,this.view=null,this._allLayerViewsChange=e=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const t=(n=this.view)==null?void 0:n.allLayerViews;t&&(this.addHandles(t.map(s=>w(()=>{var o;return[s.suspended,(o=s.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),t.forEach(s=>{s.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e!=null&&e.removed&&e.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([Ri(()=>{var e;return(e=this.view)==null?void 0:e.allLayerViews},"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),it(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var i;return(i=this.view)!=null&&i.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const i=this.view,e=i==null?void 0:i.allLayerViews;if(be.length=0,!i||!e)return void this._clear();e.forEach(n=>{var a,l;if(n.suspended||!((a=n.layer)!=null&&a.attributionVisible))return;const s=n.layer;if(Co(s,"user"))return void kt(be,n,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(n)){const c=this._fetchedAttributionData.get(n);return void(c?kt(be,n,this._getDynamicAttribution(c,i,s)):Co(s)&&kt(be,n,s.copyright))}return void this._fetchAttributionData(n)}const o="portalItem"in s?(l=s.portalItem)==null?void 0:l.accessInformation:void 0;kt(be,n,o||s.copyright)});const t=e.find(n=>{var s;return((s=n.layer)==null?void 0:s.type)==="integrated-mesh-3dtiles"});if(this.view&&t){const n=ip(this.view);if(n){const s=n.getAttributionText();for(let o=0;o<s.length;++o)kt(be,t,s[o])}}np(this.items,be)&&(this.items.removeAll(),this.items.addMany(be)),be.length=0,this.notifyChange("state")}async _fetchAttributionData(i){if(this._pendingAttributions.has(i))return;this._pendingAttributions.add(i);const e=await dl(i.layer.fetchAttributionData());if(this._pendingAttributions.has(i)){const t=e.ok?this._createContributionIndex(e.value,sp(i.layer)):null;this._pendingAttributions.delete(i),this._fetchedAttributionData.set(i,t)}this._updateAttributionItems()}_createContributionIndex(i,e){const t=i.contributors,n={};if(!t)return n;for(let s=0;s<t.length;s++){const o=t[s],a=o.coverageAreas;if(!a)return;for(const l of a){const c=l.bbox,u=l.zoomMin-(e&&l.zoomMin?1:0),d=l.zoomMax-(e&&l.zoomMax?1:0),m=new nt({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:yi.WGS84}),p={extent:Br(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:s};for(let g=u;g<=d;g++)n[g]??(n[g]=[]),n[g].push(p)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(i,e,t){var u;const{extent:n,scale:s}=e;let o=((u=t.tileInfo)==null?void 0:u.scaleToZoom(s))??0;if(o=Math.min(i.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=i[o],l=Kr(n.center.clone().normalize(),yi.WebMercator),c=new Set;return a?a.filter(d=>{const m=d.id,p=!c.has(m)&&l&&d.extent&&Zn(d.extent,l);return p&&c.add(m),p}).sort((d,m)=>m.score-d.score||d.objectId-m.objectId).map(d=>d.attribution).join(", "):""}};r([h({readOnly:!0,type:R})],ft.prototype,"items",void 0),r([h({readOnly:!0})],ft.prototype,"state",null),r([h()],ft.prototype,"view",void 0),ft=r([v("esri.widgets.Attribution.AttributionViewModel")],ft);const ir=ft,ve={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function op(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:rp(i[e])}}}function ap(i){const e=i==null?void 0:i.type;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function rp(i){return function(e,...t){ap(e)?cl(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}const ht="esri-attribution",ct={base:ht,poweredBy:`${ht}__powered-by`,sources:`${ht}__sources`,open:`${ht}--open`,sourcesOpen:`${ht}__sources--open`,link:`${ht}__link`};let G=class extends Oi{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:s})=>this._checkSourceTextOverflow(s))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new ir}initialize(){this.addHandles(Ri(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[ct.open]:this._isOpen};return K("div",{bind:this,class:this.classes(ct.base,ve.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return K("div",{class:ct.poweredBy},"Powered by"," ",K("a",{class:ct.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,n=t?0:void 0,{attributionText:s}=this,o={[ct.sourcesOpen]:e,[ve.interactive]:t};return K("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(ct.sources,o),innerHTML:s,tabIndex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:n,clientWidth:s,scrollWidth:o}=e,a=o>s,l=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,l&&(t=!0),this._isOpen){const c=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,c&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};r([h()],G.prototype,"_isOpen",void 0),r([h()],G.prototype,"_isInteractive",null),r([h()],G.prototype,"_attributionTextOverflowed",void 0),r([h()],G.prototype,"_prevSourceNodeHeight",void 0),r([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],G.prototype,"attributionText",null),r([h()],G.prototype,"icon",null),r([h()],G.prototype,"itemDelimiter",void 0),r([h()],G.prototype,"label",null),r([h(),Li("esri/widgets/Attribution/t9n/Attribution")],G.prototype,"messages",void 0),r([h()],G.prototype,"view",null),r([h({type:ir})],G.prototype,"viewModel",void 0),r([op()],G.prototype,"_toggleState",null),G=r([v("esri.widgets.Attribution")],G);const lp=G;function hp(){const i=F("mapview-essential-goto-duration");return i==null?i:oe(i)}function cp(i){var e,t;return((e=i==null?void 0:i.spatialReference)==null?void 0:e.isWebMercator)||((t=i==null?void 0:i.spatialReference)==null?void 0:t.isGeographic)||!1}function up(i,e,t){return i.goTo(e,t)}const dp=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:n}=this;return Yr(n),this.goToOverride?this.goToOverride(n,t):up(n,t.target,t.options)}};return r([h()],e.prototype,"goToOverride",void 0),r([h()],e.prototype,"view",void 0),e=r([v("esri.widgets.support.GoTo")],e),e};let Ke=class extends dp(x){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(W)}destroy(){this.view=null}get canShowNorth(){return cp(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var e,t;(e=this.view)!=null&&e.ready&&(((t=this.view)==null?void 0:t.type)==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:hp()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this._set("orientation",{x:0,y:0,z:t})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?w(()=>e==null?void 0:e.rotation,this._updateForRotation,W):w(()=>e==null?void 0:e.camera,this._updateForCamera,W))}_watchForView(e){this.addHandles(w(()=>this.view,this._updateRotationWatcher,e))}};r([h({readOnly:!0})],Ke.prototype,"canShowNorth",null),r([h({readOnly:!0})],Ke.prototype,"orientation",void 0),r([h({readOnly:!0})],Ke.prototype,"state",null),r([h()],Ke.prototype,"view",void 0),Ke=r([v("esri.widgets.Compass.CompassViewModel")],Ke);const nr=Ke,Eo="esri-compass",Io={base:Eo,iconContainer:`${Eo}__icon-container`};let xe=class extends Oi{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new nr,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=n=>({transform:`rotateZ(${n.z}deg)`})}loadDependencies(){return jn({button:()=>M(()=>import("./index-BFWbvBcD.js"),__vite__mapDeps([306,307,7,1,2,5,6,8,9,10,308,309,310,311,312,313,314,315,316,317,318,319])),icon:()=>M(()=>import("./index-lr6cVL0a.js").then(e=>e.i),__vite__mapDeps([311,7,1,2,5,6,8,9,10,312,313]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,{messages:n}=this;return K("div",{class:this.classes(Io.base,ve.widget)},K("calcite-button",{class:ve.widgetButton,disabled:t==="disabled",kind:"neutral",label:n.reset,onclick:this._reset,round:!0,scale:"s",title:n.reset},K("div",{"aria-hidden":"true",class:Io.iconContainer,title:n.reset},K("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};r([h()],xe.prototype,"goToOverride",null),r([h()],xe.prototype,"icon",null),r([h()],xe.prototype,"label",null),r([h(),Li("esri/widgets/Compass/t9n/Compass")],xe.prototype,"messages",void 0),r([h()],xe.prototype,"view",null),r([h({type:nr})],xe.prototype,"viewModel",void 0),xe=r([v("esri.widgets.Compass")],xe);const pp=xe,Ro="esri-navigation-toggle",Vo={base:Ro,isLayoutHorizontal:`${Ro}--horizontal`};let yt=class extends x{constructor(i){super(i),this._navigationMode="pan",this.view=null,i!=null&&i.isDefaultViewModel||Jr(E.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(i={}){const{isDefaultViewModel:e,...t}=i;return t}initialize(){this.addHandles(it(()=>{var i,e;return(e=(i=this.view)==null?void 0:i.navigation)==null?void 0:e.actionMap},()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){var i,e;return(i=this.view)!=null&&i.ready&&((e=this.view)==null?void 0:e.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(i){this._navigationMode=i,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){var t,n;const i=(n=(t=this.view)==null?void 0:t.navigation)==null?void 0:n.actionMap;if(!i)return;const e=this._navigationMode==="pan";i.dragPrimary=e?"pan":"rotate",i.dragSecondary=e?"rotate":"pan"}};r([h({readOnly:!0})],yt.prototype,"state",null),r([h()],yt.prototype,"_navigationMode",void 0),r([h()],yt.prototype,"view",void 0),yt=r([v("esri.widgets.NavigationToggle.NavigationToggleViewModel")],yt);const sr=yt;let Te=class extends Oi{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new sr({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var s;const n=((s=this.viewModel)==null?void 0:s.navigationMode)==="pan"?this._rotateButton:this._panButton;ul(n),this.toggle()},e!=null&&e.isDefaultUI||Qr(E.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:t,...n}=e;return n}loadDependencies(){return jn({button:()=>M(()=>import("./index-BFWbvBcD.js"),__vite__mapDeps([306,307,7,1,2,5,6,8,9,10,308,309,310,311,312,313,314,315,316,317,318,319]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var s,o;const e=((s=this.viewModel)==null?void 0:s.state)==="disabled",t=((o=this.viewModel)==null?void 0:o.navigationMode)==="pan",n=this.messages.toggle;return K("div",{class:this.classes(Vo.base,ve.widget,{[Vo.isLayoutHorizontal]:this.layout==="horizontal"})},K("calcite-button",{afterCreate:a=>{this._panButton=a},appearance:t?"outline-fill":"solid",class:ve.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:n,onclick:this._toggle,tabIndex:t?void 0:-1,title:n}),K("calcite-button",{afterCreate:a=>{this._rotateButton=a},appearance:t?"solid":"outline-fill",class:ve.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:n,onclick:this._toggle,tabIndex:t?-1:void 0,title:n}))}};r([h()],Te.prototype,"icon",null),r([h()],Te.prototype,"label",null),r([h({value:"vertical"})],Te.prototype,"layout",null),r([h(),Li("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Te.prototype,"messages",void 0),r([h()],Te.prototype,"view",null),r([h({type:sr})],Te.prototype,"viewModel",void 0),Te=r([v("esri.widgets.NavigationToggle")],Te);const mp=Te;let Ye=class extends x{get canZoomIn(){var n,s,o;if(!((n=this.view)==null?void 0:n.ready))return!1;const t=(o=(s=this.view)==null?void 0:s.constraints)==null?void 0:o.effectiveMaxScale;return t===0||this._scale>t}get canZoomOut(){var s;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const n=(s=e.constraints)==null?void 0:s.effectiveMinScale;return n===0||this._scale<n}get _scale(){var t,n,s;const e=(n=(t=this.view)==null?void 0:t.animation)==null?void 0:n.target;return(e&&"then"in e||e==null?void 0:e.scale)??((s=this.view)==null?void 0:s.scale)??0}};r([h({readOnly:!0})],Ye.prototype,"canZoomIn",null),r([h({readOnly:!0})],Ye.prototype,"canZoomOut",null),r([h()],Ye.prototype,"view",void 0),r([h()],Ye.prototype,"_scale",null),Ye=r([v("esri.widgets.Zoom.ZoomConditions2D")],Ye);const gp=Ye;let vt=class extends x{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};r([h({readOnly:!0})],vt.prototype,"canZoomIn",null),r([h({readOnly:!0})],vt.prototype,"canZoomOut",null),r([h()],vt.prototype,"view",void 0),vt=r([v("esri.widgets.Zoom.ZoomConditions3D")],vt);const fp=vt;let Ne=class extends x{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new gp({view:e}):e.type==="3d"&&(this._zoomConditions=new fp({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():ps(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():ps(e.goTo({zoomFactor:.5})))}};r([h()],Ne.prototype,"_zoomConditions",void 0),r([h()],Ne.prototype,"canZoomIn",null),r([h()],Ne.prototype,"canZoomOut",null),r([h({readOnly:!0})],Ne.prototype,"state",null),r([h()],Ne.prototype,"view",null),Ne=r([v("esri.widgets.Zoom.ZoomViewModel")],Ne);const or=Ne,Do={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Pe=class extends Oi{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new or,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return jn({button:()=>M(()=>import("./index-BFWbvBcD.js"),__vite__mapDeps([306,307,7,1,2,5,6,8,9,10,308,309,310,311,312,313,314,315,316,317,318,319]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Do.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:t,canZoomOut:n}=this.viewModel,{zoomIn:s,zoomOut:o}=this.messages;return K("div",{class:this.classes(Do.base,ve.widget,e)},K("calcite-button",{class:ve.widgetButton,disabled:!t,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),K("calcite-button",{class:ve.widgetButton,disabled:!n,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};r([h()],Pe.prototype,"icon",null),r([h()],Pe.prototype,"label",null),r([h({value:"vertical"})],Pe.prototype,"layout",null),r([h(),Li("esri/widgets/Zoom/t9n/Zoom")],Pe.prototype,"messages",void 0),r([h()],Pe.prototype,"view",null),r([h({type:or})],Pe.prototype,"viewModel",void 0),Pe=r([v("esri.widgets.Zoom")],Pe);const yp=Pe;function vp(i){return(i==null?void 0:i.view)!==void 0}let pi=class extends ep{constructor(i){super(i),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(t=>{const n=this._find(t),s=n==null?void 0:n.widget;vp(s)&&(s.view=e)})},this._componentsWatcher=(e,t)=>{this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([w(()=>this.components,this._componentsWatcher,W),w(()=>this.view,this._updateViewAwareWidgets,W)])}_add(i,e,t,n,s){let o=i;if(typeof i=="string"&&this._defaultPositionLookup[i]){if(this._find(i))return;o=this._createComponent(i)}super._add(o,e,t,n,s)}_removeComponents(i){i.forEach(e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())})}_adjustPadding(i){if(!i.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(i){this.constructed&&i.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(i){const e=this._createWidget(i);return new di({id:i,node:e})}_createWidget(i){const e=this.view;switch(i){case"attribution":return new lp({view:e});case"compass":return new pp({view:e});case"navigation-toggle":return new mp({view:e,isDefaultUI:!0});case"zoom":return new yp({view:e})}}};r([h()],pi.prototype,"components",void 0),pi=r([v("esri.views.ui.DefaultUI")],pi);const ar=pi;let mi=class extends ar{constructor(i){super(i),this.components=["attribution","zoom"]}};r([h()],mi.prototype,"components",void 0),mi=r([v("esri.views.ui.2d.DefaultUI2D")],mi);const rr=mi;class _p extends Ql{constructor(e,t){super(e,t,"webmap")}}function mn(i){return i!=null&&typeof i=="object"&&"declaredClass"in i&&i.declaredClass==="esri.WebMap"}new _p(2,34);var zn;let gi=zn=class extends Ei{constructor(i){super(i),this.color=new se([0,0,0,1])}clone(){return new zn(Xr({color:this.color}))}};r([h({type:se,json:{write:!0}})],gi.prototype,"color",void 0),gi=zn=r([v("esri.webmap.background.ColorBackground")],gi);const wp=gi;let lr,hr,cr,ur,dr,pr,mr;async function bp(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:n,MagnifierView2D:s,GridView2D:o,Stage:a}]=await Promise.all([M(()=>import("./webglDeps-DNAo8tU8.js"),__vite__mapDeps([152,153,1,2,154,155,156,83,157,158])),M(()=>import("./mapViewDeps-8pyWrqvq.js"),__vite__mapDeps([159,2,1,147,143,73,54,74,160,161,22,24,21,17,84,83,162,60,58,59,163,164,165,144,145,146,103,139,148,31,18,29,30,32,166,167,168,155,156,169,42,43,170,171,172,173,154,157,153,174,175,176,177,178,179,180,181,182,109,52,53,183,184,185,186,187,23,85,19,39,188,189,190,191,192,193,194,67,68,4,55,69,70,71,195,196,152,158,197,198,199,200,201,202,203,204,205,206,82,207,6,49,45,208,87,78,79,76,80,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,28,224,112,225,226,14,227,102,5,228,229,7,8,9,10,230,231,232,125,233,33,234,121,235,236,237,238,239,16,3,20,25,94,240,241,242,243,66]))]);hr=i,cr=e,ur=t,dr=n,pr=s,mr=o,lr=a}var wt;let b=(wt=class extends Du(Yc(th(vh(ah(_c))))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Bo({getCollections:()=>{var t,n;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new Hi({actionMap:new Jn({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new R,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new er,this.type="2d",this.view2dType=null,this.ui=new rr,this.test={takeScreenshot:async t=>Gd(this._getScreenshotView(t),t)},this.padding={top:0,right:0,bottom:0,left:0},nl()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=ce(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new yd(this.featuresTilingScheme)}get constraintsInfo(){var n,s;const e=(n=this.defaultsFromMap)==null?void 0:n.tileInfo,t=this.spatialReference;return{lods:(s=e==null?void 0:e.spatialReference)!=null&&s.equals(t)?e.lods:null,spatialReference:t}}get initialExtentRequired(){var l;if(!this.stateManager)return!1;const{scale:e,constraints:t,center:n,viewpoint:s,extent:o}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((l=this.map.initialViewProperties)!=null&&l.viewpoint))&&!o&&(t!=null&&t.effectiveLODs||(a=-1),(!n||e===0&&a===-1)&&((s==null?void 0:s.targetGeometry)==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=e.targetGeometry,n=this.spatialReference;return ol(t.spatialReference,n)}get background(){return mn(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get highlightOptions(){return Rd(this)}set highlightOptions(e){Vd(this,e)}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resolution(){return this.stateManager.resolution??0}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){var e;return(e=this.featuresTilingScheme)==null?void 0:e.tileInfo}get updating(){var n,s,o,a;const e=!(!this.magnifier.visible||this.magnifier.position===null||!((n=this._magnifierView)!=null&&n.updatingHandles.updating)),t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(l=>!l.destroyed&&!("layerViews"in l)&&l.updating===!0)||e);if(F("esri-2d-log-updating")){const l=this.allLayerViews.reduce((c,u)=>({...c,[`${u.layer.id}(${u.layer.type})`]:!u.destroyed&&!("layerViews"in u)&&u.updating}),{});console.log(`Updating MapView: ${t}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(s=this.layerViewManager)==null?void 0:s.updating}
-> labelManager.updating: ${(o=this.labelManager)==null?void 0:o.updating}
-> graphicsView.updating: ${(a=this.graphicsView)==null?void 0:a.updating}
-> allLayerViews: ${JSON.stringify(l)}
-> updatingMagnifier: ${e}
`)}return t}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new Uo({rings:[e.map(t=>[t[0],t[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}async hitTest(e,t){return Dd(this,e,t)}async takeScreenshot(e){return qd(this._getScreenshotView(e),e)}toScreen(e,t){return this.stateManager.toScreen(e,t)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e;return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||((e=this.defaultsFromMap)==null?void 0:e.spatialReference)||null}getDefaultTimeZone(){return mn(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return mn(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return To.hasLayerViewModule(e)}importLayerView(e){return To.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(E.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var u;const t=this.toMap(e),n=await this.hitTest(e),s=this.allLayerViews.toArray().filter(d=>d.clips.every(m=>Ga(this,m,e,t))).reverse(),o=new globalThis.Map(s.map(d=>[d.layer.uid,d])),a=[];let l=0,c=0;for(;l<n.results.length||c<s.length;){const d=n.results.at(l);if(d&&d.type!=="graphic"){++l;continue}const m=o.get((u=(d==null?void 0:d.layer)??(d==null?void 0:d.graphic.layer))==null?void 0:u.uid);if((!d||m)&&c<s.length&&s.at(c)!==m){const p=s.at(c);"fetchPopupFeaturesAtLocation"in p&&a.push({mapPoint:t,layerView:p}),++c}else d&&(a.push({graphic:d.graphic,layerView:m}),++l)}return{hits:a,location:t}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Kd(this.type);if(F("safari")&&F("safari")<9&&(e=new S("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:F("safari")})),e!=null){E.getLogger(this).warn("#validate()",e.message);const t=document.createElement("div");t.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const n=document.createElement("div");n.innerHTML="Unable to display map. WebGL2 support is required.",n.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const o=document.createElement("a");throw o.innerHTML="https://esriurl.com/systemRequirements",o.target="_blank",o.setAttribute("style","font-size: 18px;"),o.href="https://esriurl.com/systemRequirements",t.appendChild(n),t.appendChild(s),t.appendChild(o),this.surface.appendChild(t),e}}loadAsyncDependencies(){return bp()}_getDefaultViewpoint(){var T;const{constraints:e,initialExtent:t,map:n,padding:s,size:o}=this;if(!e)return null;const a=n&&"initialViewProperties"in n?n.initialViewProperties:void 0,l=this.stateManager.getUserStartupOptions(this.size),c=a==null?void 0:a.viewpoint,u=((T=c==null?void 0:c.targetGeometry)==null?void 0:T.extent)??t,d=u==null?void 0:u.center,m=(c==null?void 0:c.rotation)??0,p=(c==null?void 0:c.scale)||u&&Zi(u,[o[0]-s.left-s.right,o[1]-s.top-s.bottom]),g=l.center??d,_=l.rotation??m,f=l.scale??p;return g&&f?new ae({targetGeometry:g,scale:f,rotation:_}):null}_startup(){var c;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(c=this.defaultsFromMap.extent)==null?void 0:c.center),this.graphics.owner=this;const t=new md(this.surface),n=new lr(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},t);this.stage=n,this._magnifierView=new pr,this._magnifierView.magnifier=this.magnifier,this._gridView=new mr;const s=new ur({view:this});this._set("labelManager",s);const o=new dd({view:this});this._set("animationManager",o);const a=new dr({view:this,animationManager:o});this._set("mapViewNavigation",a),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),n.on("webgl-error",u=>this.fatalError=u.error),w(()=>this.stationary,u=>n.stationary=u,ne),w(()=>this.background,u=>{n.backgroundColor=u==null?void 0:u.color,this._magnifierView.backgroundColor=u==null?void 0:u.color},ne),w(()=>this.magnifier,u=>this._magnifierView.magnifier=u,ne),w(()=>this.grid,u=>this._gridView.grid=u,ne),w(()=>this.renderingOptions,u=>n.renderingOptions=u,ne),w(()=>this.highlights.items.map(u=>({name:u.name,options:{fillColor:u.color,haloColor:u.haloColor,fillOpacity:u.fillOpacity,haloOpacity:u.haloOpacity,haloWidth:u.haloWidth,haloBlur:u.haloBlur}})),()=>{n.highlightGradient=Ed(n.highlightGradient,this.highlights.items)},ne),w(()=>this.state.id,()=>n.state=this.state,ne)],"map-view"),this._updateStageChildren();const l=this._resolveWhenReady;this._resolveWhenReady=[],l.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this.stage.addChild(t.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new Dl(rl.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new hr({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new cr(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var a;const{allLayerViews:t,padding:n,size:s,stage:o}=this;return{allLayerViews:t,backgroundColor:e!=null&&e.ignoreBackground?null:(a=this.background)==null?void 0:a.color,padding:n,size:s,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const t of this.allLayerViews)t.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const t of this.allLayerViews)t.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},wt.type="2d",wt);r([h({constructOnly:!0})],b.prototype,"deactivatedWebGLExtensions",void 0),r([h({constructOnly:!0})],b.prototype,"debugWebGLExtensions",void 0),r([h({readOnly:!0})],b.prototype,"featuresTilingScheme",void 0),r([h({readOnly:!0})],b.prototype,"graphicsTileStore",null),r([h()],b.prototype,"graphicsView",void 0),r([h()],b.prototype,"constraintsInfo",null),r([h()],b.prototype,"initialExtentRequired",null),r([h()],b.prototype,"labelManager",void 0),r([h({type:Hi,nonNullable:!0})],b.prototype,"navigation",void 0),r([h({constructOnly:!0})],b.prototype,"renderCanvas",void 0),r([h()],b.prototype,"renderingOptions",void 0),r([h({constructOnly:!0})],b.prototype,"supersampleScreenshotsEnabled",void 0),r([h({readOnly:!0})],b.prototype,"supportsGround",void 0),r([h()],b.prototype,"defaultsFromMapSettings",null),r([h({readOnly:!0})],b.prototype,"typeSpecificPreconditionsReady",null),r([h({type:wp})],b.prototype,"background",null),r([h()],b.prototype,"center",null),r([h({type:R})],b.prototype,"floors",void 0),r([h()],b.prototype,"grid",void 0),r([h({type:Ze})],b.prototype,"highlightOptions",null),r([h()],b.prototype,"map",void 0),r([h()],b.prototype,"padding",null),r([h({readOnly:!0})],b.prototype,"rendering",null),r([h({readOnly:!0})],b.prototype,"resolution",null),r([h()],b.prototype,"scale",null),r([h({constructOnly:!0})],b.prototype,"spatialReferenceLocked",void 0),r([h({readOnly:!0})],b.prototype,"tileInfo",null),r([h({type:er,readOnly:!0})],b.prototype,"timeline",void 0),r([h({readOnly:!0})],b.prototype,"type",void 0),r([h({readOnly:!0})],b.prototype,"updating",null),r([h({readOnly:!0})],b.prototype,"view2dType",void 0),r([h({readOnly:!0})],b.prototype,"visibleArea",null),r([h()],b.prototype,"zoom",null),r([h({readOnly:!0})],b.prototype,"navigating",null),r([h(),Qe(i=>i instanceof ar?i:el(rr,i))],b.prototype,"ui",void 0),b=r([v("esri.views.View2D")],b);const Mp=b;let fi=class extends Mp{constructor(i){super(i),this.view2dType="map"}};r([h({readOnly:!0})],fi.prototype,"view2dType",void 0),fi=r([v("esri.views.MapView")],fi);const xp=fi,uf=Object.freeze(Object.defineProperty({__proto__:null,default:xp},Symbol.toStringTag,{value:"Module"}));export{Sc as $,ye as A,bc as B,Ft as C,zm as D,pa as E,Yg as F,ka as G,Zg as H,qg as I,vd as J,er as K,md as L,dp as M,Gm as N,Jg as O,Bg as P,Kg as Q,og as R,Ug as S,jg as T,kd as U,Za as V,Pd as W,lc as X,Jm as Y,mh as Z,Ce as _,Lm as a,Qm as a0,As as a1,Ls as a2,Os as a3,Xg as a4,uf as a5,ve as b,da as c,Ed as d,hi as e,Rd as f,Vd as g,Qg as h,ia as i,Nm as j,$a as k,ae as l,Sa as m,me as n,qi as o,Pa as p,sg as q,hp as r,Lc as s,Hc as t,Ze as u,Am as v,mn as w,qa as x,Fm as y,Id as z};
