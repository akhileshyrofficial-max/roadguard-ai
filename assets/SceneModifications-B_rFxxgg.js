import{T as d,_ as h,X as g,n as w,c as i,m as c,ab as N,d as S,V as R,I as J,H as O}from"./Identifiable-_3rFZ1o6.js";import{v as u}from"./persistable-DdbzkEuJ.js";import{L as v,s as x}from"./projectionUtils-BdqPecQc.js";var m;let a=m=class extends d{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,r,o,t){var n;if((n=t.layer)!=null&&n.spatialReference&&!t.layer.spatialReference.equals(this.geometry.spatialReference)){if(!v(e.spatialReference,t.layer.spatialReference))return void((t==null?void 0:t.messages)&&t.messages.push(new h("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})));const p=new g;x(e,p,t.layer.spatialReference),r[o]=p.toJSON(t)}else r[o]=e.toJSON(t);delete r[o].spatialReference}clone(){return new m({geometry:w(this.geometry),type:this.type})}};i([c({type:g}),u()],a.prototype,"geometry",void 0),i([N(["web-scene","portal-item"],"geometry")],a.prototype,"writeGeometry",null),i([c({type:["clip","mask","replace"],nonNullable:!0}),u()],a.prototype,"type",void 0),a=m=i([S("esri.layers.support.SceneModification")],a);var s;let l=s=class extends d.JSONSupportMixin(R.ofType(a)){constructor(e){super(e),this.url=null}clone(){return new s({url:this.url,items:this.items.map(e=>e.clone())})}toJSON(e){return this.toArray().map(r=>r.toJSON(e)).filter(r=>!!r.geometry)}static fromJSON(e,r){const o=new s;for(const t of e)o.add(a.fromJSON(t,r));return o}static async fromUrl(e,r,o){const t={url:J(e),origin:"service"},n=await O(e,{responseType:"json",signal:o==null?void 0:o.signal}),p=r.toJSON(),y=[];for(const f of n.data)y.push(a.fromJSON({...f,geometry:{...f.geometry,spatialReference:p}},t));return new s({url:e,items:y})}};i([c({type:String})],l.prototype,"url",void 0),l=s=i([S("esri.layers.support.SceneModifications")],l);export{l as n};
