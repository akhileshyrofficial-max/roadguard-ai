const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-B0TPsrWa.js","assets/index-CVvIVqY1.js","assets/Identifiable-BjM0PfdN.js","assets/LRUCache-eBEVKbNU.js","assets/MemCache-CUhFgUMJ.js","assets/aaBoundingBox-BrXqvn3i.js","assets/typeUtils-CP9PJ8Sp.js","assets/fieldUtils-Br-fPSxS.js","assets/SimpleMarkerSymbol-D-X_CJ8B.js","assets/screenUtils-aQeO9QTD.js","assets/TextSymbol-DPyc43q3.js","assets/PictureMarkerSymbol-DOPylmLK.js"])))=>i.map(i=>d[i]);
import{_ as d}from"./index-CVvIVqY1.js";import{aS as a,d6 as k}from"./Identifiable-BjM0PfdN.js";import{a as g}from"./asyncUtils-zc5DpkIL.js";import"./mat4f32-Djp3mnm5.js";import"./mat4-C8ai-EIY.js";import{u as L}from"./cimSymbolUtils-CQIuSP9Z.js";import{e as z}from"./LRUCache-eBEVKbNU.js";import"./defaultCIMValues-BrbaHf9c.js";import{S as y,k as p,m as S}from"./typeUtils-CP9PJ8Sp.js";new z(1e3);new a([128,128,128]);const _=new a("white");function F(o){if(o==null||!("symbolLayers"in o)||o.symbolLayers==null)return!1;switch(o.type){case"point-3d":return o.symbolLayers.some(n=>n.type==="object");case"line-3d":return o.symbolLayers.some(n=>n.type==="path");case"polygon-3d":return o.symbolLayers.some(n=>n.type==="object"||n.type==="extrude");default:return!1}}function G(o){var n;return((n=o.resource)==null?void 0:n.href)??""}function H(o,n){if(!o)return null;let r=null;return y(o)?r=j(o):p(o)&&(r=o.type==="cim"?L(o):o.color?new a(o.color):null),r?m(r,n):null}function j(o){const n=o.symbolLayers;if(!n)return null;let r=null;return n.forEach(t=>{var l;t.type==="object"&&((l=t.resource)!=null&&l.href)||(r=t.type==="water"?t.color:t.material?t.material.color:null)}),r?new a(r):null}function m(o,n){if(n==null||o==null)return o;const r=o.toRgba();return r[3]=r[3]*n,new a(r)}function x(o,n,r){const t=o.symbolLayers;if(!t)return;const l=e=>m(n??e??(r!=null?_:null),r);t.forEach(e=>{var c,u;if(e.type!=="object"||!((c=e.resource)!=null&&c.href)||n)if(e.type==="water")e.color=l(e.color);else{const i=e.material!=null?e.material.color:null,s=l(i);if(e.material==null?e.material=new S({color:s}):e.material.color=s,r!=null&&"outline"in e&&((u=e.outline)==null?void 0:u.color)!=null&&(e.outline.color=m(e.outline.color,r)),"marker"in e&&e.marker!=null){const w=l(e.marker.color);e.marker.color=w}}})}function v(o,n,r){var t;(n=n??o.color)&&(o.color=m(n,r)),r!=null&&"outline"in o&&((t=o.outline)!=null&&t.color)&&(o.outline.color=m(o.outline.color,r))}function K(o,n,r){o&&(n||r!=null)&&(n&&(n=new a(n)),y(o)?x(o,n,r):p(o)&&v(o,n,r))}async function E(o,n){const r=o.symbolLayers;r&&await g(r,async t=>R(t,n))}async function R(o,n){switch(o.type){case"extrude":O(o,n);break;case"icon":case"line":case"text":$(o,n);break;case"path":D(o,n);break;case"object":await A(o,n)}}function $(o,n){const r=h(n);r!=null&&(o.size=r)}function h(o){for(const n of o)if(typeof n=="number")return n;return null}function O(o,n){const r=n[2];typeof r=="number"&&(o.size=r)}async function A(o,n){const{resourceSize:r,symbolSize:t}=await P(o),l=b(n,r,t);l!=null&&(o.width=f(n[0],t[0],r[0],l),o.depth=f(n[1],t[1],r[1],l),o.height=f(n[2],t[2],r[2],l))}function D(o,n){const r=b(n,k,[o.width,void 0,o.height]);r!=null&&(o.width=f(n[0],o.width,1,r),o.height=f(n[2],o.height,1,r))}function b(o,n,r){for(let t=0;t<3;t++){const l=o[t];switch(l){case"symbol-value":{const e=r[t];return e!=null?e/n[t]:1}case"proportional":break;default:if(l&&n[t])return l/n[t]}}return null}async function P(o){const{computeObjectLayerResourceSize:n}=await d(()=>import("./symbolLayerUtils-B0TPsrWa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),r=await n(o,10),{width:t,height:l,depth:e}=o,c=[t,e,l];let u=1;for(let i=0;i<3;i++){const s=c[i];if(s!=null){u=s/r[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=r[i]*u);return{resourceSize:r,symbolSize:c}}function f(o,n,r,t){switch(o){case"proportional":return r*t;case"symbol-value":return n??r;default:return o}}function C(o,n){const r=h(n);if(r!=null)switch(o.type){case"simple-marker":o.size=r;break;case"picture-marker":{const t=o.width/o.height;t>1?(o.width=r,o.height=r*t):(o.width=r*t,o.height=r);break}case"simple-line":o.width=r;break;case"text":o.font.size=r}}async function Q(o,n){if(o&&n)return y(o)?E(o,n):void(p(o)&&C(o,n))}function W(o,n,r){if(o&&n!=null)if(y(o)){const t=o.symbolLayers;t&&t.forEach(l=>{if(l.type==="object")switch(r){case"tilt":l.tilt=(l.tilt??0)+n;break;case"roll":l.roll=(l.roll??0)+n;break;default:l.heading=(l.heading??0)+n}l.type==="icon"&&(l.angle+=n)})}else p(o)&&(o.type!=="simple-marker"&&o.type!=="picture-marker"&&o.type!=="text"||(o.angle+=n))}function X(o){return o!=null&&o.type==="polygon-3d"&&o.symbolLayers.some(n=>n.type==="extrude")}export{X as A,K as L,Q as M,W as N,G as b,F as h,H as w};
